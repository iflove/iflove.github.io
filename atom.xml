<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lazy Notes</title>
  
  <subtitle>Android &amp; Java</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://lazy.github.io/"/>
  <updated>2018-01-15T15:17:46.417Z</updated>
  <id>http://lazy.github.io/</id>
  
  <author>
    <name>Lazy</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>My Hexo</title>
    <link href="http://lazy.github.io/2018/01/09/hexo/My-Hexo/"/>
    <id>http://lazy.github.io/2018/01/09/hexo/My-Hexo/</id>
    <published>2018-01-09T13:56:44.808Z</published>
    <updated>2018-01-15T15:17:46.417Z</updated>
    
    <content type="html"><![CDATA[<p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ <a href="http://daringfireball.net/projects/markdown/" target="_blank" rel="external">Markdown</a>ï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚</p><a id="more"></a> <h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h1><p>Hexo è®¢é˜…</p><p>node_modules ä¸‹å®‰è£…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-generator-feed --save</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;ï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Hexo" scheme="http://lazy.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://lazy.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨å¤„ç†</title>
    <link href="http://lazy.github.io/2017/12/26/java/java-reference-note/"/>
    <id>http://lazy.github.io/2017/12/26/java/java-reference-note/</id>
    <published>2017-12-26T14:50:27.000Z</published>
    <updated>2018-01-09T14:51:18.453Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰åœ¨Androidä¸Šä½¿ç”¨ <code>Handler</code> å¼•èµ·äº†å†…å­˜æ³„æ¼ã€‚ä»è€Œè®¤è¯†äº†å¼±å¼•ç”¨ã€è½¯å¼•ç”¨ã€è™šå¼•ç”¨ã€‚ä»Šå¤©å‘ç°Kotlin åœ¨Android ä¸ŠAnkoåº“é‡Œçš„<code>async</code>, <code>uiThread</code> é‡Œé¢å±…ç„¶åšäº†åœ¨å¼‚æ­¥æ‰§è¡Œè¿‡ç¨‹ä¸­Activityé”€æ¯äº†uiThreadåˆ™ä¸ä¼šè°ƒç”¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚æ­£æ˜¯é‡‡ç”¨äº†å¼±å¼•ç”¨ï¼Œå…ˆæ¸©ä¹ ä¸€ä¸‹ã€‚</p><a id="more"></a> <hr><p>Javaä¸­æœ‰å¦‚ä¸‹å››ç§ç±»å‹çš„å¼•ç”¨ï¼š</p><ul><li>å¼ºå¼•ç”¨(Strong Reference)</li><li>è½¯å¼•ç”¨(SoftReference)</li><li>å¼±å¼•ç”¨(WeakReference)</li><li>è™šå¼•ç”¨(PhantomReference)</li></ul><blockquote><p>Java.lang.ref æ˜¯ Java ç±»åº“ä¸­çš„ä¸€ä¸ªåŒ…ï¼Œå®ƒæä¾›äº†ä¸ Java åƒåœ¾å›æ”¶å™¨å¯†åˆ‡ç›¸å…³çš„å¼•ç”¨ç±»ã€‚è¿™äº›å¼•ç”¨ç±»å¯¹è±¡å¯ä»¥æŒ‡å‘å…¶å®ƒå¯¹è±¡ï¼Œä½†å®ƒä»¬ä¸åŒäºä¸€èˆ¬çš„å¼•ç”¨ï¼Œå› ä¸ºå®ƒä»¬çš„å­˜åœ¨å¹¶ä¸é˜²ç¢ Java åƒåœ¾å›æ”¶å™¨å¯¹å®ƒä»¬æ‰€æŒ‡å‘çš„å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚å…¶å¥½å¤„å°±åœ¨äºä½¿è€…å¯ä»¥ä¿æŒå¯¹ä½¿ç”¨å¯¹è±¡çš„å¼•ç”¨ï¼ŒåŒæ—¶ JVM ä¾ç„¶å¯ä»¥åœ¨å†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™å¯¹ä½¿ç”¨å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚å› æ­¤è¿™ä¸ªåŒ…åœ¨ç”¨æ¥å®ç°ä¸ç¼“å­˜ç›¸å…³çš„åº”ç”¨æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚åŒæ—¶è¯¥åŒ…ä¹Ÿæä¾›äº†åœ¨å¯¹è±¡çš„â€œå¯è¾¾â€æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿›è¡Œæé†’çš„æœºåˆ¶ã€‚</p></blockquote><h2 id="å¼ºå¼•ç”¨-Strong-Reference"><a href="#å¼ºå¼•ç”¨-Strong-Reference" class="headerlink" title="å¼ºå¼•ç”¨(Strong Reference)"></a>å¼ºå¼•ç”¨(Strong Reference)</h2><p>å¼ºå¼•ç”¨å°±æ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡å¼•ç”¨ã€‚ åœ¨Javaä¸­æ²¡æœ‰ç›¸åº”çš„ç±»ä¸å®ƒå¯¹åº” ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å±äºå¼ºå¼•ç”¨ï¼Œå°±ç®—å†…å­˜ä¸è¶³æ—¶ï¼ŒJVMæƒ…æ„¿æŠ›å‡ºOOMå¼‚å¸¸ä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ä¹Ÿä¸ä¼šé å›æ”¶å¼ºå¼•ç”¨çš„å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³çš„é—®é¢˜ã€‚</p><h2 id="è½¯å¼•ç”¨ï¼ˆSoft-Referenceï¼‰"><a href="#è½¯å¼•ç”¨ï¼ˆSoft-Referenceï¼‰" class="headerlink" title="è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰"></a>è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰</h2><p>SoftReference åœ¨â€œå¼±å¼•ç”¨â€ä¸­å±äºæœ€å¼ºçš„å¼•ç”¨ã€‚SoftReference æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œå½“æ²¡æœ‰å¼ºå¼•ç”¨æŒ‡å‘å®ƒæ—¶ï¼Œä¼šåœ¨å†…å­˜ä¸­åœç•™ä¸€æ®µçš„æ—¶é—´ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šæ ¹æ® JVM å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼ˆå†…å­˜çš„ç´§ç¼ºç¨‹åº¦ï¼‰ä»¥åŠ SoftReference çš„ get() æ–¹æ³•çš„è°ƒç”¨æƒ…å†µæ¥å†³å®šæ˜¯å¦å¯¹å…¶è¿›è¡Œå›æ”¶ã€‚</p><h2 id="å¼±å¼•ç”¨-Weak-Reference"><a href="#å¼±å¼•ç”¨-Weak-Reference" class="headerlink" title="å¼±å¼•ç”¨(Weak Reference)"></a>å¼±å¼•ç”¨(Weak Reference)</h2><p>WeakReference æ˜¯å¼±äº SoftReference çš„å¼•ç”¨ç±»å‹ã€‚å¼±å¼•ç”¨çš„ç‰¹æ€§å’ŒåŸºæœ¬ä¸è½¯å¼•ç”¨ç›¸ä¼¼ï¼ŒåŒºåˆ«å°±åœ¨äºå¼±å¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡åªè¦è¿›è¡Œç³»ç»Ÿåƒåœ¾å›æ”¶ï¼Œä¸ç®¡å†…å­˜ä½¿ç”¨æƒ…å†µå¦‚ä½•ï¼Œæ°¸è¿œå¯¹å…¶è¿›è¡Œå›æ”¶ï¼ˆget() æ–¹æ³•è¿”å› nullï¼‰ã€‚</p><h2 id="è™šå¼•ç”¨-ï¼ˆPhantom-Referenceï¼‰"><a href="#è™šå¼•ç”¨-ï¼ˆPhantom-Referenceï¼‰" class="headerlink" title="è™šå¼•ç”¨ ï¼ˆPhantom Referenceï¼‰"></a>è™šå¼•ç”¨ ï¼ˆPhantom Referenceï¼‰</h2><p>PhantomReference æ˜¯æ‰€æœ‰â€œå¼±å¼•ç”¨â€ä¸­æœ€å¼±çš„å¼•ç”¨ç±»å‹ã€‚ä¸åŒäºè½¯å¼•ç”¨å’Œå¼±å¼•ç”¨ï¼Œè™šå¼•ç”¨æ— æ³•é€šè¿‡ get() æ–¹æ³•æ¥å–å¾—ç›®æ ‡å¯¹è±¡çš„å¼ºå¼•ç”¨ä»è€Œä½¿ç”¨ç›®æ ‡å¯¹è±¡ï¼Œè§‚å¯Ÿæºç å¯ä»¥å‘ç° get() è¢«é‡å†™ä¸ºæ°¸è¿œè¿”å› nullã€‚</p><h2 id="å¼•ç”¨å¯¹åˆ—-ï¼ˆReference-Queueï¼‰"><a href="#å¼•ç”¨å¯¹åˆ—-ï¼ˆReference-Queueï¼‰" class="headerlink" title="å¼•ç”¨å¯¹åˆ— ï¼ˆReference Queueï¼‰"></a>å¼•ç”¨å¯¹åˆ— ï¼ˆReference Queueï¼‰</h2><p>åœ¨é€‚å½“çš„æ—¶å€™æ£€æµ‹åˆ°å¯¹è±¡çš„å¯è¾¾æ€§å‘ç”Ÿæ”¹å˜åï¼Œåƒåœ¾å›æ”¶å™¨å°±å°†å·²æ³¨å†Œçš„å¼•ç”¨å¯¹è±¡æ·»åŠ åˆ°æ­¤é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦å¼±å¼•ç”¨å¯¹è±¡å¼€å§‹è¿”å›nullï¼Œè¯¥å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡å°±è¢«æ ‡è®°æˆäº†åƒåœ¾ã€‚è€Œè¿™ä¸ªå¼±å¼•ç”¨å¯¹è±¡ï¼ˆéå…¶æŒ‡å‘çš„å¯¹è±¡ï¼‰å°±æ²¡æœ‰ä»€ä¹ˆç”¨äº†ã€‚é€šå¸¸è¿™æ—¶å€™éœ€è¦è¿›è¡Œä¸€äº›æ¸…ç†å·¥ä½œã€‚æ¯”å¦‚WeakHashMapä¼šåœ¨è¿™æ—¶å€™ç§»é™¤æ²¡ç”¨çš„æ¡ç›®æ¥é¿å…ä¿å­˜æ— é™åˆ¶å¢é•¿çš„æ²¡æœ‰æ„ä¹‰çš„å¼±å¼•ç”¨ã€‚</p><h2 id="å¼•ç”¨ç±»å‹ç‰¹æ€§æ€»ç»“"><a href="#å¼•ç”¨ç±»å‹ç‰¹æ€§æ€»ç»“" class="headerlink" title="å¼•ç”¨ç±»å‹ç‰¹æ€§æ€»ç»“"></a>å¼•ç”¨ç±»å‹ç‰¹æ€§æ€»ç»“</h2><table><thead><tr><th>å¼•ç”¨ç±»å‹</th><th>å–å¾—ç›®æ ‡å¯¹è±¡æ–¹å¼</th><th>åƒåœ¾å›æ”¶æ¡ä»¶</th><th>æ˜¯å¦å¯èƒ½å†…å­˜æ³„æ¼</th></tr></thead><tbody><tr><td>å¼ºå¼•ç”¨</td><td>ç›´æ¥è°ƒç”¨</td><td>ä¸å›æ”¶</td><td>å¯èƒ½</td></tr><tr><td>è½¯å¼•ç”¨</td><td>é€šè¿‡ get() æ–¹æ³•</td><td>è§†å†…å­˜æƒ…å†µå›æ”¶</td><td>ä¸å¯èƒ½</td></tr><tr><td>å¼±å¼•ç”¨</td><td>é€šè¿‡ get() æ–¹æ³•</td><td>æ°¸è¿œå›æ”¶</td><td>ä¸å¯èƒ½</td></tr><tr><td>è™šå¼•ç”¨</td><td>æ— æ³•å–å¾—</td><td>ä¸å›æ”¶</td><td>å¯èƒ½</td></tr></tbody></table><p>ç†è®ºåˆ°å®è·µ-&gt;ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReferenceDemo</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;Object&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        ReferenceDemo referenceDemo = <span class="keyword">new</span> ReferenceDemo();</div><div class="line">        <span class="comment">//referenceDemo.strongReference();</span></div><div class="line"></div><div class="line">        referenceDemo.softReference();</div><div class="line">        referenceDemo.weakReference();</div><div class="line">        referenceDemo.phantomReference();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">phantomReference</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"------phantomReference--------"</span>);</div><div class="line">        ReferenceQueue&lt;Object&gt; refQueue = <span class="keyword">new</span> ReferenceQueue&lt;Object&gt;();</div><div class="line">        PhantomReference&lt;Object&gt; referent = <span class="keyword">new</span> PhantomReference&lt;&gt;(<span class="keyword">new</span> Object(), refQueue);</div><div class="line">        System.out.println(referent.get());</div><div class="line">        System.gc();</div><div class="line">        System.runFinalization();</div><div class="line">        System.out.println(String.format(<span class="string">"is recycle %s"</span>, (refQueue.poll()) == referent));</div><div class="line">        System.out.println(<span class="string">"------phantomReference--------"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">weakReference</span><span class="params">()</span> </span>&#123;</div><div class="line">        list.clear();</div><div class="line">        System.out.println(<span class="string">"------WeakReference--------"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</div><div class="line">            <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</div><div class="line">            WeakReference weakReference = <span class="keyword">new</span> WeakReference(buff);</div><div class="line">            list.add(weakReference);</div><div class="line">        &#125;</div><div class="line">        list.forEach(o -&gt; &#123;</div><div class="line">            Object o1 = ((WeakReference) o).get();</div><div class="line">            System.out.println(o1);</div><div class="line">        &#125;);</div><div class="line">        System.out.println(<span class="string">"------WeakReference--------"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">strongReference</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span>];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">softReference</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"------softReference--------"</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</div><div class="line">            <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</div><div class="line">            <span class="comment">//list.add(buff)</span></div><div class="line">            SoftReference softReference = <span class="keyword">new</span> SoftReference(buff);</div><div class="line">            list.add(softReference);</div><div class="line">        &#125;</div><div class="line">        list.forEach(o -&gt; &#123;</div><div class="line">            Object o1 = ((SoftReference) o).get();</div><div class="line">            System.out.println(o1);</div><div class="line">        &#125;);</div><div class="line">        System.out.println(<span class="string">"------softReference--------"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿è¡Œä»¥ä¸Šä»£ç </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰åœ¨Androidä¸Šä½¿ç”¨ &lt;code&gt;Handler&lt;/code&gt; å¼•èµ·äº†å†…å­˜æ³„æ¼ã€‚ä»è€Œè®¤è¯†äº†å¼±å¼•ç”¨ã€è½¯å¼•ç”¨ã€è™šå¼•ç”¨ã€‚ä»Šå¤©å‘ç°Kotlin åœ¨Android ä¸ŠAnkoåº“é‡Œçš„&lt;code&gt;async&lt;/code&gt;, &lt;code&gt;uiThread&lt;/code&gt; é‡Œé¢å±…ç„¶åšäº†åœ¨å¼‚æ­¥æ‰§è¡Œè¿‡ç¨‹ä¸­Activityé”€æ¯äº†uiThreadåˆ™ä¸ä¼šè°ƒç”¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚æ­£æ˜¯é‡‡ç”¨äº†å¼±å¼•ç”¨ï¼Œå…ˆæ¸©ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Javaéšç¬”è®°å½•" scheme="http://lazy.github.io/categories/Java%E9%9A%8F%E7%AC%94%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="Java" scheme="http://lazy.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ Handler è½»æ¾å®ç°ä¸“å±Androidå®šæ—¶å™¨</title>
    <link href="http://lazy.github.io/2017/12/19/android/2017-12-19-handlerTaskTimer/"/>
    <id>http://lazy.github.io/2017/12/19/android/2017-12-19-handlerTaskTimer/</id>
    <published>2017-12-19T07:10:27.000Z</published>
    <updated>2017-12-26T14:39:58.555Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¹´åœ¨é¡¹ç›®ä¸­å‘ç°ä¸ºäº†å®ç°å€’è®¡æ—¶ã€æ—¶é—´æ®µçš„å»¶è¿Ÿæ‰§è¡Œã€æ—¶é—´æ®µçš„è½®è¯¢æ‰§è¡Œä»»åŠ¡ï¼Œéƒ½æ˜¯é‡‡ç”¨Handler postDelayed(runnable,delayMillis). ç­‰ç­‰ï¼Œè¿™æœ‰æ¯›ç—…ï¼Ÿé‚£ä½ å°†å®ç°ä»¥ä¸ŠåŠŸèƒ½æ—¶ã€ä»£ç å¤§æ¦‚å¦‚ä¸‹ã€‚</p><a id="more"></a> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Handler handler = <span class="keyword">new</span> Handler()ï¼›</div><div class="line"><span class="keyword">int</span> countDown = <span class="number">30</span>;</div><div class="line">Runnable r = <span class="keyword">new</span> Runnable() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">while</span> (countDown&gt;<span class="number">0</span>)&#123;</div><div class="line">                handler.postDelayed(r,<span class="number">1</span>);</div><div class="line">                countDown--;</div><div class="line">            &#125;</div><div class="line">        &#125;&#125;;</div><div class="line">handler.postDelayed(r,<span class="number">0</span>);</div></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç è¿˜ç®—å¥½ï¼Œå¦‚æœæ˜¯ä»¥ <code>handleMessage</code>ã€<code>sendEmptyMessageDelayed</code> å†é€šè¿‡<code>removeMessages</code>/<code>removeCallbacks</code> å»å–æ¶ˆï¼Œè¿™æ ·çš„ä»£ç ä¸€å¤§å †ã€è¿½è¸ªä»£ç æ—¶ï¼Œè·³æ¥è·³å»çš„ã€‚</p><p>è¿™æ—¶æˆ‘å°±æƒ³åˆ°äº†RxJava çš„å¥½äº†ï¼Œéš¾é“ä¸ºäº†è¿™è¦åŠ å…¥RxJavaï¼Ÿ</p><p>æ‰€ä»¥ï¼Œ RxJava å¥½åœ¨å“ªï¼Ÿå°±å¥½åœ¨ç®€æ´ï¼Œå¥½åœ¨é‚£æŠŠä»€ä¹ˆå¤æ‚é€»è¾‘éƒ½åªæ˜¯ä¸€æ¡é“¾å¼è°ƒç”¨ã€‚</p><p>å› æ­¤æŠŠä¸Šé¢ä»£ç å°è£…ä¸€ä¸ª HandlerTaskTimer å·¥å…·ç±»ï¼Œå¤§æ¦‚ä¼ªç¼–ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HandlerTaskTimer</span></span>&#123;</div><div class="line">    <span class="comment">//æˆå‘˜å˜é‡</span></div><div class="line">  Handler uiHandler;</div><div class="line"></div><div class="line">  <span class="comment">//å› ä¸ºè¦é“¾å¼è°ƒç”¨,é¡ºå¸¦é‡‡ç”¨æ„å»ºè€…æ¨¡å¼åˆå§‹åŒ–å¿…è¦å‚æ•°</span></div><div class="line">  <span class="function">Builder <span class="title">newBuilder</span><span class="params">()</span></span></div><div class="line">    class Builder&#123;</div><div class="line">      <span class="comment">//ä¸€æ®µæ—¶é—´åæ‰§è¡Œ</span></div><div class="line">        period(<span class="keyword">long</span> period, TimeUnit unit)</div><div class="line">         <span class="comment">/**</span></div><div class="line">         * <span class="doctag">@param</span> period       ä¸€æ®µæ—¶é—´åæ‰§è¡Œ</div><div class="line">         * <span class="doctag">@param</span> initialDelay é¦–æ¬¡å»¶è¿Ÿæ‰§è¡Œæ—¶é—´</div><div class="line">         * <span class="doctag">@param</span> unit</div><div class="line">         * <span class="doctag">@return</span></div><div class="line">         */</div><div class="line">        period(<span class="keyword">long</span> period, <span class="keyword">long</span> initialDelay, TimeUnit unit)</div><div class="line">        <span class="comment">//é¦–æ¬¡å»¶è¿Ÿæ‰§è¡Œæ—¶é—´</span></div><div class="line">        initialDelay(<span class="keyword">long</span> period, TimeUnit unit) </div><div class="line">        <span class="comment">//takeWhile å€’è®¡æ—¶Count  </span></div><div class="line">        takeWhile(<span class="keyword">long</span> takeWhile)</div><div class="line">        <span class="comment">//tag</span></div><div class="line">        tag(String tag)</div><div class="line">        <span class="comment">//ä»»åŠ¡æ‰§è¡Œå®ŒæˆCallBack</span></div><div class="line">        accept(Action action)  </div><div class="line">        <span class="comment">//å€’è®¡æ—¶å›è°ƒ  </span></div><div class="line">        accept(Consumer&lt;Long&gt; longConsumer)  </div><div class="line">        accept(Consumer&lt;Long&gt; longConsumer, Action action)</div><div class="line">        </div><div class="line">        <span class="comment">//å€’è®¡æ—¶æ¨¡å¼ä»»åŠ¡</span></div><div class="line">        countDown() </div><div class="line">        <span class="comment">//å¾ªç¯æ¨¡å¼ä»»åŠ¡</span></div><div class="line">        loopExecute() </div><div class="line">        <span class="comment">//å»¶è¿Ÿæ¨¡å¼ä»»åŠ¡</span></div><div class="line">        delayExecute() </div><div class="line">        <span class="comment">//å¯åŠ¨ä»»åŠ¡</span></div><div class="line">        start()</div><div class="line">        <span class="comment">//å–æ¶ˆä»»åŠ¡</span></div><div class="line">        cancel()</div><div class="line">        <span class="comment">//æ¢å¤ä»»åŠ¡</span></div><div class="line">        resume()</div><div class="line">        <span class="comment">//æš‚åœä»»åŠ¡</span></div><div class="line">        pause()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ…¢æ…¢å®ç°åŠŸèƒ½äº†ï¼Œæ¡æ¡å¤§è·¯é€šç½—é©¬ï¼Œä¹Ÿè®¸ä½ æœ‰æ›´å¥½çš„å®ç°æ–¹å¼ï¼Œä»¥ä¸‹æ˜¯æˆ‘æœ¬äººçš„ç®€å•å®ç°ååˆ†è½»å·§çš„å®šæ—¶ä»»åŠ¡å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">HandlerTaskTimer.getInstance().newBuilder()</div><div class="line">               .tag(TAG_COUNTDOWN)</div><div class="line">               .period(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">               .takeWhile(LauncherActivity.DELAY_LAUNCH_DEFAULT)</div><div class="line">               .countDown()</div><div class="line">               .accept(<span class="keyword">new</span> Consumer&lt;Long&gt;() &#123;</div><div class="line">                   <span class="meta">@Override</span></div><div class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Long aLong)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                       updateCancelLaunchButton(aLong);</div><div class="line">                   &#125;</div><div class="line">               &#125;, <span class="keyword">new</span> Action() &#123;</div><div class="line">                   <span class="meta">@Override</span></div><div class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                       performLaunchButtonClick();</div><div class="line">                   &#125;</div><div class="line">               &#125;).start();</div></pre></td></tr></table></figure><p>å“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯å¥½çœ‹å¤šäº†ï¼ï¼ä»£ç ä¸ä¸€ä¸€åˆ—å‡ºäº†ï¼Œå‚ç…§æˆ‘ğŸ‘‡ GitHubä¸Šçš„Demo å®ç°ï¼Œè¿˜æœ‰Kotlin çš„å®ç°å‘¢</p><p><a href="https://github.com/iflove/AndroidDeveloperTools" target="_blank" rel="external"><strong>AndroidDeveloperTools</strong></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¹´åœ¨é¡¹ç›®ä¸­å‘ç°ä¸ºäº†å®ç°å€’è®¡æ—¶ã€æ—¶é—´æ®µçš„å»¶è¿Ÿæ‰§è¡Œã€æ—¶é—´æ®µçš„è½®è¯¢æ‰§è¡Œä»»åŠ¡ï¼Œéƒ½æ˜¯é‡‡ç”¨Handler postDelayed(runnable,delayMillis). ç­‰ç­‰ï¼Œè¿™æœ‰æ¯›ç—…ï¼Ÿé‚£ä½ å°†å®ç°ä»¥ä¸ŠåŠŸèƒ½æ—¶ã€ä»£ç å¤§æ¦‚å¦‚ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://lazy.github.io/categories/Android/"/>
    
    
      <category term="AndroidDevelop" scheme="http://lazy.github.io/tags/AndroidDevelop/"/>
    
  </entry>
  
  <entry>
    <title>My ToolsBox</title>
    <link href="http://lazy.github.io/2017/12/16/android/2017-12-16-toolsBox/"/>
    <id>http://lazy.github.io/2017/12/16/android/2017-12-16-toolsBox/</id>
    <published>2017-12-16T07:10:27.000Z</published>
    <updated>2017-12-26T14:40:59.355Z</updated>
    
    <content type="html"><![CDATA[<p>æ—¶é—´ä¸€é•¿,æŒæ¡çš„å·¥å…·è¶Šæ¥è¶Šå¤š,è„‘å®¹é‡ä¸å¤Ÿç”¨äº†,ä¾¿éšç¬”è®°å½•. </p><a id="more"></a> <h1 id="adb"><a href="#adb" class="headerlink" title="adb"></a>adb</h1><p><a href="https://developer.android.com/studio/command-line/adb.html" target="_blank" rel="external">Android è°ƒè¯•æ¡¥</a></p><h1 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h1><p><a href="http://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html" target="_blank" rel="external">SSHåŸç†ä¸è¿ç”¨-è¿œç¨‹ç™»å½•</a></p><p><a href="https://wiki.archlinux.org/index.php/SSH_keys_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87" target="_blank" rel="external">SSH keys (ç®€ä½“ä¸­æ–‡)</a>)</p><h1 id="git"><a href="#git" class="headerlink" title="git"></a>git</h1><p><a href="https://book.git-scm.com/" target="_blank" rel="external">Git</a></p><p><a href="https://book.git-scm.com/docs" target="_blank" rel="external">Git Doc</a></p><p><a href="http://www.bootcss.com/p/git-guide/" target="_blank" rel="external">git - ç®€æ˜“æŒ‡å—</a></p><p><a href="http://git.oschina.net/progit/" target="_blank" rel="external">Pro Gitï¼ˆä¸­æ–‡ç‰ˆ)</a></p><p><a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html" target="_blank" rel="external">Gitè¿œç¨‹æ“ä½œè¯¦è§£</a></p><h1 id="gitlab"><a href="#gitlab" class="headerlink" title="gitlab"></a>gitlab</h1><p><a href="https://about.gitlab.com/" target="_blank" rel="external">gitlab</a></p><h1 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h1><p><a href="http://wowubuntu.com/markdown/#list" target="_blank" rel="external">Markdown è¯­æ³•è¯´æ˜</a></p><h2 id="åšå®¢æ¡†æ¶"><a href="#åšå®¢æ¡†æ¶" class="headerlink" title="åšå®¢æ¡†æ¶"></a>åšå®¢æ¡†æ¶</h2><p><a href="https://hexo.io/zh-cn/" target="_blank" rel="external">Hexo</a></p><p><a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="external">å¼€å§‹ä½¿ç”¨ - NexT ä½¿ç”¨æ–‡æ¡£</a></p><p><a href="https://jekyllrb.com/" target="_blank" rel="external">Jekyll-Site</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ—¶é—´ä¸€é•¿,æŒæ¡çš„å·¥å…·è¶Šæ¥è¶Šå¤š,è„‘å®¹é‡ä¸å¤Ÿç”¨äº†,ä¾¿éšç¬”è®°å½•. &lt;/p&gt;
    
    </summary>
    
      <category term="Androidéšç¬”è®°å½•" scheme="http://lazy.github.io/categories/Android%E9%9A%8F%E7%AC%94%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="tools" scheme="http://lazy.github.io/tags/tools/"/>
    
  </entry>
  
  <entry>
    <title>æ¬ç“¦å·¥VPS -ç®€å•æ­å»ºShadowsocksR</title>
    <link href="http://lazy.github.io/2017/12/16/tools/Vps-Shadowsocks/"/>
    <id>http://lazy.github.io/2017/12/16/tools/Vps-Shadowsocks/</id>
    <published>2017-12-16T07:10:27.000Z</published>
    <updated>2017-12-26T14:38:28.474Z</updated>
    
    <content type="html"><![CDATA[<p> æœ€è¿‘ä¹°çš„Shadowsocks è´¦å·éƒ½è¢«å°äº†ã€‚æ— å¥ˆåªå¥½èŠ±$28.19 USDä¹°äº†ä¸ªæ¬ç“¦å·¥VPS,åˆç®€å•æ­å»ºShadowsocksRè¿›è¡Œç§‘å­¦ä¸Šç½‘.<br><a id="more"></a> </p><h1 id="æ¬ç“¦å·¥VPS"><a href="#æ¬ç“¦å·¥VPS" class="headerlink" title="æ¬ç“¦å·¥VPS"></a>æ¬ç“¦å·¥VPS</h1><p><a href="http://banwagong.cn/" target="_blank" rel="external">æ¬ç“¦å·¥VPSä¸­æ–‡ç½‘_æ¬ç“¦å·¥</a></p><p><a href="https://bwh1.net/index.php" target="_blank" rel="external">æ¬ç“¦å·¥</a></p><h1 id="å®‰è£…æœåŠ¡ç«¯ShadowsocksR"><a href="#å®‰è£…æœåŠ¡ç«¯ShadowsocksR" class="headerlink" title="å®‰è£…æœåŠ¡ç«¯ShadowsocksR"></a>å®‰è£…æœåŠ¡ç«¯ShadowsocksR</h1><p>åœ¨è¿™é‡Œä¸æ¨èæ¬ç“¦å·¥åå°ä¸€é”®å®‰è£…,æ¨èç”¨rootç”¨æˆ·ç™»å½•æ‰§è¡Œä¸€é”®å®‰è£…è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh</div><div class="line">chmod +x shadowsocksR.sh</div><div class="line">./shadowsocksR.sh 2&gt;&amp;1 | tee shadowsocksR.log</div></pre></td></tr></table></figure><p><strong>å¸è½½æ–¹æ³•ï¼š</strong><br>ä½¿ç”¨ root ç”¨æˆ·ç™»å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š<code>./shadowsocksR.sh uninstall</code></p><p>å®‰è£…å®Œæˆåå³å·²åå°å¯åŠ¨ ShadowsocksR ï¼Œè¿è¡Œï¼š<code>/etc/init.d/shadowsocks status</code><br>å¯ä»¥æŸ¥çœ‹ ShadowsocksR è¿›ç¨‹æ˜¯å¦å·²ç»å¯åŠ¨ã€‚<br>æœ¬è„šæœ¬å®‰è£…å®Œæˆåï¼Œå·²å°† ShadowsocksR è‡ªåŠ¨åŠ å…¥å¼€æœºè‡ªå¯åŠ¨ã€‚</p><p><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong><br>å¯åŠ¨ï¼š<code>/etc/init.d/shadowsocks start</code><br>åœæ­¢ï¼š<code>/etc/init.d/shadowsocks stop</code><br>é‡å¯ï¼š<code>/etc/init.d/shadowsocks restart</code><br>çŠ¶æ€ï¼š<code>/etc/init.d/shadowsocks status</code></p><p><strong>é»˜è®¤é…ç½®ä¿¡æ¯ï¼š</strong></p><p>é…ç½®æ–‡ä»¶è·¯å¾„ï¼š<code>/etc/shadowsocks.json</code></p><p>æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š<code>/var/log/shadowsocks.log</code></p><p>ä»£ç å®‰è£…ç›®å½•ï¼š<code>/usr/local/shadowsocks</code></p><p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p><p><a href="https://xyzardq.github.io/2017/03/07/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%80%E9%94%AE%E6%90%AD%E5%BB%BAshadowsocks%E5%8F%8A%E4%BC%98%E5%8C%96/" target="_blank" rel="external">shadowsocksR ä¸€é”®å®‰è£…</a></p><h1 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h1><p>å¤šç«¯å£é…ç½®ã€å¤šç”¨æˆ·é…ç½®.ä¸ªäººå»ºè®®åŠ å¯†æ–¹å¼ä½¿ç”¨noneæˆ–aes-256-cfbï¼Œåè®®å®šä¹‰æ’ä»¶auth_chain_a,æ··æ·†æ’ä»¶tls1.2_ticket_auth</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</div><div class="line">    &quot;server_ipv6&quot;:&quot;[::]&quot;,</div><div class="line">    &quot;local_port&quot;:1080,</div><div class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</div><div class="line">    &quot;port_password&quot;:&#123;</div><div class="line">    &quot;443&quot;:&quot;banwagong1234&quot;,</div><div class="line">    &quot;8989&quot;:&quot;banwagong1234&quot;</div><div class="line">&#125;,</div><div class="line">    &quot;timeout&quot;:120,</div><div class="line">    &quot;method&quot;:&quot;none&quot;,</div><div class="line">    &quot;protocol&quot;:&quot;auth_chain_a&quot;,</div><div class="line">    &quot;protocol_param&quot;:&quot;&quot;,</div><div class="line">    &quot;obfs&quot;:&quot;tls1.2_ticket_auth&quot;,</div><div class="line">    &quot;obfs_param&quot;:&quot;&quot;,</div><div class="line">    &quot;redirect&quot;:&quot;&quot;,</div><div class="line">    &quot;dns_ipv6&quot;:false,</div><div class="line">    &quot;fast_open&quot;:false,</div><div class="line">    &quot;workers&quot;:1</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p><p><a href="https://github.com/iMeiji/shadowsocks_install/blob/master/shadowsocksR-wiki/ShadowsocksR%20%E5%8D%8F%E8%AE%AE%E6%8F%92%E4%BB%B6%E6%96%87%E6%A1%A3.md" target="_blank" rel="external">ShadowsocksR åè®®æ’ä»¶æ–‡æ¡£</a></p><h1 id="å¼€å¯TCP-BBRæ‹¥å¡æ§åˆ¶ç®—æ³•"><a href="#å¼€å¯TCP-BBRæ‹¥å¡æ§åˆ¶ç®—æ³•" class="headerlink" title="å¼€å¯TCP BBRæ‹¥å¡æ§åˆ¶ç®—æ³•"></a>å¼€å¯TCP BBRæ‹¥å¡æ§åˆ¶ç®—æ³•</h1><p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p><p><a href="https://github.com/iMeiji/shadowsocks_install/wiki/%E5%BC%80%E5%90%AFTCP-BBR%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E7%AE%97%E6%B3%95" target="_blank" rel="external">shadowsocksR ä¸€é”®å®‰è£…</a></p><h1 id="Crontab-å®šæ—¶ä»»åŠ¡"><a href="#Crontab-å®šæ—¶ä»»åŠ¡" class="headerlink" title="Crontab å®šæ—¶ä»»åŠ¡"></a>Crontab å®šæ—¶ä»»åŠ¡</h1><p>VPS centos å®šæ—¶é‡å¯</p><h2 id="centos-ä¸‹å®‰è£…crontab"><a href="#centos-ä¸‹å®‰è£…crontab" class="headerlink" title="centos ä¸‹å®‰è£…crontab"></a>centos ä¸‹å®‰è£…crontab</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">yum install crontab</div><div class="line">chkconfig crond on</div><div class="line">service crond start</div></pre></td></tr></table></figure><p>è®¾ç½®ä¸€ä¸‹ä¸­å›½æ—¶åŒº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@host ~]# date -R; date +%z  </div><div class="line">Sat, 16 Dec 2017 01:41:29 -0500</div><div class="line">-0500</div><div class="line">[root@host ~]# cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</div></pre></td></tr></table></figure><p>æŸ¥çœ‹ä»»åŠ¡ï¼šcrontab -l</p><p>ç¼–è¾‘ä»»åŠ¡ï¼šcrontab -e</p><p>å‡Œæ™¨5ç‚¹é‡å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 5  * * * /sbin/shutdown -r now</div></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸Šä¸€æ¬¡æƒ…å†µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">last</div></pre></td></tr></table></figure><p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p><p><a href="http://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html" target="_blank" rel="external">crontab å®šæ—¶ä»»åŠ¡</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt; æœ€è¿‘ä¹°çš„Shadowsocks è´¦å·éƒ½è¢«å°äº†ã€‚æ— å¥ˆåªå¥½èŠ±$28.19 USDä¹°äº†ä¸ªæ¬ç“¦å·¥VPS,åˆç®€å•æ­å»ºShadowsocksRè¿›è¡Œç§‘å­¦ä¸Šç½‘.&lt;br&gt;
    
    </summary>
    
      <category term="ç§‘å­¦ä¸Šç½‘" scheme="http://lazy.github.io/categories/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
    
      <category term="Shadowsocks" scheme="http://lazy.github.io/tags/Shadowsocks/"/>
    
  </entry>
  
  <entry>
    <title>è®°å½•åšå®¢å¥½æ–‡</title>
    <link href="http://lazy.github.io/2017/11/01/blog/Blog-like/"/>
    <id>http://lazy.github.io/2017/11/01/blog/Blog-like/</id>
    <published>2017-11-01T14:56:35.235Z</published>
    <updated>2018-01-15T15:41:37.881Z</updated>
    
    <content type="html"><![CDATA[<p>æ”¶é›†åšå®¢å¥½æ–‡</p><a id="more"></a> <h2 id="Android-Studio"><a href="#Android-Studio" class="headerlink" title="Android Studio"></a>Android Studio</h2><p><a href="https://mp.weixin.qq.com/s/RzZ8rhYWZQ9ncdci1cRvJA" target="_blank" rel="external">Android Studio è°ƒè¯•æŠ€å·§</a></p><h1 id="Android-æŠ€æœ¯è¿›é˜¶"><a href="#Android-æŠ€æœ¯è¿›é˜¶" class="headerlink" title="Android æŠ€æœ¯è¿›é˜¶"></a>Android æŠ€æœ¯è¿›é˜¶</h1><p><a href="https://juejin.im/post/59b541795188257e8822dfd9" target="_blank" rel="external">Android å¼€å‘è€…è¯¥å¦‚ä½•è¿›é˜¶ï¼Ÿ</a></p><h2 id="Android-äº‹ä»¶"><a href="#Android-äº‹ä»¶" class="headerlink" title="Android äº‹ä»¶"></a>Android äº‹ä»¶</h2><p><a href="https://user-gold-cdn.xitu.io/2017/9/10/9165b4353b1d09b379b69e4e9ba90f0f?imageView2/0/w/1280/h/960" target="_blank" rel="external">Android äº‹ä»¶åˆ†å‘</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ”¶é›†åšå®¢å¥½æ–‡&lt;/p&gt;
    
    </summary>
    
      <category term="åšå®¢å¥½æ–‡" scheme="http://lazy.github.io/categories/%E5%8D%9A%E5%AE%A2%E5%A5%BD%E6%96%87/"/>
    
    
      <category term="Android&amp;Java" scheme="http://lazy.github.io/tags/Android-Java/"/>
    
  </entry>
  
  <entry>
    <title>Linuxã€Macä¸‹GBKä¸UTF8ç¼–ç æ–‡ä»¶çš„æ‰¹é‡è½¬æ¢</title>
    <link href="http://lazy.github.io/2017/10/10/tools/iconv-shell/"/>
    <id>http://lazy.github.io/2017/10/10/tools/iconv-shell/</id>
    <published>2017-10-10T09:22:27.000Z</published>
    <updated>2018-01-09T14:52:21.885Z</updated>
    
    <content type="html"><![CDATA[<p>ä½¿ç”¨ iconv è¿›è¡Œæ‰¹é‡è½¬ç è„šæœ¬å·¥å…·</p><a id="more"></a> <h1 id="Linuxã€Macä¸‹GBKä¸UTF8ç¼–ç æ–‡ä»¶çš„æ‰¹é‡è½¬æ¢è„šæœ¬"><a href="#Linuxã€Macä¸‹GBKä¸UTF8ç¼–ç æ–‡ä»¶çš„æ‰¹é‡è½¬æ¢è„šæœ¬" class="headerlink" title="Linuxã€Macä¸‹GBKä¸UTF8ç¼–ç æ–‡ä»¶çš„æ‰¹é‡è½¬æ¢è„šæœ¬"></a>Linuxã€Macä¸‹GBKä¸UTF8ç¼–ç æ–‡ä»¶çš„æ‰¹é‡è½¬æ¢è„šæœ¬</h1><p>ä½¿ç”¨ iconv è¿›è¡Œæ‰¹é‡è½¬ç </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">FILES=$(find . -type f -name <span class="string">'*.java'</span>)</div><div class="line"><span class="keyword">for</span> f <span class="keyword">in</span> <span class="variable">$FILES</span></div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="keyword">if</span> <span class="built_in">test</span> <span class="_">-f</span> <span class="variable">$f</span>; <span class="keyword">then</span></div><div class="line">        CHARSET=<span class="string">"<span class="variable">$( file --mime-encoding "$f"| awk -F ": " '&#123;print $2&#125;')</span>"</span></div><div class="line">        <span class="keyword">if</span> [ <span class="string">"<span class="variable">$CHARSET</span>"</span> != utf-8 ]; <span class="keyword">then</span></div><div class="line">            sh -c <span class="string">"iconv -f <span class="variable">$CHARSET</span> -t UTF-8 <span class="variable">$f</span> &gt; <span class="variable">$f</span>.temp"</span></div><div class="line">            mv <span class="_">-f</span> <span class="string">"<span class="variable">$f</span>.temp"</span> <span class="variable">$f</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"\nSkipping <span class="variable">$f</span> - it's a regular file"</span>;</div><div class="line">    <span class="keyword">fi</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure><p>ç»ˆç«¯è¿è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sh to.sh</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½¿ç”¨ iconv è¿›è¡Œæ‰¹é‡è½¬ç è„šæœ¬å·¥å…·&lt;/p&gt;
    
    </summary>
    
      <category term="å·¥å…·" scheme="http://lazy.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="è„šæœ¬å·¥å…·" scheme="http://lazy.github.io/tags/%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>è®°å½•Android</title>
    <link href="http://lazy.github.io/2017/09/23/android/Android%20NOTE/"/>
    <id>http://lazy.github.io/2017/09/23/android/Android NOTE/</id>
    <published>2017-09-23T03:21:46.000Z</published>
    <updated>2018-01-15T15:42:27.306Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•Android ç‚¹æ»´</p><a id="more"></a> <h2 id="AppCompat-Theme-Fullscreen"><a href="#AppCompat-Theme-Fullscreen" class="headerlink" title="AppCompat Theme Fullscreen"></a>AppCompat Theme Fullscreen</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"Theme.AppCompat.Light.NoActionBar.FullScreen"</span> <span class="attr">parent</span>=<span class="string">"@style/Theme.AppCompat.Light"</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowNoTitle"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowActionBar"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowFullscreen"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowContentOverlay"</span>&gt;</span>@null<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="Actiivity-åŠ¨ç”»"><a href="#Actiivity-åŠ¨ç”»" class="headerlink" title="Actiivity åŠ¨ç”»"></a>Actiivity åŠ¨ç”»</h2><p>overridePendingTransitionæ–¹æ³•éœ€è¦åœ¨startAtivityæ–¹æ³•æˆ–è€…æ˜¯finishæ–¹æ³•è°ƒç”¨ä¹‹åç«‹å³æ‰§è¡Œ</p><h3 id="Andoid-studio-ç¼–ç è®¾ç½®"><a href="#Andoid-studio-ç¼–ç è®¾ç½®" class="headerlink" title="Andoid studio ç¼–ç è®¾ç½®"></a>Andoid studio ç¼–ç è®¾ç½®</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">compileOptions &#123;</div><div class="line">    encoding <span class="string">"GBK"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">     useLibrary <span class="string">'org.apache.http.legacy'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="adb"><a href="#adb" class="headerlink" title="adb"></a>adb</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adb shell getprop</div><div class="line">adb shell getprop ro.product.cpu.abi</div></pre></td></tr></table></figure><h2 id="camera"><a href="#camera" class="headerlink" title="camera"></a>camera</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hw.camera=yes</div><div class="line">hw.camera.back: webcam0</div><div class="line">hw.camera.front: webcam0</div></pre></td></tr></table></figure><h2 id="gradle-build-error"><a href="#gradle-build-error" class="headerlink" title="gradle build error"></a>gradle build error</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Unsupported major.minor version <span class="number">52.0</span></div><div class="line"></div><div class="line">use jdk <span class="number">8</span></div></pre></td></tr></table></figure><h2 id="python-ç¯å¢ƒå·¥å…·"><a href="#python-ç¯å¢ƒå·¥å…·" class="headerlink" title="python ç¯å¢ƒå·¥å…·"></a>python ç¯å¢ƒå·¥å…·</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">virtualenv -p python3 test</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•Android ç‚¹æ»´&lt;/p&gt;
    
    </summary>
    
      <category term="Androidéšç¬”è®°å½•" scheme="http://lazy.github.io/categories/Android%E9%9A%8F%E7%AC%94%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="Android" scheme="http://lazy.github.io/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>AndroidJUnit4 ç”¨æ³•</title>
    <link href="http://lazy.github.io/2017/08/30/android/AndroidJUnit4/"/>
    <id>http://lazy.github.io/2017/08/30/android/AndroidJUnit4/</id>
    <published>2017-08-30T02:05:07.000Z</published>
    <updated>2018-01-15T15:15:26.697Z</updated>
    
    <content type="html"><![CDATA[<p>AndroidJUnit4 æ˜¯ä¸€ä¸ªè®© <a href="http://www.oschina.net/p/junit" target="_blank" rel="external">JUnit</a> 4 å¯ä»¥ç›´æ¥è¿è¡Œåœ¨ Android è®¾å¤‡ä¸Šçš„å¼€æºå·¥å…·ã€‚</p><a id="more"></a> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RunWith</span>(AndroidJUnit4.class)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTest</span></span></div></pre></td></tr></table></figure><ul><li>@Testï¼šæŠŠä¸€ä¸ªæ–¹æ³•æ ‡è®°ä¸ºæµ‹è¯•æ–¹æ³•</li><li>@Beforeï¼šæ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰è‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡</li><li>@Afterï¼šæ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œå®Œè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡</li><li>@BeforeClassï¼šæ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œä¸€æ¬¡ï¼Œåœ¨æµ‹è¯•ç±»è¿˜æ²¡æœ‰å®ä¾‹åŒ–å°±å·²ç»è¢«åŠ è½½ï¼Œæ‰€ä»¥ç”¨staticä¿®é¥°</li><li>@AfterClassï¼šæ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œå®Œæ‰§è¡Œä¸€æ¬¡ï¼Œåœ¨æµ‹è¯•ç±»è¿˜æ²¡æœ‰å®ä¾‹åŒ–å°±å·²ç»è¢«åŠ è½½ï¼Œæ‰€ä»¥ç”¨staticä¿®é¥°</li><li>@Ignoreï¼šæš‚ä¸æ‰§è¡Œè¯¥æµ‹è¯•æ–¹æ³•</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@FixMethodOrder(MethodSorters.NAME_ASCENDING)</span>  <span class="comment">//ç»™æˆ‘æŒ‰nameé¡ºåºæ‰§è¡Œ</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;AndroidJUnit4 æ˜¯ä¸€ä¸ªè®© &lt;a href=&quot;http://www.oschina.net/p/junit&quot;&gt;JUnit&lt;/a&gt; 4 å¯ä»¥ç›´æ¥è¿è¡Œåœ¨ Android è®¾å¤‡ä¸Šçš„å¼€æºå·¥å…·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Androidéšç¬”è®°å½•" scheme="http://lazy.github.io/categories/Android%E9%9A%8F%E7%AC%94%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="AndroidJUnit" scheme="http://lazy.github.io/tags/AndroidJUnit/"/>
    
  </entry>
  
  <entry>
    <title>My Git Note</title>
    <link href="http://lazy.github.io/2017/08/23/git/git-note/"/>
    <id>http://lazy.github.io/2017/08/23/git/git-note/</id>
    <published>2017-08-23T02:50:04.000Z</published>
    <updated>2018-01-15T15:04:51.477Z</updated>
    
    <content type="html"><![CDATA[<p>git å¸¸ç”¨å‘½ä»¤å¤‡å¿˜å½•</p><a id="more"></a> <h2 id="git-æäº¤æ—¶çš„ç”¨æˆ·å’Œé‚®ç®±"><a href="#git-æäº¤æ—¶çš„ç”¨æˆ·å’Œé‚®ç®±" class="headerlink" title="git æäº¤æ—¶çš„ç”¨æˆ·å’Œé‚®ç®±"></a>git æäº¤æ—¶çš„ç”¨æˆ·å’Œé‚®ç®±</h2><p>æŸ¥çœ‹å…¨å±€çš„è®¾ç½®ä¸­çš„ç”¨æˆ·å’Œé‚®ç®±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.name </div><div class="line">git config --global user.email</div></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰çš„è®¾ç½®ä¸­çš„ç”¨æˆ·å’Œé‚®ç®±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config user.name </div><div class="line">git config user.email</div></pre></td></tr></table></figure><p>è¦æ˜¯æƒ³ä¿®æ”¹çš„è¯ç›´æ¥åœ¨æŸ¥çœ‹å‘½ä»¤ååŠ è¦ä¿®æ”¹çš„å€¼å¦‚:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config user.name &quot;YourName&quot;</div></pre></td></tr></table></figure><h2 id="git-stashæ¢å¤"><a href="#git-stashæ¢å¤" class="headerlink" title="git stashæ¢å¤"></a>git stashæ¢å¤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git stash pop stash@&#123;num&#125;</div></pre></td></tr></table></figure><h2 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h2><p><code>git remote</code>å‘½ä»¤åˆ—å‡ºæ‰€æœ‰è¿œç¨‹ä¸»æœºï¼Œä½¿ç”¨<code>-v</code>é€‰é¡¹ï¼Œå¯ä»¥å‚çœ‹è¿œç¨‹ä¸»æœºçš„ç½‘å€</p><p><code>git remote add</code>å‘½ä»¤ç”¨äºæ·»åŠ è¿œç¨‹ä¸»æœºã€‚</p><p><code>git remote rm</code>å‘½ä»¤ç”¨äºåˆ é™¤è¿œç¨‹ä¸»æœºã€‚</p><p><code>git remote rename</code>å‘½ä»¤ç”¨äºè¿œç¨‹ä¸»æœºçš„æ”¹åã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;git å¸¸ç”¨å‘½ä»¤å¤‡å¿˜å½•&lt;/p&gt;
    
    </summary>
    
      <category term="Gitéšç¬”è®°å½•" scheme="http://lazy.github.io/categories/Git%E9%9A%8F%E7%AC%94%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="git" scheme="http://lazy.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäº android-x86-4.4-r5 åˆ†æ”¯ç¼–è¯‘æ„å»ºlive cdrom isoæ˜ åƒ</title>
    <link href="http://lazy.github.io/2017/06/26/asop/android-x86-make-iso/"/>
    <id>http://lazy.github.io/2017/06/26/asop/android-x86-make-iso/</id>
    <published>2017-06-26T13:30:53.000Z</published>
    <updated>2018-02-24T16:04:10.873Z</updated>
    
    <content type="html"><![CDATA[<p>å·¥ä½œéœ€è¦, åŸºäº android-x86-4.4-r5 åˆ†æ”¯ç¼–è¯‘æ„å»ºlive cdrom isoæ˜ åƒ</p><a id="more"></a> <h2 id="åœ¨Android-x86æ ‘ä¸Šé€‰æ‹©åˆ†æ”¯"><a href="#åœ¨Android-x86æ ‘ä¸Šé€‰æ‹©åˆ†æ”¯" class="headerlink" title="åœ¨Android-x86æ ‘ä¸Šé€‰æ‹©åˆ†æ”¯"></a>åœ¨Android-x86æ ‘ä¸Šé€‰æ‹©åˆ†æ”¯</h2><p>è¿™é‡Œæˆ‘é€‰æ‹© <code>android-x86-4.4-r5</code> åˆ†æ”¯</p><h2 id="å»ºç«‹ä¸€ä¸ªLinuxæ„å»ºç¯å¢ƒ"><a href="#å»ºç«‹ä¸€ä¸ªLinuxæ„å»ºç¯å¢ƒ" class="headerlink" title="å»ºç«‹ä¸€ä¸ªLinuxæ„å»ºç¯å¢ƒ"></a>å»ºç«‹ä¸€ä¸ªLinuxæ„å»ºç¯å¢ƒ</h2><blockquote><p>Android x86-4.4-r5ç‰ˆæœ¬åœ¨æœ€è¿‘ç‰ˆæœ¬çš„Ubuntu LTSï¼ˆ16.04ï¼‰64ä½ä¸Šè¿›è¡Œæµ‹è¯•ï¼Œå…·æœ‰æ‰€éœ€çš„æ„å»ºå·¥å…·ã€‚<br>åœ¨ä¸‹è½½å’Œæ„å»ºAndroid-x86æºä»£ç ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š</p></blockquote><ul><li>è‡³å°‘100GBçš„å¯ç”¨ç£ç›˜ç©ºé—´</li><li>Python 2.6 - 2.7ï¼Œä½ å¯ä»¥ä»python.orgä¸‹è½½ã€‚</li><li>GNU Make 3.81 - 3.82ï¼Œä½ å¯ä»¥ä»gnu.orgä¸‹è½½ï¼Œ</li><li>åœ¨Androidå¼€æºé¡¹ç›®ï¼ˆAOSPï¼‰ä¸­æ„å»ºAndroidçš„4.4åˆ†æ”¯éœ€è¦JDK 6</li><li>Git 1.7æˆ–æ›´æ–°ã€‚ä½ å¯ä»¥åœ¨git-scm.comæ‰¾åˆ°å®ƒã€‚</li></ul><p><strong>è¯·æ³¨æ„ :</strong> å¯¹äº<strong>kitkat-x86</strong>æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œ64ä½ç¯å¢ƒæ˜¯<strong>å¿…éœ€</strong>çš„ã€‚</p><h4 id="å®‰è£…JDK"><a href="#å®‰è£…JDK" class="headerlink" title="å®‰è£…JDK"></a>å®‰è£…JDK</h4><ol><li>ä»<a href="http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase6-419409.html#jdk-6u31-oth-JPR" target="_blank" rel="external">oracle jdk-6u31</a>ä¸‹è½½Java JDK ã€‚</li><li>ç‚¹å‡»<strong>æ¥å—è®¸å¯åè®®</strong></li><li>ç‚¹å‡»<strong>jdk-6u31-linux-x64.bin</strong></li><li>ç”¨æ‚¨çš„Oracleå¸æˆ·ç™»å½•åˆ°Oracle.com</li><li>å°†JDKä¸‹è½½åˆ°æ‚¨çš„<strong>ã€œ/ Downloads</strong>ç›®å½•</li><li>ä¸‹è½½åï¼Œæ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~/Downloads</div><div class="line">chmod +x jdk-6u31-linux-x64.bin</div><div class="line">./jdk-6u31-linux-x64.bin</div></pre></td></tr></table></figure><p>æ ¹æ®ç”Ÿæˆjdk ç›®å½•é…ç½®ç¯å¢ƒå˜é‡, æ‰§è¡Œå‘½ä»¤: <code>vi ~/.bashrc</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> JAVA_HOME=/home/jfn/androidDevelop/jdk1.6.0_31 <span class="comment">#jdkçš„ä¸»ç›®å½•</span></div><div class="line"><span class="built_in">export</span> JRE_HOME=<span class="variable">$JAVA_HOME</span>/jre</div><div class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib:<span class="variable">$JRE_HOME</span>/lib:<span class="variable">$CLASSPATH</span></div><div class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JRE_HOME</span>/bin:<span class="variable">$ANDROID_SDK</span>/platform-tools:<span class="variable">$PATH</span></div></pre></td></tr></table></figure><p>ä½¿jdkç¯å¢ƒå˜é‡ç”Ÿæ•ˆ, æ‰§è¡Œ <code>source ~/.bashrc</code></p><p>æŸ¥çœ‹jdkç‰ˆæœ¬, æ‰§è¡Œ <code>java -versionã€javac â€“version</code></p><h4 id="å®‰è£…make-3-81"><a href="#å®‰è£…make-3-81" class="headerlink" title="å®‰è£…make-3.81"></a>å®‰è£…make-3.81</h4><p>1.ä¸‹è½½å¹¶è§£å‹make-3.81.tar.bz2ï¼Œè¿›å…¥make-3.81ç›®å½•å¹¶æ‰§è¡Œ <code>./configure</code></p><p>2.æ‰§è¡Œå®Œåmake-3.81ç›®å½•ä¼šå¤šå‡ºä¸€ä¸ªbuild.shæ–‡ä»¶ï¼Œæ‰§è¡Œ<code>./build.sh</code> å³å¯å¾—åˆ°makeæ–‡ä»¶</p><p>3.éªŒè¯ç¼–è¯‘å‡ºæ¥çš„makeæ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„3.81ç‰ˆæœ¬ã€‚<code>make -v</code></p><p>4.æ›¿æ¢ç³»ç»ŸåŸæœ‰çš„makeã€‚ï¼ˆè®°å¾—å¤‡ä»½åŸæœ‰æ–‡ä»¶ã€‚ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/bin/</div><div class="line">sudo mv ./make ./make.backup</div><div class="line">mv ~/make-3.81/make ./</div></pre></td></tr></table></figure><h4 id="å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼ˆUbuntu-16-04ï¼‰"><a href="#å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼ˆUbuntu-16-04ï¼‰" class="headerlink" title="å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼ˆUbuntu 16.04ï¼‰"></a><strong>å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…</strong>ï¼ˆUbuntu 16.04ï¼‰</h4><p>æ‚¨å°†éœ€è¦ä¸€ä¸ª64ä½ç‰ˆæœ¬çš„Ubuntuã€‚æ¨èUbuntu 16.04ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install git-core gnupg flex bison gperf build-essential \</div><div class="line">   zip curl zlib1g-dev gcc-multilib g ++  -  multilib libc6-dev-i386 \</div><div class="line">   lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z-dev ccache \</div><div class="line">   libgl1-mesa-dev libxml2-utils xsltproc unzip squashfs-tools python-mako</div></pre></td></tr></table></figure><p>ä½ è¿˜éœ€è¦å®‰è£…OpenSSLç›¸åº”è½¯ä»¶åŒ…ã€‚OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠSSLåè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install apache2      ##å®‰è£…Apache</div><div class="line">sudo apt-get install openssl      ##å®‰è£…openssl</div><div class="line">sudo apt-get install libssl-dev    ##å®‰è£…opensslå¼€å‘åº“</div><div class="line">sudo apt-get install bless      ##ç¼–è¾‘å™¨ä½¿ç”¨ bless åå…­è¿›åˆ¶ç¼–è¾‘å™¨,éœ€é¢„å…ˆå®‰è£…</div></pre></td></tr></table></figure><h2 id="è·å–-Android-æºç "><a href="#è·å–-Android-æºç " class="headerlink" title="è·å– Android æºç "></a>è·å– Android æºç </h2><p><a href="http://www.android-x86.org/" target="_blank" rel="external">Android x86 å¼€æºé¡¹ç›®</a> ç½‘ç«™æä¾›äº†ï¼Œè·å–æ–¹æ³•å¦‚ä¸‹:</p><p>â€‹    <a href="http://www.android-x86.org/getsourcecode" target="_blank" rel="external">http://www.android-x86.org/getsourcecode</a></p><p>ä¸‹é¢ä»‹ç»äº† <code>repo</code> å·¥å…·çš„å®‰è£…,ä»¥åŠåŸºæœ¬ç”¨æ³•ã€‚</p><h3 id="Installing-Repo"><a href="#Installing-Repo" class="headerlink" title="Installing Repo"></a>Installing Repo</h3><p>1.ç¡®ä¿æ‚¨çš„ä¸»ç›®å½•ä¸­æœ‰ä¸€ä¸ªbin /ç›®å½•ï¼Œå¹¶å°†å…¶åŒ…å«åœ¨æ‚¨çš„è·¯å¾„ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir ~/bin</div><div class="line">PATH=~/bin:$PATH</div></pre></td></tr></table></figure><p>2.ä¸‹è½½Repoå·¥å…·å¹¶ç¡®ä¿å®ƒæ˜¯å¯æ‰§è¡Œçš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo</div><div class="line">chmod a+x ~/bin/repo</div></pre></td></tr></table></figure><p>3.é€šè¿‡ <code>repo init</code> å°†å½“å‰ç›®å½•åˆå§‹åŒ–ä¸ºå·¥ä½œåŒº,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir android-x86</div><div class="line">cd android-x86</div><div class="line">repo init -u git://git.osdn.net/gitroot/android-x86/manifest -b android-x86-4.4-r5</div></pre></td></tr></table></figure><p>NOTE:ç”±äºç½‘ç»œåŸå› å›½å†…çš„è®¿é—®ä¸äº†googleçš„ä»“åº“ï¼Œéœ€è¦æŠŠ REPO_URL = â€˜<a href="https://gerrit.googlesource.com/git-repo&#39;%E6%94%B9%E4%B8%BA" target="_blank" rel="external">https://gerrit.googlesource.com/git-repoâ€™ æ”¹ä¸º</a> REPO_URL = â€˜git://git.omapzoom.org/git-repo.gitâ€™ ã€‚å¦å¤–è¿˜éœ€ç§‘å­¦ä¸Šç½‘download æºç ï¼Œè¿™é‡Œæ¨è</p><p><code>Shadowsocks-Qt5</code> , é…ç½®å¥½ç½‘ç»œä»£ç†åï¼Œè¿˜éœ€è¦è®¾ç½®git çš„ä»£ç†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config --global https.proxy https://127.0.0.1:1080</div></pre></td></tr></table></figure><p>4.ä½¿ç”¨èº«ä»½éªŒè¯</p><p>æ³¨æ„: é»˜è®¤æƒ…å†µä¸‹ï¼Œè®¿é—® Android æºä»£ç å‡ä¸ºåŒ¿åæ“ä½œã€‚ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨è¢«è¿‡åº¦ä½¿ç”¨ï¼Œæ¯ä¸ª IP åœ°å€éƒ½æœ‰ä¸€ä¸ªç›¸å…³è”çš„é…é¢ã€‚æ­£å¸¸æ¥è¯´æ˜¯ä¸‹è½½æºç ä¸æˆåŠŸçš„ï¼Œè¯·å‚è€ƒå®˜æ–¹ASOP  <a href="https://source.android.com/setup/downloading" target="_blank" rel="external">ä¸‹è½½æºä»£ç </a></p><p>5.repo init å®Œæˆ</p><p>æˆåŠŸåˆå§‹åŒ–å,ä¼šåœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»º <code>.repo</code> æ–‡ä»¶å¤¹ï¼ˆéšè—çš„ï¼‰,å¹¶ä» <code>-u</code> å‚æ•°æ‰€æŒ‡å®šçš„repository ä¸‹è½½ä¸€ä¸ª <code>mainffest.xml</code> æ–‡ä»¶åˆ°<code>.repo</code> æ–‡ä»¶å¤¹ã€‚æ¸…å•æ–‡ä»¶å®šä¹‰äº†Androidæºä»£ç ä¸­æ‰€æœ‰çš„gité¡¹ç›®çš„æ¸…å•ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">manifest</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">remote</span>  <span class="attr">name</span>=<span class="string">"aosp"</span></span></div><div class="line">           <span class="attr">fetch</span>=<span class="string">".."</span> /&gt;</div><div class="line">  <span class="tag">&lt;<span class="name">default</span> <span class="attr">revision</span>=<span class="string">"refs/tags/android-7.1.1_r28"</span></span></div><div class="line">           <span class="attr">remote</span>=<span class="string">"aosp"</span></div><div class="line">           <span class="attr">sync-j</span>=<span class="string">"4"</span> /&gt;</div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">project</span> <span class="attr">path</span>=<span class="string">"build"</span> <span class="attr">name</span>=<span class="string">"platform/build"</span> <span class="attr">groups</span>=<span class="string">"pdk,tradefed"</span> &gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">copyfile</span> <span class="attr">src</span>=<span class="string">"core/root.mk"</span> <span class="attr">dest</span>=<span class="string">"Makefile"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">project</span>&gt;</span></div><div class="line">  ...</div><div class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></div></pre></td></tr></table></figure><p>æ˜¾è€Œæ˜“è§ï¼Œå…¶ä¸­æ¯ä¸ª project é¡¹éƒ½ä»£è¡¨ä¸€ä¸ª git é¡¹ç›®ï¼Œ<code>name</code> å±æ€§æŒ‡å®šäº†git é¡¹ç›®åç§°ï¼Œ<code>path</code>å±æ€§æŒ‡å®šäº†git é¡¹ç›®å°†è¢«ä¸‹è½½åˆ°å“ªä¸ªæ–‡ä»¶ä¸­ã€‚<code>revision</code> æŒ‡å®šäº†é‚£ä¸ªåˆ†æ”¯çš„ä»£ç ã€‚é€šè¿‡ <code>repo sync</code> å‘½ä»¤ä¾¿å¯ä»¥ä¸‹è½½ä»£ç ã€‚<code>repo sync</code> å¯ä»¥æ¥å— -j å‚æ•°è¿›è¡Œå¤šçº¿ç¨‹çš„ä»£ç ä¸‹è½½ä»¥æé«˜ä¸‹è½½é€Ÿåº¦ã€‚ä¾‹ï¼š<code>repo sync -j4</code> ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">repo sync platform/frameworks/base</div></pre></td></tr></table></figure><p>repo sync ä¹Ÿå¯ä»¥æ¥å— git é¡¹ç›®åç§°ä½œä¸ºå‚æ•°å•ç‹¬ä¸‹è½½è¿™ä¸ªé¡¹ç›®çš„ä»£ç ã€‚</p><p>6.ä»Android æºä»£ç æ ‘é»˜è®¤æ¸…å•ä¸­æŒ‡å®šçš„ä»£ç åº“ä¸‹è½½åˆ°å·¥ä½œç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">repo sync</div></pre></td></tr></table></figure><h2 id="ç¼–è¯‘Androidæºç "><a href="#ç¼–è¯‘Androidæºç " class="headerlink" title="ç¼–è¯‘Androidæºç "></a>ç¼–è¯‘Androidæºç </h2><h3 id="ç›´æ¥æ„å»ºä¸€ä¸ªlive-cdrom-isoæ˜ åƒ"><a href="#ç›´æ¥æ„å»ºä¸€ä¸ªlive-cdrom-isoæ˜ åƒ" class="headerlink" title="ç›´æ¥æ„å»ºä¸€ä¸ªlive cdrom isoæ˜ åƒ"></a>ç›´æ¥æ„å»ºä¸€ä¸ªlive cdrom isoæ˜ åƒ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make iso_img TARGET_PRODUCT = android_x86</div></pre></td></tr></table></figure><p>æ³¨æ„: android-x86-4.4-r5 åˆ†æ”¯ è¯·å¿…é¡»ç›´æ¥æŒ‰ä¸Šæ„å»ºiso æ˜ åƒ</p><h3 id="ç¼–è¯‘è¦æ±‚"><a href="#ç¼–è¯‘è¦æ±‚" class="headerlink" title="ç¼–è¯‘è¦æ±‚"></a>ç¼–è¯‘è¦æ±‚</h3><p>ä¸‹è½½å’Œç¼–è¯‘ Android æºä»£ç ä¹‹å‰ï¼Œè¯·å…ˆç¡®ä¿æ‚¨çš„ç³»ç»Ÿç¬¦åˆå®˜æ–¹è¦æ±‚ã€‚è¯·å‚é˜…<a href="https://source.android.com/source/requirements" target="_blank" rel="external">requirements</a></p><h3 id="ç¼–è¯‘é”™è¯¯"><a href="#ç¼–è¯‘é”™è¯¯" class="headerlink" title="ç¼–è¯‘é”™è¯¯"></a>ç¼–è¯‘é”™è¯¯</h3><p>ç¼–è¯‘Android æºç æ€»ä¸ä¼šä¸€å¸†é£é¡ºçš„ã€‚æ ¹æ®é”™è¯¯ä¿¡æ¯æç¤ºï¼Œå°‘äº†ä»€ä¹ˆå°±å®‰è£…ä»€ä¹ˆã€‚æ¯”å¦‚ï¼š<code>/bin/bash: xmllint: æœªæ‰¾åˆ°å‘½ä»¤</code>   å°±æ‰§è¡Œ<code>sudo apt-get install libxml2</code> å³å¯ï¼Œc++ å¤´æ–‡ä»¶ã€Python module ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦å¤–å¤šæŸ¥æŸ¥èµ„æ–™ã€‚</p><h4 id="hybrid-v35-nodebug-pcoem-6-30-223-271-tar-gz-æ–‡ä»¶ç¼ºå¤±é”™è¯¯"><a href="#hybrid-v35-nodebug-pcoem-6-30-223-271-tar-gz-æ–‡ä»¶ç¼ºå¤±é”™è¯¯" class="headerlink" title="hybrid-v35-nodebug-pcoem-6_30_223_271.tar.gz  æ–‡ä»¶ç¼ºå¤±é”™è¯¯"></a>hybrid-v35-nodebug-pcoem-6_30_223_271.tar.gz  æ–‡ä»¶ç¼ºå¤±é”™è¯¯</h4><p>é”™è¯¯æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">gzip: stdin: unexpected end of file</div><div class="line">tar: Child returned status 1</div><div class="line">tar: Error is not recoverable: exiting now</div><div class="line">make: *** [kernel/drivers/net/wireless/wl/Makefile] Error 2</div><div class="line">make: *** æ­£åœ¨ç­‰å¾…æœªå®Œæˆçš„ä»»åŠ¡....</div><div class="line">make[2]: Entering directory `/home/jfn/androidDevelop/out/target/product/x86/obj/kernel<span class="string">'</span></div><div class="line">  HOSTCC  scripts/basic/fixdep</div><div class="line">  GEN     ./Makefile</div><div class="line">  HOSTCC  scripts/kconfig/conf.o</div><div class="line">  SHIPPED scripts/kconfig/zconf.tab.c</div><div class="line">  SHIPPED scripts/kconfig/zconf.lex.c</div><div class="line">  SHIPPED scripts/kconfig/zconf.hash.c</div><div class="line">  HOSTCC  scripts/kconfig/zconf.tab.o</div><div class="line">  HOSTLD  scripts/kconfig/conf</div><div class="line">scripts/kconfig/conf --olddefconfig Kconfig</div><div class="line">.config:6553:warning: override: reassigning to symbol ANDROID_LOGGER</div><div class="line">.config:6554:warning: override: reassigning to symbol ANDROID_INTF_ALARM_DEV</div><div class="line">#</div><div class="line"># configuration written to .config</div><div class="line">#</div><div class="line">make[2]: Leaving directory `/home/jfn/androidDevelop/out/target/product/x86/obj/kernel'</div><div class="line">make[1]: Leaving directory `/home/jfn/androidDevelop/kernel<span class="string">'</span></div></pre></td></tr></table></figure><p>ç”± tar: Error ,è€Œä¸” /kernel/drivers/net/wireless/wl ä¸‹çš„hybrid-v35-nodebug-pcoem-6_30_223_271.tar.gz æ–‡ä»¶é•¿åº¦ä¸º0. æ‰“å¼€build.mk å‘ç°äº†é€šè¿‡ <a href="http://www.broadcom.com/docs/linux_sta/" target="_blank" rel="external">http://www.broadcom.com/docs/linux_sta/</a> ç½‘ç«™å»ä¸‹è½½çš„ï¼Œè€Œè¿™ä¸ªé“¾æ¥è¿‡æœŸäº†</p><p>ä¸‹è½½ <a href="https://pkgs.rpmfusion.org/repo/pkgs/nonfree/broadcom-wl/hybrid-v35-nodebug-pcoem-6_30_223_271.tar.gz/4e75f4cb7d87f690f9659ffc478495f0/" target="_blank" rel="external">hybrid-v35-nodebug-pcoem-6_30_223_271.tar.gz </a> æ–‡ä»¶æ”¾è¿›å»å†ç¼–è¯‘å°±å¥½äº†ã€‚</p><h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><p>ç”Ÿæˆç³»ç»Ÿé•œåƒåœ¨ä¸‹é¢ç›®å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">out/target/product/x86/android_x86.iso</div></pre></td></tr></table></figure><h2 id="åœ¨-Android-Studioä¸­å¯¼å…¥-Android-æºç "><a href="#åœ¨-Android-Studioä¸­å¯¼å…¥-Android-æºç " class="headerlink" title="åœ¨ Android Studioä¸­å¯¼å…¥ Android æºç "></a>åœ¨ Android Studioä¸­å¯¼å…¥ Android æºç </h2><p>åœ¨ <code>/development/ide</code> ä¸‹åˆ†åˆ«æœ‰eclipse/emacs/intellij è¿™3ä¸ªide çš„é…ç½®æ–‡ä»¶ã€‚å› ä¸ºæºç æ–‡ä»¶ååˆ†å¤š,å¼ºçƒˆå»ºè®®aså¢åŠ jvm å†…å­˜å¤§å°ã€‚</p><h4 id="ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶-ipr"><a href="#ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶-ipr" class="headerlink" title="ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶(*.ipr)"></a>ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶(*.ipr)</h4><ul><li><p>ç¼–è¯‘æºç (ä¸ºäº†ç¡®ä¿ç”Ÿæˆäº†.javaæ–‡ä»¶ï¼Œå¦‚R.javaï¼›å¦‚æœç¼–è¯‘è¿‡ï¼Œåˆ™æ— éœ€å†æ¬¡ç¼–è¯‘)</p></li><li><p>æ£€æŸ¥out/host/linux-x86/framework/ç›®å½•ä¸‹æ˜¯å¦æœ‰idegen.jar</p></li></ul><p>å¦‚æœidegen.jarä¸å­˜åœ¨, æ‰§è¡Œ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mmm development/tools/idegen/</div><div class="line">development/tools/idegen/idegen.sh</div></pre></td></tr></table></figure><p>ç­‰å¾…å‡ºç°ç±»ä¼¼ä¸‹é¢çš„ç»“æœ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Read excludes: 5ms</div><div class="line">Traversed tree: 44078ms</div></pre></td></tr></table></figure><p>è¿™æ—¶ä¼šåœ¨æºç çš„æ ¹ç›®å½•ä¸‹ç”Ÿæˆandroid.iprå’Œandroid.imlä¸¤ä¸ªIntelliJ IDEA(ASæ˜¯åŸºäºIntelliJ IDEAç¤¾åŒºç‰ˆå¼€å‘çš„)çš„é…ç½®æ–‡ä»¶.</p><p>Tipsï¼šASåœ¨å¯¼å…¥ä»£ç æ—¶æ¯”è¾ƒæ…¢ï¼Œå»ºè®®å…ˆä¿®æ”¹android.imlï¼Œå°†è‡ªå·±ç”¨ä¸åˆ°çš„ä»£ç excludeå‡ºå».å¯ä»¥ä»¿ç…§è¿‡æ»¤.repoæ–‡ä»¶å¤¹çš„è¯­æ³•,å¦‚:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;excludeFolder url=&quot;file://$MODULE_DIR$/.repo&quot; /&gt;</div><div class="line">&lt;excludeFolder url=&quot;file://$MODULE_DIR$/abi&quot; /&gt;</div><div class="line">&lt;excludeFolder url=&quot;file://$MODULE_DIR$/art&quot; /&gt;</div><div class="line">...</div></pre></td></tr></table></figure><p>è¿˜å¯ä»¥é€šè¿‡as çš„module settings - dependents åˆ é™¤æ‰æ‰€æœ‰ä¸éœ€è¦çš„module-libraryé¡¹</p><p>è¿™æ ·åœ¨å¯¼å…¥æ—¶å°±ä¼šè·³è¿‡abiå’Œartæ–‡ä»¶å¤¹.è¿‡æ»¤çš„è¶Šå¤šï¼ŒASçš„å¤„ç†é€Ÿåº¦å°±ä¼šè¶Šå¿«.æœ€ååœ¨ASä¸­æ‰“å¼€æºç æ ¹ç›®å½•ä¸‹æ–°ç”Ÿæˆçš„android.ipr</p><h4 id="è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜"><a href="#è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜" class="headerlink" title="è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜"></a>è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜</h4><p>è¦ä¸ºå½“å‰å·¥ç¨‹è®¾ç½®æ­£ç¡®çš„SDKå’ŒJDKï¼Œéœ€è¦Android API 19 Platformï¼Œjdk åˆ™æ— æ‰€è°“ï¼Œå› ä¸ºlibcore ç›®å½•ä¸‹åŒ…æ‹¬äº†jdk çš„æºç ã€‚æ·»åŠ ä¸€ä¸ªjdk æ¥ç€æŠŠclasspath æ‰€æœ‰é¡¹remove æ‰ï¼Œæ¥ç€Android API 19 Platform é€‰æ‹©ç©ºçš„jdk.å¦‚ä¸‹å›¾<br><img src="http://img.blog.csdn.net/20180207145631611?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="æ­¥éª¤1"></p><p>ç‚¹å‡»Project<br><img src="http://img.blog.csdn.net/20180207145747921?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="æ­¥éª¤2"></p><p>ç‚¹å‡»Modules, é€‰æ‹©ç›¸åº”çš„ä»£ç æ¨¡å—ï¼Œæ¯”å¦‚frameworksã€packages ç­‰æºç ç›®å½•ï¼Œä¸”æŠŠå®ƒä»¬ç§»åŠ¨åˆ°æœ€å‰ä¼˜å…ˆä»è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾ï¼Œè€Œä¸æ˜¯åœ¨Android.jarä¸­æŸ¥æ‰¾<br><img src="http://img.blog.csdn.net/20180207145838877?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br>NOTE: Empty Library ä¸è¦ç´§çš„ã€‚</p><h4 id="DEBUGæºç "><a href="#DEBUGæºç " class="headerlink" title="DEBUGæºç "></a>DEBUGæºç </h4><p>åœ¨â€™Modulesâ€™ä¸­æ·»åŠ â€™Android Frameworkâ€™æ¥è®©ASå°†å®ƒä½œä¸ºä¸€ä¸ªAndroidå·¥ç¨‹ï¼Œä»è€Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä»£ç .<br><img src="http://img.blog.csdn.net/20180207150331651?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>åœ¨ä»£ç ä¸­åŠ æ–­ç‚¹ï¼Œç„¶åé€‰æ‹©â€™Runâ€™-&gt;â€™Attach debugger to Android processâ€™æˆ–è€…ç›´æ¥ç‚¹å‡»ToolBar ä¸Šçš„Attach debuggerå›¾æ ‡ã€‚åœ¨å¼¹å‡ºçš„é€‰æ‹©è¿›ç¨‹(Choose Process)å¯¹è¯æ¡†ä¸­ï¼Œå‹¾é€‰æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œé€‰æ‹©è¦DEBUGçš„ä»£ç æ‰€åœ¨çš„è¿›ç¨‹ï¼Œç‚¹å‡»OKå³å¯.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·¥ä½œéœ€è¦, åŸºäº android-x86-4.4-r5 åˆ†æ”¯ç¼–è¯‘æ„å»ºlive cdrom isoæ˜ åƒ&lt;/p&gt;
    
    </summary>
    
      <category term="Androidæºä»£ç å­¦ä¹ " scheme="http://lazy.github.io/categories/Android%E6%BA%90%E4%BB%A3%E7%A0%81%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Android x86" scheme="http://lazy.github.io/tags/Android-x86/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£Androidå¼€ç¯‡ä¹‹Androidæºä»£ç ç¼–è¯‘åŠè°ƒè¯•</title>
    <link href="http://lazy.github.io/2017/06/26/asop/android-open-source/"/>
    <id>http://lazy.github.io/2017/06/26/asop/android-open-source/</id>
    <published>2017-06-26T13:30:53.000Z</published>
    <updated>2018-02-24T16:06:12.461Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ºäº†å­¦ä¹ Android æºç ï¼Œåœ¨Mac ä¸‹ç¼–è¯‘Androidæºç ï¼ŒAndroid Studio ä¸‹è°ƒè¯•ã€‚</p><a id="more"></a> <h2 id="è·å–-Android-æºç "><a href="#è·å–-Android-æºç " class="headerlink" title="è·å– Android æºç "></a>è·å– Android æºç </h2><p>è°·æ­Œå®˜æ–¹æä¾›äº†<a href="https://source.android.com/" target="_blank" rel="external">Android å¼€æºé¡¹ç›®(ç®€ç§°AOSP)</a> ç½‘ç«™ï¼Œè·å–æ–¹æ³•å¦‚ä¸‹:</p><p>â€‹    <a href="https://source.android.com/setup/downloading" target="_blank" rel="external">https://source.android.com/setup/downloading</a></p><p>è¿™ä¸ªé¡µé¢ä»‹ç»äº† <code>repo</code> å·¥å…·çš„å®‰è£…,ä»¥åŠåŸºæœ¬ç”¨æ³•ã€‚</p><h2 id="Installing-Repo"><a href="#Installing-Repo" class="headerlink" title="Installing Repo"></a>Installing Repo</h2><p>1.ç¡®ä¿æ‚¨çš„ä¸»ç›®å½•ä¸­æœ‰ä¸€ä¸ªbin /ç›®å½•ï¼Œå¹¶å°†å…¶åŒ…å«åœ¨æ‚¨çš„è·¯å¾„ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir ~/bin</div><div class="line">PATH=~/bin:$PATH</div></pre></td></tr></table></figure><p>2.ä¸‹è½½Repoå·¥å…·å¹¶ç¡®ä¿å®ƒæ˜¯å¯æ‰§è¡Œçš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo</div><div class="line">chmod a+x ~/bin/repo</div></pre></td></tr></table></figure><p>3.é€šè¿‡ <code>repo init</code> å°†å½“å‰ç›®å½•åˆå§‹åŒ–ä¸ºå·¥ä½œåŒº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">repo init -u &lt;repository åœ°å€&gt; -b &lt;åˆ†æ”¯åç§°&gt;</div></pre></td></tr></table></figure><p>æˆåŠŸåˆå§‹åŒ–å,ä¼šåœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»º <code>.repo</code> æ–‡ä»¶å¤¹ï¼ˆéšè—çš„ï¼‰,å¹¶ä» <code>-u</code> å‚æ•°æ‰€æŒ‡å®šçš„repository ä¸‹è½½ä¸€ä¸ª <code>mainffest.xml</code> æ–‡ä»¶åˆ°<code>.repo</code> æ–‡ä»¶å¤¹ã€‚æ¸…å•æ–‡ä»¶å®šä¹‰äº†Androidæºä»£ç ä¸­æ‰€æœ‰çš„gité¡¹ç›®çš„æ¸…å•ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">manifest</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">remote</span>  <span class="attr">name</span>=<span class="string">"aosp"</span></span></div><div class="line">           <span class="attr">fetch</span>=<span class="string">".."</span> /&gt;</div><div class="line">  <span class="tag">&lt;<span class="name">default</span> <span class="attr">revision</span>=<span class="string">"refs/tags/android-7.1.1_r28"</span></span></div><div class="line">           <span class="attr">remote</span>=<span class="string">"aosp"</span></div><div class="line">           <span class="attr">sync-j</span>=<span class="string">"4"</span> /&gt;</div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">project</span> <span class="attr">path</span>=<span class="string">"build"</span> <span class="attr">name</span>=<span class="string">"platform/build"</span> <span class="attr">groups</span>=<span class="string">"pdk,tradefed"</span> &gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">copyfile</span> <span class="attr">src</span>=<span class="string">"core/root.mk"</span> <span class="attr">dest</span>=<span class="string">"Makefile"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">project</span>&gt;</span></div><div class="line">  ...</div><div class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></div></pre></td></tr></table></figure><p>æ˜¾è€Œæ˜“è§ï¼Œå…¶ä¸­æ¯ä¸ª project é¡¹éƒ½ä»£è¡¨ä¸€ä¸ª git é¡¹ç›®ï¼Œ<code>name</code> å±æ€§æŒ‡å®šäº†git é¡¹ç›®åç§°ï¼Œ<code>path</code>å±æ€§æŒ‡å®šäº†git é¡¹ç›®å°†è¢«ä¸‹è½½åˆ°å“ªä¸ªæ–‡ä»¶ä¸­ã€‚<code>revision</code> æŒ‡å®šäº†é‚£ä¸ªåˆ†æ”¯çš„ä»£ç ã€‚é€šè¿‡ <code>repo sync</code> å‘½ä»¤ä¾¿å¯ä»¥ä¸‹è½½ä»£ç ã€‚<code>repo sync</code> å¯ä»¥æ¥å— -j å‚æ•°è¿›è¡Œå¤šçº¿ç¨‹çš„ä»£ç ä¸‹è½½ä»¥æé«˜ä¸‹è½½é€Ÿåº¦ã€‚ä¾‹ï¼š<code>repo sync -j4</code> ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">repo sync platform/frameworks/base</div></pre></td></tr></table></figure><p>repo sync ä¹Ÿå¯ä»¥æ¥å— git é¡¹ç›®åç§°ä½œä¸ºå‚æ•°å•ç‹¬ä¸‹è½½è¿™ä¸ªé¡¹ç›®çš„ä»£ç ã€‚</p><h3 id="åœ¨çº¿é˜…è¯»Android-æºç "><a href="#åœ¨çº¿é˜…è¯»Android-æºç " class="headerlink" title="åœ¨çº¿é˜…è¯»Android æºç "></a>åœ¨çº¿é˜…è¯»Android æºç </h3><p>AndroidXRef(<a href="http://androidxref.com/" target="_blank" rel="external">http://androidxref.com/</a>)é¡¹ç›®æä¾› Android æºç çš„äº¤å‰ç´¢å¼•ï¼Œå¯ä»¥å¿«é€Ÿçš„æœç´¢ç¬¦åˆç‰¹å®šæ¡ä»¶çš„ Android æºä»£ç ï¼Œåå°æ˜¯åŸºäº OpenGrok å¼•æ“ï¼ŒOpenGrokæ˜¯ä¸€ä¸ªå¿«é€Ÿï¼Œä¾¿äºä½¿ç”¨çš„æºç æœç´¢å¼•æ“ä¸å¯¹ç…§å¼•æ“ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„æœç´¢ã€å®šä½ã€å¯¹ç…§ä»£ç æ ‘ã€‚AndroidXRef æä¾›äº†å®Œæ•´çš„ Android kernelæºç çš„ç´¢å¼•ã€‚åœ¨ AndroidXRef ä¸»é¡µçš„å³ä¾§æ˜¾ç¤ºäº†å¯ç”¨çš„æºç ç‰ˆæœ¬ã€‚</p><h2 id="ç¼–è¯‘Androidæºç "><a href="#ç¼–è¯‘Androidæºç " class="headerlink" title="ç¼–è¯‘Androidæºç "></a>ç¼–è¯‘Androidæºç </h2><h3 id="æ­å»ºç¼–è¯‘ç¯å¢ƒ"><a href="#æ­å»ºç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="æ­å»ºç¼–è¯‘ç¯å¢ƒ"></a>æ­å»ºç¼–è¯‘ç¯å¢ƒ</h3><p>aosp å®˜ç½‘ä¸Šä»‹ç»å¦‚ä½•è®¾ç½®æ‚¨çš„æœ¬åœ°å·¥ä½œç¯å¢ƒæ¥æ„å»ºAndroidæºæ–‡ä»¶ã€‚æ‚¨å°†éœ€è¦ä½¿ç”¨Linuxæˆ–Mac OSã€‚æ¯”å¦‚æˆ‘ç”¨Mac å°±å¯ä»¥å‚è€ƒ<a href="https://source.android.com/source/initializing#setting-up-a-mac-os-x-build-environment" target="_blank" rel="external">Mac ç¼–è¯‘ç¯å¢ƒ</a> è¿›è¡Œé…ç½®ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªåˆ›å»ºå¤§å°å†™æ•æ„Ÿçš„ç£ç›˜æ˜ åƒæ¥è£…æºç ï¼ŒAndroid 6.0çš„ä»£ç å¤§çº¦éœ€è¦50GBï¼Œç¼–è¯‘åè¾¾70å¤šGBã€‚</p><p>1.åˆ›å»ºç£ç›˜ç©ºé—´<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hdiutil create -type SPARSE -fs &apos;Case-sensitive Journaled HFS+&apos; -size 50g ~/android.dmg</div></pre></td></tr></table></figure></p><p>2.è°ƒæ•´ç£ç›˜ç©ºé—´çš„å¤§å°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hdiutil resize -size 85g ~/android.dmg.sparseimage</div></pre></td></tr></table></figure></p><p>3.æŒ‚è½½æ˜ åƒ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">function mountAsop &#123; hdiutil attach /Volumes/Mac/MySourceFiles/aosp/android.dmg.sparseimage -mountpoint /Volumes/android; &#125;</div><div class="line">function umountAsop() &#123; hdiutil detach /Volumes/android; &#125;</div></pre></td></tr></table></figure></p><h3 id="è®¾ç½®æ–‡ä»¶åŒæ—¶æ‰“å¼€æ•°é‡"><a href="#è®¾ç½®æ–‡ä»¶åŒæ—¶æ‰“å¼€æ•°é‡" class="headerlink" title="è®¾ç½®æ–‡ä»¶åŒæ—¶æ‰“å¼€æ•°é‡"></a>è®¾ç½®æ–‡ä»¶åŒæ—¶æ‰“å¼€æ•°é‡</h3><p>åœ¨Macä¸­ï¼Œé»˜è®¤çš„æ–‡ä»¶åŒæ—¶æ‰“å¼€æ•°å®åœ¨å¤ªä½ï¼Œä¸€ä¸ªé«˜é€Ÿå¹¶è¡Œçš„ç¼–è¯‘è¿›ç¨‹è¿è¡Œæ—¶å¯èƒ½ä¼šé‡åˆ°ç“¶é¢ˆã€‚ï¼ˆæ³¨ï¼šMacä¸Š<a href="https://link.jianshu.com?t=http://unix.stackexchange.com/questions/36841/why-is-number-of-open-files-limited-in-linux" target="_blank" rel="external">é™åˆ¶æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°çš„åŸå› </a>æ˜¯æ¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç³»ç»Ÿéƒ½éœ€è¦å†…å­˜æ¥ç®¡ç†å®ƒä»¬ï¼Œå†…å­˜æ˜¯æœ‰é™çš„èµ„æºï¼‰<br>ä¸ºäº†å¢åŠ æœ€å¤§æ–‡ä»¶æ‰“å¼€æ•°é‡ï¼Œåœ¨~/.bash_profileä¸­æ·»åŠ ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># è®¾ç½®æ–‡ä»¶æ‰“å¼€æ•°é‡ä¸º1024</div><div class="line">ulimit -S -n 1024</div></pre></td></tr></table></figure><h3 id="ç¼–è¯‘è¦æ±‚"><a href="#ç¼–è¯‘è¦æ±‚" class="headerlink" title="ç¼–è¯‘è¦æ±‚"></a>ç¼–è¯‘è¦æ±‚</h3><p>ä¸‹è½½å’Œç¼–è¯‘ Android æºä»£ç ä¹‹å‰ï¼Œè¯·å…ˆç¡®ä¿æ‚¨çš„ç³»ç»Ÿç¬¦åˆå®˜æ–¹è¦æ±‚ã€‚è¯·å‚é˜…<a href="https://source.android.com/source/requirements" target="_blank" rel="external">requirements</a></p><h3 id="ç¼–è¯‘æ­¥éª¤"><a href="#ç¼–è¯‘æ­¥éª¤" class="headerlink" title="ç¼–è¯‘æ­¥éª¤"></a>ç¼–è¯‘æ­¥éª¤</h3><p>å¼€å§‹ç¼–è¯‘Android æºç ï¼Œè¯·å‚é˜…<a href="https://source.android.com/setup/building" target="_blank" rel="external">Preparing to Build</a> ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œå…¶æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>æ‰§è¡Œ <code>source build/envsetup.sh</code> or <code>. build/envsetup.sh</code> ï¼Œå°†åˆå§‹åŒ–Android çš„ç¼–è¯‘ç¯å¢ƒï¼Œå¹¶å£°æ˜äº†ä¸€ç³»åˆ—æ–¹ä¾¿æ“ä½œæºä»£ç çš„bashå‡½æ•°ï¼Œå¦‚ mmmã€mmã€cgrepã€jgrep ç­‰ã€‚</li><li>æ‰§è¡Œ <code>lunch + buildType</code>  è®¾ç½®å³å°†ç¼–è¯‘çš„é¡¹ç›®åŠç±»å‹ or <code>lunch</code> å†é€‰æ‹©ç¼–è¯‘çš„é¡¹ç›®åŠç±»å‹ã€‚</li><li>æ‰§è¡Œ <code>make -j4</code> ï¼Œå¯åŠ¨4ä¸ªçº¿ç¨‹è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘äº§ç‰©éƒ½ä¼šå­˜å‚¨åœ¨Android æºä»£ç æ ¹ç›®å½•ä¸‹çš„out æ–‡ä»¶å¤¹ä¸­ã€‚</li></ol><h3 id="ç¼–è¯‘é”™è¯¯"><a href="#ç¼–è¯‘é”™è¯¯" class="headerlink" title="ç¼–è¯‘é”™è¯¯"></a>ç¼–è¯‘é”™è¯¯</h3><p>ç¼–è¯‘Android æºç æ€»ä¸ä¼šä¸€å¸†é£é¡ºçš„ã€‚æ ¹æ®é”™è¯¯ä¿¡æ¯æç¤ºï¼Œå°‘äº†ä»€ä¹ˆå°±å®‰è£…ä»€ä¹ˆã€‚æ¯”å¦‚ï¼š<code>/bin/bash: xmllint: æœªæ‰¾åˆ°å‘½ä»¤</code>   å°±æ‰§è¡Œ<code>brew install libxml2</code> å³å¯ï¼Œc++ å¤´æ–‡ä»¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦å¤–å¤šæŸ¥æŸ¥èµ„æ–™ã€‚</p><h2 id="åœ¨-IDE-ä¸­å¯¼å…¥-Android-æºç "><a href="#åœ¨-IDE-ä¸­å¯¼å…¥-Android-æºç " class="headerlink" title="åœ¨ IDE ä¸­å¯¼å…¥ Android æºç "></a>åœ¨ IDE ä¸­å¯¼å…¥ Android æºç </h2><p>åœ¨ <code>/development/ide</code> ä¸‹åˆ†åˆ«æœ‰eclipse/emacs/intellij è¿™3ä¸ªide çš„é…ç½®æ–‡ä»¶</p><h3 id="å°†Android-æºç å¯¼å…¥Eclipse"><a href="#å°†Android-æºç å¯¼å…¥Eclipse" class="headerlink" title="å°†Android æºç å¯¼å…¥Eclipse"></a>å°†Android æºç å¯¼å…¥Eclipse</h3><p>é¦–å…ˆ <code>\development\ide\eclipse\.classpath</code> æ–‡ä»¶å¤åˆ¶åˆ°Androidæºç æ ¹ç›®å½•ä¸‹ï¼Œå› ä¸ºæºç æ–‡ä»¶ååˆ†å¤š,å¼ºçƒˆå»ºè®®eclipseã€intellij å¢åŠ jvm å†…å­˜å¤§å°ã€‚ å¯ä¿®æ”¹<code>.classpath</code> æ–‡ä»¶æŒ‡å®š Eclipse å¯¼å…¥é‚£äº›ä»£ç ï¼Œå¯¼å…¥Androidæºç åªéœ€è¦new Java Project ï¼ˆä¸æ˜¯Android projectï¼‰é€‰æ‹©ä»å·²å­˜åœ¨çš„å·¥ç¨‹å¯¼å…¥ï¼Œå®šä½åˆ°Androidæºç çš„ç›®å½•è¿›è¡Œå¯¼å…¥å³å¯ã€‚</p><h3 id="åœ¨-Android-Studioä¸­å¯¼å…¥-Android-æºç "><a href="#åœ¨-Android-Studioä¸­å¯¼å…¥-Android-æºç " class="headerlink" title="åœ¨ Android Studioä¸­å¯¼å…¥ Android æºç "></a>åœ¨ Android Studioä¸­å¯¼å…¥ Android æºç </h3><p>åœ¨ <code>/development/ide</code> ä¸‹åˆ†åˆ«æœ‰eclipse/emacs/intellij è¿™3ä¸ªide çš„é…ç½®æ–‡ä»¶ã€‚å› ä¸ºæºç æ–‡ä»¶ååˆ†å¤š,å¼ºçƒˆå»ºè®®aså¢åŠ jvm å†…å­˜å¤§å°ã€‚</p><h4 id="ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶-ipr"><a href="#ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶-ipr" class="headerlink" title="ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶(*.ipr)"></a>ç”Ÿæˆå¯¼å…¥ASæ‰€éœ€é…ç½®æ–‡ä»¶(*.ipr)</h4><ul><li><p>ç¼–è¯‘æºç (ä¸ºäº†ç¡®ä¿ç”Ÿæˆäº†.javaæ–‡ä»¶ï¼Œå¦‚R.javaï¼›å¦‚æœç¼–è¯‘è¿‡ï¼Œåˆ™æ— éœ€å†æ¬¡ç¼–è¯‘)</p></li><li><p>æ£€æŸ¥out/host/linux-x86/framework/ç›®å½•ä¸‹æ˜¯å¦æœ‰idegen.jar</p></li></ul><p>å¦‚æœidegen.jarä¸å­˜åœ¨, æ‰§è¡Œ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mmm development/tools/idegen/</div><div class="line">development/tools/idegen/idegen.sh</div></pre></td></tr></table></figure><p>ç­‰å¾…å‡ºç°ç±»ä¼¼ä¸‹é¢çš„ç»“æœ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Read excludes: 5ms</div><div class="line">Traversed tree: 44078ms</div></pre></td></tr></table></figure><p>è¿™æ—¶ä¼šåœ¨æºç çš„æ ¹ç›®å½•ä¸‹ç”Ÿæˆandroid.iprå’Œandroid.imlä¸¤ä¸ªIntelliJ IDEA(ASæ˜¯åŸºäºIntelliJ IDEAç¤¾åŒºç‰ˆå¼€å‘çš„)çš„é…ç½®æ–‡ä»¶.</p><p>Tipsï¼šASåœ¨å¯¼å…¥ä»£ç æ—¶æ¯”è¾ƒæ…¢ï¼Œå»ºè®®å…ˆä¿®æ”¹android.imlï¼Œå°†è‡ªå·±ç”¨ä¸åˆ°çš„ä»£ç excludeå‡ºå».å¯ä»¥ä»¿ç…§è¿‡æ»¤.repoæ–‡ä»¶å¤¹çš„è¯­æ³•,å¦‚:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;excludeFolder url=&quot;file://$MODULE_DIR$/.repo&quot; /&gt;</div><div class="line">&lt;excludeFolder url=&quot;file://$MODULE_DIR$/abi&quot; /&gt;</div><div class="line">&lt;excludeFolder url=&quot;file://$MODULE_DIR$/art&quot; /&gt;</div><div class="line">...</div></pre></td></tr></table></figure><p>è¿˜å¯ä»¥é€šè¿‡as çš„module settings - dependents åˆ é™¤æ‰æ‰€æœ‰ä¸éœ€è¦çš„module-libraryé¡¹</p><p>è¿™æ ·åœ¨å¯¼å…¥æ—¶å°±ä¼šè·³è¿‡abiå’Œartæ–‡ä»¶å¤¹.è¿‡æ»¤çš„è¶Šå¤šï¼ŒASçš„å¤„ç†é€Ÿåº¦å°±ä¼šè¶Šå¿«.æœ€ååœ¨ASä¸­æ‰“å¼€æºç æ ¹ç›®å½•ä¸‹æ–°ç”Ÿæˆçš„android.ipr</p><h4 id="è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜"><a href="#è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜" class="headerlink" title="è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜"></a>è§£å†³æºç ä¸­è·³è½¬é”™è¯¯é—®é¢˜</h4><p>è¦ä¸ºå½“å‰å·¥ç¨‹è®¾ç½®æ­£ç¡®çš„SDKå’ŒJDKï¼Œéœ€è¦Android API 19 Platformï¼Œjdk åˆ™æ— æ‰€è°“ï¼Œå› ä¸ºlibcore ç›®å½•ä¸‹åŒ…æ‹¬äº†jdk çš„æºç ã€‚æ·»åŠ ä¸€ä¸ªjdk æ¥ç€æŠŠclasspath æ‰€æœ‰é¡¹remove æ‰ï¼Œæ¥ç€Android API 19 Platform é€‰æ‹©ç©ºçš„jdk.å¦‚ä¸‹å›¾<br><img src="http://img.blog.csdn.net/20180207145631611?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="æ­¥éª¤1"></p><p>ç‚¹å‡»Project<br><img src="http://img.blog.csdn.net/20180207145747921?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="æ­¥éª¤2"></p><p>ç‚¹å‡»Modules, é€‰æ‹©ç›¸åº”çš„ä»£ç æ¨¡å—ï¼Œæ¯”å¦‚frameworksã€packages ç­‰æºç ç›®å½•ï¼Œä¸”æŠŠå®ƒä»¬ç§»åŠ¨åˆ°æœ€å‰ä¼˜å…ˆä»è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾ï¼Œè€Œä¸æ˜¯åœ¨Android.jarä¸­æŸ¥æ‰¾<br><img src="http://img.blog.csdn.net/20180207145838877?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br>NOTE: Empty Library ä¸è¦ç´§çš„ã€‚</p><h4 id="DEBUGæºç "><a href="#DEBUGæºç " class="headerlink" title="DEBUGæºç "></a>DEBUGæºç </h4><p>åœ¨â€™Modulesâ€™ä¸­æ·»åŠ â€™Android Frameworkâ€™æ¥è®©ASå°†å®ƒä½œä¸ºä¸€ä¸ªAndroidå·¥ç¨‹ï¼Œä»è€Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä»£ç .<br><img src="http://img.blog.csdn.net/20180207150331651?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvQ1NETm5v/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>åœ¨ä»£ç ä¸­åŠ æ–­ç‚¹ï¼Œç„¶åé€‰æ‹©â€™Runâ€™-&gt;â€™Attach debugger to Android processâ€™æˆ–è€…ç›´æ¥ç‚¹å‡»ToolBar ä¸Šçš„Attach debuggerå›¾æ ‡ã€‚åœ¨å¼¹å‡ºçš„é€‰æ‹©è¿›ç¨‹(Choose Process)å¯¹è¯æ¡†ä¸­ï¼Œå‹¾é€‰æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œé€‰æ‹©è¦DEBUGçš„ä»£ç æ‰€åœ¨çš„è¿›ç¨‹ï¼Œç‚¹å‡»OKå³å¯.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸ºäº†å­¦ä¹ Android æºç ï¼Œåœ¨Mac ä¸‹ç¼–è¯‘Androidæºç ï¼ŒAndroid Studio ä¸‹è°ƒè¯•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Androidæºä»£ç å­¦ä¹ " scheme="http://lazy.github.io/categories/Android%E6%BA%90%E4%BB%A3%E7%A0%81%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ·±å…¥ç†è§£Android" scheme="http://lazy.github.io/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Android/"/>
    
  </entry>
  
  <entry>
    <title>Kotlin å¿«é€Ÿå…¥é—¨</title>
    <link href="http://lazy.github.io/2017/06/13/kotlin/Kotlin-quick-start/"/>
    <id>http://lazy.github.io/2017/06/13/kotlin/Kotlin-quick-start/</id>
    <published>2017-06-13T13:04:45.000Z</published>
    <updated>2018-01-15T15:08:38.284Z</updated>
    
    <content type="html"><![CDATA[<p>äººç”Ÿè‹¦å¤šï¼Œå¿«æ¥ Kotlin ï¼Œå¿«é€Ÿå­¦ä¹ Kotlinï¼</p><a id="more"></a> <h3 id="ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ</h3><p>Kotlin æ˜¯ç§é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ ç”¨äºç°ä»£å¤šå¹³å°åº”ç”¨ 100ï¼…å¯ä¸Javaâ„¢å’ŒAndroidâ„¢äº’æ“ä½œ,å®ƒæ˜¯[JetBrains]å¼€å‘çš„åŸºäºJVMçš„è¯­è¨€<br>å¼€å‘IDE : <a href="https://www.jetbrains.com/idea/" target="_blank" rel="external">Intellij</a> / <a href="https://developer.android.com/studio/preview/index.html" target="_blank" rel="external">AndroidStudio3.0 preview</a> </p><p>å‚è€ƒ: <a href="https://kotlinlang.org/" target="_blank" rel="external">Kotlin å®˜ç½‘ </a> / <a href="https://www.kotlincn.net/" target="_blank" rel="external">Kotlin è¯­è¨€ä¸­æ–‡ç«™</a></p><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Github <a href="https://github.com/iflove/KotlinDemo" target="_blank" rel="external">KotlinDemo</a></p><h2 id="æºæ–‡ä»¶ä¸åŒ…"><a href="#æºæ–‡ä»¶ä¸åŒ…" class="headerlink" title="æºæ–‡ä»¶ä¸åŒ…"></a>æºæ–‡ä»¶ä¸åŒ…</h2><h3 id="åŒ…"><a href="#åŒ…" class="headerlink" title="åŒ…"></a>åŒ…</h3><p>Kotlin æºæ–‡ä»¶ä»¥ <strong>kt</strong> ç»“å°¾. æºæ–‡ä»¶æ‰€æœ‰å†…å®¹ï¼ˆæ— è®ºæ˜¯ç±»è¿˜æ˜¯å‡½æ•°ï¼‰éƒ½åŒ…å«åœ¨å£°æ˜çš„åŒ…å†….<br>NOTE: æºæ–‡ä»¶é€šå¸¸ä»¥åŒ…å£°æ˜å¼€å¤´, æ²¡æœ‰æŒ‡æ˜åŒ…ï¼Œåˆ™è¯¥æ–‡ä»¶çš„å†…å®¹å±äºæ— åå­—çš„é»˜è®¤åŒ…ï¼ˆå±äº<strong>root package</strong>ï¼‰ã€‚<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> demo</div></pre></td></tr></table></figure></p><p>NOTEï¼š è‹¥å£°æ˜çš„åŒ…è·¯å¾„ä¸æ–‡ä»¶è·¯å¾„ä¸ä¸€è‡´ï¼Œäº¦å¯ä»¥æ­£å¸¸ç¼–è¯‘. ä¸è¿‡ä¼šæœ‰å¦‚Java ä¸€æ ·çš„è­¦å‘Š Package directive doesnâ€™t match file location</p><h3 id="é»˜è®¤å¯¼å…¥"><a href="#é»˜è®¤å¯¼å…¥" class="headerlink" title="é»˜è®¤å¯¼å…¥"></a>é»˜è®¤å¯¼å…¥</h3><p>Kotlin å¦‚åŒJava ä¸€æ · é»˜è®¤æºæ–‡ä»¶ä¼šå¯¼å…¥ä»¥ä¸‹åŒ…:<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">kotlin.*</div><div class="line">kotlin.<span class="keyword">annotation</span>.*</div><div class="line">kotlin.collections.*</div><div class="line">kotlin.comparisons.* ï¼ˆè‡ª <span class="number">1.1</span> èµ·ï¼‰</div><div class="line">kotlin.io.*</div><div class="line">kotlin.ranges.*</div><div class="line">kotlin.sequences.*</div><div class="line">kotlin.text.*</div><div class="line"><span class="comment">//æ ¹æ®ç›®æ ‡å¹³å°è¿˜ä¼šå¯¼å…¥é¢å¤–çš„åŒ…ï¼š</span></div><div class="line">JVM:</div><div class="line">java.lang.*</div><div class="line">kotlin.jvm.*</div><div class="line">JS:</div><div class="line">kotlin.js.*</div></pre></td></tr></table></figure></p><h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><p><a href="https://www.kotlincn.net/docs/reference/grammar.html#import" target="_blank" rel="external">å¯¼å…¥è¯­æ³•</a><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> (used <span class="keyword">by</span> preamble)</div><div class="line">  : <span class="string">"import"</span> SimpleName&#123;<span class="string">"."</span>&#125; (<span class="string">"."</span> <span class="string">"*"</span> | <span class="string">"as"</span> SimpleName)? SEMI?</div><div class="line">  ;`</div></pre></td></tr></table></figure></p><p>Java vs Kotlin<br>1.å¦‚æœå‡ºç°åå­—å†²çªï¼ŒKotlin å¯ä»¥ä½¿ç”¨ as å…³é”®å­—åœ¨æœ¬åœ°é‡å‘½åå†²çªé¡¹æ¥æ¶ˆæ­§ä¹‰<br>2.Kotlin çš„å…³é”®å­— import ä¸ä»…ä»…é™äºå¯¼å…¥ç±»ï¼Œè¿˜å¯ä»¥å¯¼å…¥é¡¶å±‚å‡½æ•°åŠå±æ€§ï¼Œåœ¨å¯¹è±¡å£°æ˜ä¸­å£°æ˜çš„å‡½æ•°å’Œå±æ€§ï¼Œæšä¸¾å¸¸é‡ç­‰.</p><p>NOTEï¼š ä¸ Java ä¸åŒï¼ŒKotlin æ²¡æœ‰å•ç‹¬çš„ <code>import static</code> è¯­æ³•ï¼› æ‰€æœ‰è¿™äº›å£°æ˜éƒ½ç”¨ import å…³é”®å­—å¯¼å…¥ã€‚</p><h3 id="é¡¶å±‚å£°æ˜"><a href="#é¡¶å±‚å£°æ˜" class="headerlink" title="é¡¶å±‚å£°æ˜"></a>é¡¶å±‚å£°æ˜</h3><p>1.åŒ <strong>package</strong> ä¸‹çš„Kotlin æºæ–‡ä»¶,åœ¨é¡¶å±‚æ‰€å£°æ˜çš„å¸¸é‡,å˜é‡ä»¥åŠå‡½æ•°ç­‰ä¸å…è®¸é‡å¤å®šä¹‰,å¦åˆ™æŠ¥<strong>Conflicting</strong> é”™è¯¯ã€‚</p><p>2.è‹¥å£°æ˜ç”¨ <strong>private</strong> å¯è§æ€§ä¿®é¥°ç¬¦ä¿®é¥°æ—¶,å±äºå½“å‰æ–‡ä»¶ç§æœ‰ã€‚</p><h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><h3 id="Numbers"><a href="#Numbers" class="headerlink" title="Numbers"></a>Numbers</h3><p>Kotlin ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ã€‚Kotlinæä¾›ä»¥ä¸‹ä»£è¡¨æ•°å­—ã€å­—ç¬¦çš„å†…ç½®ç±»å‹ï¼ˆè¿™å¾ˆæ¥è¿‘Javaï¼‰</p><table><thead><tr><th style="text-align:left">Type</th><th style="text-align:left">Bit width</th><th style="text-align:left">åŒ…è£…å™¨ç±»å‹</th></tr></thead><tbody><tr><td style="text-align:left">Double</td><td style="text-align:left">64</td><td style="text-align:left">Double</td></tr><tr><td style="text-align:left">Float</td><td style="text-align:left">32</td><td style="text-align:left">Float</td></tr><tr><td style="text-align:left">Long</td><td style="text-align:left">64</td><td style="text-align:left">Long</td></tr><tr><td style="text-align:left">Int</td><td style="text-align:left">32</td><td style="text-align:left">Integer</td></tr><tr><td style="text-align:left">Short</td><td style="text-align:left">16</td><td style="text-align:left">Short</td></tr><tr><td style="text-align:left">Byte</td><td style="text-align:left">8</td><td style="text-align:left">Byte</td></tr><tr><td style="text-align:left">Char</td><td style="text-align:left">16 (Unicode character)</td><td style="text-align:left">Character</td></tr></tbody></table><p>NOTE:ä»… <strong>Char</strong>  ä¸æ˜¯Kotlinçš„æ•°å­—ã€‚å¦‚ä¸‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> c:<span class="built_in">Char</span>=<span class="string">'c'</span></div><div class="line"><span class="keyword">val</span> i: <span class="built_in">Int</span> = c.toInt()</div><div class="line">println(c) <span class="comment">// 'c'</span></div><div class="line">println(i) <span class="comment">// 99</span></div></pre></td></tr></table></figure><h4 id="å­—é¢å¸¸é‡"><a href="#å­—é¢å¸¸é‡" class="headerlink" title="å­—é¢å¸¸é‡"></a>å­—é¢å¸¸é‡</h4><p>Kotlin å”¯ç‹¬ä¸æ”¯æŒå…«è¿›åˆ¶</p><ul><li>åè¿›åˆ¶: <code>123</code></li><li>äºŒè¿›åˆ¶: <code>0b00001011</code></li><li>åå…­è¿›åˆ¶: <code>0x0F</code></li></ul><p>Kotlin æ•°å€¼è¡¨ç¤ºæ–¹æ³•</p><ul><li>é»˜è®¤ Doubleï¼š<code>123.5</code>ã€<code>123.5e10</code></li><li>Float ç”¨ <code>f</code> æˆ–è€… <code>F</code> æ ‡è®°: <code>123.5f</code></li><li>Long ç”¨å¤§å†™ <code>L</code> æ ‡è®°: <code>123L</code></li></ul><p>NOTEï¼šæ”¯æŒæ•°å­—å­—é¢å€¼ä¸­çš„ä¸‹åˆ’çº¿ï¼ˆè‡ª kotlin1.1 èµ·ï¼‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> oneMillion = <span class="number">1</span>_000_000</div></pre></td></tr></table></figure><h4 id="Kotlin-è£…ç®±æœºåˆ¶"><a href="#Kotlin-è£…ç®±æœºåˆ¶" class="headerlink" title="Kotlin è£…ç®±æœºåˆ¶"></a>Kotlin è£…ç®±æœºåˆ¶</h4><p>Kotlin å†…ç½®ç±»å‹åœ¨ Java å¹³å°ä¸Šæ˜¯å­˜å‚¨ä¸º JVM çš„åŸç”Ÿç±»å‹ï¼Œä½†ä¸€ä¸ª<a href="#ç©ºå®‰å…¨">å¯ç©ºçš„å¼•ç”¨</a>ï¼ˆå¦‚ <code>Int?</code>ï¼‰æˆ–æ³›å‹æƒ…å†µä¸‹(å¦‚ <code>Array&lt;Int&gt;,List&lt;Int&gt; ...</code>) ä¼šæŠŠæ•°å­—å’Œå­—ç¬¦è‡ªåŠ¨è£…ç®±æˆç›¸åº”åŒ…è£…ç±», è¯·å‚è€ƒ <a href="#Numbers">Numbers</a>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> low = <span class="number">-127</span></div><div class="line"><span class="keyword">val</span> high = <span class="number">127</span></div><div class="line"><span class="keyword">val</span> noInIntegerCache = <span class="number">128</span></div><div class="line"><span class="keyword">var</span> boxedA: <span class="built_in">Int</span>? = low</div><div class="line"><span class="keyword">var</span> anotherBoxedA: <span class="built_in">Int</span>? = low</div><div class="line">println(boxedA == anotherBoxedA) <span class="comment">//true</span></div><div class="line">println(boxedA === anotherBoxedA) <span class="comment">//true</span></div><div class="line">boxedA = high</div><div class="line">anotherBoxedA = high</div><div class="line">println(boxedA == anotherBoxedA) <span class="comment">//true</span></div><div class="line">println(boxedA === anotherBoxedA) <span class="comment">//true</span></div><div class="line">boxedA = noInIntegerCache</div><div class="line">anotherBoxedA = noInIntegerCache</div><div class="line">println(boxedA == anotherBoxedA) <span class="comment">//true</span></div><div class="line">println(boxedA === anotherBoxedA) <span class="comment">//false</span></div></pre></td></tr></table></figure><p><code>==</code> å’Œ <code>===</code> è¯·å‚è€ƒ <a href="#ç±»å‹ç›¸ç­‰æ€§">ç±»å‹ç›¸ç­‰æ€§</a> ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> anIntegerA: <span class="built_in">Int</span>? = <span class="number">123</span> <span class="comment">//å¯¹åº” java.lang.Integer ä¸€ä¸ªè£…ç®±çš„ Int</span></div><div class="line"><span class="keyword">val</span> anIntegerB: <span class="built_in">Int</span>? = <span class="number">123</span> <span class="comment">//å¯¹åº” java.lang.Integer</span></div><div class="line">println(anIntegerA === anIntegerB) <span class="comment">//true</span></div><div class="line">println(anIntegerA?.javaClass) <span class="comment">//int</span></div><div class="line">println((anIntegerA <span class="keyword">as</span> Number).javaClass) <span class="comment">//java.lang.Integer</span></div><div class="line"><span class="keyword">val</span> anIntegerArray: Array&lt;<span class="built_in">Int</span>&gt; = arrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line"><span class="keyword">val</span> anIntegerList: List&lt;<span class="built_in">Int</span>&gt; = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">println(anIntegerArray.toString())</div><div class="line">println(anIntegerList.toString())</div><div class="line">println((anIntegerList[<span class="number">0</span>] <span class="keyword">as</span> Number).javaClass) <span class="comment">//</span></div></pre></td></tr></table></figure><p>NOTEï¼šä¸€ä¸ª<a href="#ç©ºå®‰å…¨">å¯ç©ºçš„å¼•ç”¨</a>ï¼ˆå¦‚ <code>Int?</code>ï¼‰èƒ½ä¸èƒ½è£…æ¢æˆ <code>Int</code> ,ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚å¼ºåˆ¶è½¬æ¢æˆ–è€… <code>!!</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> anIntegerA: <span class="built_in">Int</span>? = <span class="number">123</span> </div><div class="line"><span class="keyword">val</span> anNewIntA: <span class="built_in">Int</span> = anIntegerA  <span class="comment">//ç¼–è¯‘é”™è¯¯</span></div><div class="line"><span class="keyword">val</span> anNewIntB: <span class="built_in">Int</span> = anIntegerA!!  <span class="comment">//æˆ–è€… anIntegerA as Int</span></div><div class="line"><span class="keyword">val</span> anNewIntC: <span class="built_in">Int</span> = anIntegerA <span class="comment">//Start cast to kotlin.Int</span></div></pre></td></tr></table></figure><h4 id="æ˜¾å¼è½¬æ¢"><a href="#æ˜¾å¼è½¬æ¢" class="headerlink" title="æ˜¾å¼è½¬æ¢"></a>æ˜¾å¼è½¬æ¢</h4><p>æ¯ä¸ªæ•°å­—ç±»å‹æ”¯æŒå¦‚ä¸‹çš„è½¬æ¢:</p><ul><li><code>toByte(): Byte</code></li><li><code>toShort(): Short</code></li><li><code>toInt(): Int</code></li><li><code>toLong(): Long</code></li><li><code>toFloat(): Float</code></li><li><code>toDouble(): Double</code></li><li><code>toChar(): Char</code></li></ul><p>å¦‚ä¸‹ç¤ºä¾‹ Java ä¸­,åŒ…è£…ç±»ä¸èƒ½éšå¼è½¬æ¢, Kotlin ä¹Ÿæ˜¯å¦‚æ­¤, ä¸åŒç±»å‹ä¹‹é—´æ˜¯<strong>ä¸èƒ½</strong>ç›¸äº’éšå¼è½¬æ¢çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Byte a  = <span class="number">1</span>;</div><div class="line">Integer b = a;<span class="comment">//error</span></div></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> b: <span class="built_in">Byte</span> = <span class="number">1</span> <span class="comment">// OK, å­—é¢å€¼æ˜¯é™æ€æ£€æµ‹çš„</span></div><div class="line"><span class="keyword">val</span> i: <span class="built_in">Int</span> = b <span class="comment">// é”™è¯¯</span></div></pre></td></tr></table></figure><h4 id="è¿ç®—"><a href="#è¿ç®—" class="headerlink" title="è¿ç®—"></a>è¿ç®—</h4><p>Kotlinæ”¯æŒæ•°å­—è¿ç®—çš„æ ‡å‡†é›†ï¼Œè¿ç®—è¢«å®šä¹‰ä¸ºç›¸åº”çš„ç±»æˆå‘˜ï¼ˆä½†ç¼–è¯‘å™¨ä¼šå°†å‡½æ•°è°ƒç”¨ä¼˜åŒ–ä¸ºç›¸åº”çš„æŒ‡ä»¤ï¼‰ã€‚ å‚è§<a href="#æ“ä½œç¬¦é‡è½½">æ“ä½œç¬¦é‡è½½</a>ã€‚</p><p>å¯¹äºä½è¿ç®—ï¼Œæ²¡æœ‰ç‰¹æ®Šå­—ç¬¦æ¥è¡¨ç¤ºï¼Œè€Œåªå¯ç”¨ä¸­ç¼€æ–¹å¼è°ƒç”¨å‘½åå‡½æ•°ï¼Œä¾‹å¦‚:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> x = (<span class="number">1</span> shl <span class="number">2</span>) and <span class="number">0x000FF000</span></div></pre></td></tr></table></figure><p>è¿™æ˜¯å®Œæ•´çš„ä½è¿ç®—åˆ—è¡¨ï¼ˆåªç”¨äº <code>Int</code> å’Œ <code>Long</code>ï¼‰ï¼š</p><ul><li>shl(bits) â€“ æœ‰ç¬¦å·å·¦ç§» (Java çš„ &lt;&lt;)</li><li>shr(bits) â€“ æœ‰ç¬¦å·å³ç§» (Java çš„ &gt;&gt;)</li><li>ushr(bits) â€“ æ— ç¬¦å·å³ç§» (Java çš„ &gt;&gt;&gt;)</li><li>and(bits) â€“ ä½ä¸</li><li>or(bits) â€“ ä½æˆ–</li><li>xor(bits) â€“ ä½å¼‚æˆ–</li><li>inv() â€“ ä½é</li></ul><h3 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h3><p>å­—ç¬¦ä¸²ç”¨ <code>String</code> ç±»å‹è¡¨ç¤ºã€‚å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ã€‚ å­—ç¬¦ä¸²çš„å…ƒç´ â€”â€”å­—ç¬¦å¯ä»¥ä½¿ç”¨ç´¢å¼•è¿ç®—ç¬¦è®¿é—®: <code>s[i]</code>ã€‚ å¯ä»¥ç”¨ <em>for</em> å¾ªç¯è¿­ä»£å­—ç¬¦ä¸²:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> s = <span class="string">"Hello, world!\n"</span> <span class="comment">//å­—ç¬¦ä¸²å­—é¢å€¼</span></div><div class="line"><span class="comment">//å­—ç¬¦ä¸²</span></div><div class="line"><span class="keyword">for</span> (c <span class="keyword">in</span> s) &#123;</div><div class="line">    print(c)</div><div class="line">&#125;</div><div class="line"><span class="comment">//åŸç”Ÿå­—ç¬¦ä¸² ä½¿ç”¨ä¸‰ä¸ªå¼•å·ï¼ˆ"""ï¼‰åˆ†ç•Œç¬¦æ‹¬èµ·æ¥</span></div><div class="line"><span class="keyword">val</span> text = <span class="string">"""</span></div><div class="line">for (c in s) &#123;</div><div class="line">    print(c)</div><div class="line">&#125;</div><div class="line">"""</div><div class="line">println(text)</div><div class="line"><span class="comment">//å­—ç¬¦ä¸²æ¨¡æ¿</span></div><div class="line"><span class="keyword">val</span> str = <span class="string">"<span class="subst">$s</span>.length is <span class="subst">$&#123;s.length&#125;</span>"</span></div><div class="line">println(str)</div></pre></td></tr></table></figure><p>NOTE: æ¨¡æ¿è¡¨è¾¾å¼ä»¥ç¾å…ƒç¬¦ï¼ˆ<code>$</code>ï¼‰å¼€å¤´,è‹¥è¦å¯¹è±¡å±æ€§æ—¶è¦èŠ±æ‹¬å·æ‹¬èµ·æ¥ï¼Œè‹¥è¦è¡¨ç¤ºå­—é¢å€¼ <code>$</code> å­—ç¬¦zåˆ™:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> price = <span class="string">"<span class="subst">$&#123;<span class="string">'$'</span>&#125;</span>9.99"</span></div><div class="line">println(price)</div></pre></td></tr></table></figure><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>æ•°ç»„åœ¨ Kotlin ä¸­ä½¿ç”¨ <code>Array</code> ç±»æ¥è¡¨ç¤ºï¼Œå®ƒå®šä¹‰äº† <code>get</code> å’Œ <code>set</code> å‡½æ•°ï¼ˆæŒ‰ç…§è¿ç®—ç¬¦é‡è½½çº¦å®šè¿™ä¼šè½¬å˜ä¸º <code>[]</code>ï¼‰å’Œ <code>size</code> å±æ€§ï¼Œä»¥åŠä¸€äº›å…¶ä»–æœ‰ç”¨çš„æˆå‘˜å‡½æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Array</span>&lt;<span class="type">T</span>&gt; <span class="keyword">private</span> <span class="keyword">constructor</span></span>() &#123;</div><div class="line">    <span class="keyword">val</span> size: <span class="built_in">Int</span></div><div class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(index: <span class="type">Int</span>)</span></span>: T</div><div class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">set</span><span class="params">(index: <span class="type">Int</span>, value: <span class="type">T</span>)</span></span>: <span class="built_in">Unit</span></div><div class="line"></div><div class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">iterator</span><span class="params">()</span></span>: Iterator&lt;T&gt;</div><div class="line">    <span class="comment">// â€¦â€¦</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>Library.kt</code> ä¸­ <code>arrayOf()</code> <code>arrayOfNulls</code> å‡½æ•°ä»¥åŠ<code>Array</code>æ„é€ å‡½æ•°èƒ½åˆ›å»ºæ•°æ•°ç»„ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> args: Array&lt;<span class="built_in">Int</span>&gt; = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="keyword">val</span> arrayOfNulls = arrayOfNulls&lt;<span class="built_in">Int</span>&gt;(<span class="number">10</span>) <span class="comment">//ç©ºæ•°ç»„</span></div><div class="line"><span class="keyword">val</span> initArray = Array(<span class="number">5</span>, &#123; i -&gt; (i * i).toString() &#125;) <span class="comment">//æ„é€ å‡½æ•°init</span></div><div class="line">println(arrayOfNulls.size)</div></pre></td></tr></table></figure><p>NOTE: ä¸ Java ä¸åŒçš„æ˜¯ï¼ŒKotlin ä¸­æ•°ç»„æ˜¯ä¸å‹å˜çš„ï¼ˆinvariantï¼‰ã€‚è¿™æ„å‘³ç€ Kotlin ä¸è®©æˆ‘ä»¬æŠŠ <code>Array&lt;String&gt;</code>èµ‹å€¼ç»™ <code>Array&lt;Any&gt;</code>ï¼Œä»¥é˜²æ­¢å¯èƒ½çš„è¿è¡Œæ—¶å¤±è´¥ï¼ˆä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨ <code>Array&lt;out Any&gt;</code>, å‚è§<a href="#ç±»å‹æŠ•å½±">ç±»å‹æŠ•å½±</a>ï¼‰ã€‚</p><p>ä¹‹å‰æ‰€è¯´çš„åœ¨æ³›å‹æƒ…å†µä¸‹Kotlin ä¼šæŠŠæ•°å­—å’Œå­—ç¬¦è‡ªåŠ¨è£…ç®±æˆç›¸åº”åŒ…è£…ç±», <code>Arrays.kt</code> ä¸­æœ‰ä»¥ä¸‹</p><p><code>ByteArray</code><br><code>CharArray</code><br><code>ShortArray</code><br><code>IntArray</code><br><code>LongArray</code><br><code>FloatArray</code><br><code>DoubleArray</code><br><code>BooleanArray</code></p><p>æ— è£…ç®±å¼€é”€çš„ä¸“é—¨çš„ç±»æ¥è¡¨ç¤ºåŸç”Ÿç±»å‹æ•°ç»„, å’Œ <code>Array</code> å¹¶æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œä½†æ˜¯å®ƒä»¬æœ‰åŒæ ·çš„æ–¹æ³•å±æ€§é›†ã€‚å®ƒä»¬ä¹Ÿéƒ½æœ‰ç›¸åº”çš„å·¥å‚æ–¹æ³•ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> x: IntArray = intArrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">x[<span class="number">0</span>] = x[<span class="number">1</span>] + x[<span class="number">2</span>]</div></pre></td></tr></table></figure><p>æ•°ç»„è¿­ä»£é€šè¿‡ <code>iterator()</code> å‡½æ•°è¿”å› <code>Iterator&lt;T&gt;</code> å¯¹è±¡è¿›è¡Œè¿­ä»£ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> iterator = args.iterator()</div><div class="line"><span class="keyword">while</span> (iterator.hasNext()) &#123;</div><div class="line">    print(<span class="string">""</span> + iterator.next())</div><div class="line">&#125;</div><div class="line">println()</div><div class="line"><span class="comment">//forEach</span></div><div class="line">args.iterator().forEach &#123; print(it) &#125;</div><div class="line">println()</div><div class="line"><span class="comment">//for-</span></div><div class="line"><span class="keyword">for</span> (it <span class="keyword">in</span> initArray<span class="comment">/*.iterator()*/</span>) &#123;</div><div class="line">    print(it)</div><div class="line">&#125;</div><div class="line">println()</div><div class="line"><span class="comment">//ä¸‹æ ‡ç´¢å¼•</span></div><div class="line">args.forEachIndexed &#123; index, i -&gt; println(<span class="string">"<span class="subst">$index</span> = <span class="subst">$i</span>"</span>) &#125;</div></pre></td></tr></table></figure><p>NOTE: <code>forEach</code> <code>forEachIndexed</code>  è¿™äº›æ˜¯<strong>Array</strong> çš„æ‰©å±•å‡½æ•°, èƒŒåå®ç°ä¹Ÿæ˜¯ <a href="#For å¾ªç¯">for å¾ªç¯ </a></p><h3 id="åŒºé—´"><a href="#åŒºé—´" class="headerlink" title="åŒºé—´"></a>åŒºé—´</h3><p>åŒºé—´è¡¨è¾¾å¼ç”±å…·æœ‰æ“ä½œç¬¦å½¢å¼ <code>..</code> çš„ <code>rangeTo</code> å’Œ <code>downTo</code> å‡½æ•°è¾…ä»¥ <code>in</code> å’Œ <code>!in</code> å½¢æˆã€‚ åŒºé—´æ˜¯ä¸ºä»»ä½•å¯æ¯”è¾ƒç±»å‹ï¼ˆ<code>Comparable&lt;in T&gt;</code>ï¼‰å®šä¹‰çš„ï¼Œä½†å¯¹äºæ•´å‹åŸç”Ÿç±»å‹ï¼ˆInt ,Long,Charï¼‰ï¼Œ<code>Ranges.kt</code> ä¸­å®ç°äº†å¸¸ç”¨çš„æ•´å‹åŒºé—´ï¼ˆ<code>IntRange</code>ã€ <code>LongRange</code>ã€ <code>CharRange</code>ï¼‰,è€Œåœ¨ <code>Primitives.kt</code>ä¸­çš„ <code>Int ,Long,Char</code> ç±»å®ç°äº†<code>rangeTo</code> å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨åŒºé—´çš„ä¸€äº›ç¤ºä¾‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">println((<span class="number">1.</span>rangeTo(<span class="number">3</span>)).contains(<span class="number">1</span>)) <span class="comment">//ä½¿ç”¨åŒºé—´rangeToå‡½æ•°</span></div><div class="line">println(<span class="number">1</span> <span class="keyword">in</span> (<span class="number">1.</span><span class="number">.3</span>)) <span class="comment">//ä½¿ç”¨åŒºé—´æ“ä½œç¬¦</span></div></pre></td></tr></table></figure><p> <code>..</code>  åˆ›å»ºä¸€ä¸ªåŒºé—´, å®é™…æ˜¯è°ƒç”¨  <code>rangeTo</code> å‡½æ•°è¿”å›åŸç”Ÿç±»å‹ <code>*Range</code> å¯¹è±¡, <code>in</code> åˆ™è°ƒç”¨ <code>contains</code>å‡½æ•°ã€‚<code>in *Range</code>  è¿˜å¯ä»¥ç”¨åœ¨è¿­ä»£(<strong>for</strong>-å¾ªç¯)ä¸­ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">1.</span><span class="number">.4</span>) print(index)</div></pre></td></tr></table></figure><p>NOTEï¼š<code>rangeTo</code>  åˆ›å»ºçš„åŒºé—´, èŒƒå›´å€¼æ˜¯å°åˆ°å¤§, <code>downTo</code> åä¹‹ã€‚ä»–ä»¬é»˜è®¤ step åˆ†åˆ«ä¸º1ï¼Œ-1</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//    val intRange = 1..4 //step 1 default</span></div><div class="line">    <span class="keyword">val</span> intRange = <span class="number">1.</span><span class="number">.4</span> step <span class="number">2</span> <span class="comment">//step 2</span></div><div class="line">    <span class="keyword">val</span> is2 = <span class="number">2</span> <span class="keyword">in</span> intRange</div><div class="line">    <span class="keyword">val</span> is4 = <span class="number">4</span> <span class="keyword">in</span> intRange</div><div class="line">    println(<span class="string">"first = <span class="subst">$&#123;intRange.first&#125;</span>,last = <span class="subst">$&#123;intRange.last&#125;</span>,step = <span class="subst">$&#123;intRange.step&#125;</span>"</span>)</div><div class="line">    println(is2)</div><div class="line">    println(is4)</div><div class="line">    println(is2 or is4)</div><div class="line"></div><div class="line"><span class="comment">//    for (index in 1..4) print(index)</span></div><div class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> intRange) print(index)</div><div class="line">    println()</div><div class="line"><span class="keyword">for</span> (index <span class="keyword">in</span> intRange.reversed()) print(index)</div><div class="line">println()</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">10.</span><span class="number">.1</span>) print(index) <span class="comment">//Nothing</span></div><div class="line">    println()</div><div class="line">    <span class="keyword">val</span> intProgression = <span class="number">10</span> downTo <span class="number">1</span> <span class="comment">/*step 2*/</span> <span class="comment">//stepé»˜è®¤ä¸º1  å€’åºè¿­ä»£</span></div><div class="line">    println(<span class="string">"first = <span class="subst">$&#123;intProgression.first&#125;</span>,last = <span class="subst">$&#123;intProgression.last&#125;</span>,step = <span class="subst">$&#123;intProgression.step&#125;</span>"</span>)</div><div class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> intProgression) print(index)</div><div class="line">    println()</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">1.</span><span class="number">.4</span>) print(index) <span class="comment">// è¾“å‡ºâ€œ1234â€</span></div><div class="line"></div><div class="line">    <span class="keyword">val</span> isIn = <span class="number">3</span> <span class="keyword">in</span> <span class="number">1.</span>rangeTo(<span class="number">100</span>)</div><div class="line">    println(isIn)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="string">'a'</span>..<span class="string">'z'</span>) print(i)</div></pre></td></tr></table></figure><h4 id="èƒŒåå®ç°åŸç†"><a href="#èƒŒåå®ç°åŸç†" class="headerlink" title="èƒŒåå®ç°åŸç†"></a>èƒŒåå®ç°åŸç†</h4><p>åŒºé—´å®ç°äº†è¯¥åº“ä¸­çš„ä¸€ä¸ªå…¬å…±æ¥å£ï¼š<code>ClosedRange&lt;T&gt;</code>ã€‚</p><p><code>ClosedRange&lt;T&gt;</code> åœ¨æ•°å­¦æ„ä¹‰ä¸Šè¡¨ç¤ºä¸€ä¸ªé—­åŒºé—´ï¼Œå®ƒæ˜¯ä¸ºå¯æ¯”è¾ƒç±»å‹å®šä¹‰çš„ã€‚ å®ƒæœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼š<code>start</code> å’Œ <code>endInclusive</code> ä»–ä»¬éƒ½åŒ…å«åœ¨åŒºé—´å†…ã€‚ å…¶ä¸»è¦æ“ä½œæ˜¯ <code>contains</code>ï¼Œé€šå¸¸ä»¥ <em>in</em>/<em>!in</em> æ“ä½œç¬¦å½¢å¼ä½¿ç”¨ã€‚</p><p>æ•´å‹æ•°åˆ—ï¼ˆ<code>IntProgression</code>ã€ <code>LongProgression</code>ã€ <code>CharProgression</code>ï¼‰è¡¨ç¤ºç­‰å·®æ•°åˆ—ã€‚ æ•°åˆ—ç”± <code>first</code> å…ƒç´ ã€<code>last</code> å…ƒç´ å’Œéé›¶çš„ <code>step</code> å®šä¹‰ã€‚ ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ <code>first</code>ï¼Œåç»­å…ƒç´ æ˜¯å‰ä¸€ä¸ªå…ƒç´ åŠ ä¸Š <code>step</code>ã€‚ <code>last</code> å…ƒç´ æ€»ä¼šè¢«è¿­ä»£å‘½ä¸­ï¼Œé™¤éè¯¥æ•°åˆ—æ˜¯ç©ºçš„ã€‚</p><p>æ•°åˆ—æ˜¯ <code>Iterable&lt;N&gt;</code> çš„å­ç±»å‹ï¼Œå…¶ä¸­ <code>N</code> åˆ†åˆ«ä¸º <code>Int</code>ã€ <code>Long</code> æˆ–è€… <code>Char</code>ï¼Œæ‰€ä»¥å®ƒå¯ç”¨äº <em>for</em>-å¾ªç¯ä»¥åŠåƒ <code>map</code>ã€<code>filter</code> ç­‰å‡½æ•°ä¸­ã€‚ å¯¹ <code>Progression</code> è¿­ä»£ç›¸å½“äº Java/JavaScript çš„åŸºäºç´¢å¼•çš„ <em>for</em>-å¾ªç¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for (int i = first; i != last; i += step) &#123;</div><div class="line">  // â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯¹äºæ•´å‹ç±»å‹ï¼Œ<code>..</code> æ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªåŒæ—¶å®ç° <code>ClosedRange&lt;T&gt;</code> å’Œ <code>*Progression</code> çš„å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼Œ<code>IntRange</code> å®ç°äº† <code>ClosedRange&lt;Int&gt;</code> å¹¶æ‰©å±•è‡ª <code>IntProgression</code>ï¼Œå› æ­¤ä¸º <code>IntProgression</code> å®šä¹‰çš„æ‰€æœ‰æ“ä½œä¹Ÿå¯ç”¨äº <code>IntRange</code>ã€‚ <code>downTo()</code> å’Œ <code>step()</code> å‡½æ•°çš„ç»“æœæ€»æ˜¯ä¸€ä¸ª <code>*Progression</code>ã€‚</p><p>æ•°åˆ—ç”±åœ¨å…¶ä¼´ç”Ÿå¯¹è±¡ä¸­å®šä¹‰çš„ <code>fromClosedRange</code> å‡½æ•°æ„é€ ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">IntProgression.fromClosedRange(start, end, step)</div></pre></td></tr></table></figure><p>æ•°åˆ—çš„ <code>last</code> å…ƒç´ è¿™æ ·è®¡ç®—ï¼šå¯¹äºæ­£çš„ <code>step</code> æ‰¾åˆ°ä¸å¤§äº <code>end</code> å€¼çš„æœ€å¤§å€¼ã€æˆ–è€…å¯¹äºè´Ÿçš„ <code>step</code> æ‰¾åˆ°ä¸å°äº <code>end</code> å€¼çš„æœ€å°å€¼ï¼Œä½¿å¾— <code>(last - first) % increment == 0</code>ã€‚</p><h4 id="ä¸€äº›å®ç”¨å‡½æ•°"><a href="#ä¸€äº›å®ç”¨å‡½æ•°" class="headerlink" title="ä¸€äº›å®ç”¨å‡½æ•°"></a>ä¸€äº›å®ç”¨å‡½æ•°</h4><ul><li>rangeTo()</li><li>downTo()</li><li>reversed()</li><li>step()</li></ul><h2 id="ç¨‹åºç»“æ„"><a href="#ç¨‹åºç»“æ„" class="headerlink" title="ç¨‹åºç»“æ„"></a>ç¨‹åºç»“æ„</h2><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>åˆ†åˆ«ä½¿ç”¨ <strong>var</strong>  ,<strong>val</strong>  å£°æ˜å¯å˜å’Œä¸å¯å˜çš„å˜é‡.ä¾‹å­å¦‚ä¸‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> s = <span class="string">"Example"</span> <span class="comment">// A Immutable String</span></div><div class="line"><span class="keyword">var</span> v = <span class="string">"Example"</span> <span class="comment">// A Mutable String</span></div></pre></td></tr></table></figure><p>å£°æ˜å¯å˜å˜é‡è¯­æ³•</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &lt;propertyName&gt;[: &lt;PropertyType&gt;] [= &lt;property_initializer&gt;]</div></pre></td></tr></table></figure><p>å£°æ˜ä¸å¯å˜å˜é‡ï¼ˆä»…èµ‹å€¼ä¸€æ¬¡åªè¯»å˜é‡ï¼‰è¯­æ³•</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &lt;propertyName&gt;[: &lt;PropertyType&gt;] = &lt;property_initializer&gt;</div></pre></td></tr></table></figure><p>é»˜è®¤ Kotlin å˜é‡ç±»å‹æ˜¯èƒ½é€šè¿‡èµ‹å€¼æ—¶æ™ºèƒ½æ¨æ–­è¯¥å˜é‡çš„ç±»å‹,ä¸”è¯¥<code>var</code>å˜é‡åªèƒ½è¯¥ç±»å‹çš„çš„å€¼ã€‚æ˜¾å¼ç¡®å®šå˜é‡ç±»å‹,å¿…é¡»è¦æ¥æ”¶è¯¥ç±»å‹çš„åˆå§‹åŒ–ã€‚é€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­è¯´æ˜</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> aImmutableIntVariable = <span class="number">0x001</span> <span class="comment">//aImmutableIntVariable ç±»å‹ä¸º Int</span></div><div class="line"><span class="keyword">var</span> aMutableIntVariable: <span class="built_in">Int</span> = <span class="string">"0x002"</span> <span class="comment">//è¯­æ³•error</span></div><div class="line"><span class="keyword">var</span> bMutableIntVariable: <span class="built_in">Int</span> = <span class="number">0x002</span></div><div class="line"><span class="keyword">var</span> cMutableVariable: Any <span class="comment">//æ˜¾å¼ç¡®å®šå˜é‡ç±»å‹,å¿…é¡»è¦æ¥æ”¶è¯¥ç±»å‹çš„åˆå§‹åŒ–ã€‚</span></div><div class="line"></div><div class="line">aImmutableIntVariable = <span class="number">1</span> <span class="comment">//ä¸èƒ½é‡æ–°åˆ†é… Val cannot be reassigned</span></div><div class="line">bMutableIntVariable = <span class="string">""</span><span class="comment">//ä¸€æ—¦ç±»å‹ç¡®å®š,åªèƒ½æ¥å—è¯¥ç±»å‹çš„å€¼</span></div></pre></td></tr></table></figure><p>NOTE: <code>var</code> å˜é‡ç›´æ¥èµ‹å€¼ä¸º <code>null</code> ,è¯¥å˜é‡åˆ™ä¸ç¬¦åˆé¢„æœŸçš„ç±»å‹ ç®€å•æ¥è¯´ï¼ˆNothingï¼‰,å†æ¬¡èµ‹å€¼æ—¶æŠ¥é”™ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> aNullable = <span class="literal">null</span></div><div class="line">aNullable = <span class="number">1</span>;<span class="comment">//Nothing</span></div></pre></td></tr></table></figure><p>æ›´è¯¦ç»†çš„ç±»å‹ä»‹ç»ï¼š<a href="#ç±»å‹å®‰å…¨å’Œæ™ºèƒ½è½¬æ¢">ç±»å‹å®‰å…¨å’Œæ™ºèƒ½è½¬æ¢</a></p><h3 id="å¸¸é‡-ï¼ˆç¼–è¯‘æœŸï¼‰"><a href="#å¸¸é‡-ï¼ˆç¼–è¯‘æœŸï¼‰" class="headerlink" title="å¸¸é‡ ï¼ˆç¼–è¯‘æœŸï¼‰"></a>å¸¸é‡ ï¼ˆç¼–è¯‘æœŸï¼‰</h3><p>å·²çŸ¥å€¼çš„å±æ€§å¯ä»¥ä½¿ç”¨  const ä¿®é¥°ç¬¦æ ‡è®°ä¸º ç¼–è¯‘æœŸå¸¸é‡.å¿…é¡»æ»¡è¶³ä»¥ä¸‹éœ€æ±‚</p><ol><li>ä½äºé¡¶å±‚æˆ–è€…æ˜¯ object çš„ä¸€ä¸ªæˆå‘˜</li><li>String æˆ–åŸç”Ÿç±»å‹ å€¼åˆå§‹åŒ–</li><li>æ²¡æœ‰è‡ªå®šä¹‰ getter</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">const <span class="keyword">val</span> CONST_VAL = <span class="number">1</span></div><div class="line"><span class="comment">//const val CONST_VAL_GET get() = 1 //Error: Const 'val' should not have a getter</span></div><div class="line"><span class="comment">//const val CONST_VAL_TEST :Any = 1  //error</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">testConstInFunction</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="comment">//    const val CONST_VAL = 1 //error</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">object</span> Kotlin &#123;</div><div class="line">    const <span class="keyword">val</span> CONST_VAL: String = <span class="string">"object å¸¸é‡"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="å¹•åå­—æ®µ"><a href="#å¹•åå­—æ®µ" class="headerlink" title="å¹•åå­—æ®µ"></a>å¹•åå­—æ®µ</h3><p>Kotlin ä¸­ç±»ä¸èƒ½æœ‰å­—æ®µã€‚ç„¶è€Œï¼Œå½“ä½¿ç”¨è‡ªå®šä¹‰è®¿é—®å™¨æ—¶ï¼Œæœ‰æ—¶æœ‰ä¸€ä¸ªå¹•åå­—æ®µï¼ˆbacking fieldï¼‰æœ‰æ—¶æ˜¯å¿…è¦çš„ã€‚ä¸ºæ­¤ Kotlin æä¾›ä¸€ä¸ªè‡ªåŠ¨å¹•åå­—æ®µï¼Œå®ƒå¯é€šè¿‡ä½¿ç”¨ <code>field</code> æ ‡è¯†ç¬¦è®¿é—®ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> counter = <span class="number">0</span> <span class="comment">// æ­¤åˆå§‹å™¨å€¼ç›´æ¥å†™å…¥åˆ°å¹•åå­—æ®µ</span></div><div class="line"><span class="keyword">set</span>(value) &#123;</div><div class="line">  <span class="keyword">if</span> (value &gt;= <span class="number">0</span>)</div><div class="line">  field = value</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>field</code> æ ‡è¯†ç¬¦åªèƒ½ç”¨åœ¨å±æ€§çš„è®¿é—®å™¨å†…ã€‚</p><p>å¦‚æœå±æ€§è‡³å°‘ä¸€ä¸ªè®¿é—®å™¨ä½¿ç”¨é»˜è®¤å®ç°ï¼Œæˆ–è€…è‡ªå®šä¹‰è®¿é—®å™¨é€šè¿‡ <code>field</code> å¼•ç”¨å¹•åå­—æ®µï¼Œå°†ä¼šä¸ºè¯¥å±æ€§ç”Ÿæˆä¸€ä¸ªå¹•åå­—æ®µã€‚</p><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„æƒ…å†µä¸‹ï¼Œ å°±æ²¡æœ‰å¹•åå­—æ®µï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> isEmpty: <span class="built_in">Boolean</span></div><div class="line"><span class="keyword">get</span>() = <span class="keyword">this</span>.size == <span class="number">0</span></div></pre></td></tr></table></figure><p>å¦‚æœä½ çš„éœ€æ±‚ä¸ç¬¦åˆè¿™å¥—â€œéšå¼çš„å¹•åå­—æ®µâ€æ–¹æ¡ˆï¼Œé‚£ä¹ˆæ€»å¯ä»¥ä½¿ç”¨ <strong>å¹•åå±æ€§ï¼ˆbacking propertyï¼‰</strong>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> _table: Map&lt;String, <span class="built_in">Int</span>&gt;? = <span class="literal">null</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">val</span> table: Map&lt;String, <span class="built_in">Int</span>&gt;</div><div class="line">    <span class="keyword">get</span>() &#123;</div><div class="line">        <span class="keyword">if</span> (_table == <span class="literal">null</span>) &#123;</div><div class="line">            _table = HashMap() <span class="comment">// ç±»å‹å‚æ•°å·²æ¨æ–­å‡º</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> _table ?: <span class="keyword">throw</span> AssertionError(<span class="string">"Set to null by another thread"</span>)</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>ä»å„æ–¹é¢çœ‹ï¼Œè¿™æ­£æ˜¯ä¸ Java ç›¸åŒçš„æ–¹å¼ã€‚å› ä¸ºé€šè¿‡é»˜è®¤ getter å’Œ setter è®¿é—®ç§æœ‰å±æ€§ä¼šè¢«ä¼˜åŒ–ï¼Œæ‰€ä»¥ä¸ä¼šå¼•å…¥å‡½æ•°è°ƒç”¨å¼€é”€ã€‚</p><h3 id="æ§åˆ¶æµï¼šifã€whenã€forã€while"><a href="#æ§åˆ¶æµï¼šifã€whenã€forã€while" class="headerlink" title="æ§åˆ¶æµï¼šifã€whenã€forã€while"></a>æ§åˆ¶æµï¼šifã€whenã€forã€while</h3><h4 id="if-è¯­å¥ã€if-else-è¡¨è¾¾å¼"><a href="#if-è¯­å¥ã€if-else-è¡¨è¾¾å¼" class="headerlink" title="if è¯­å¥ã€if - else è¡¨è¾¾å¼"></a>if è¯­å¥ã€if - else è¡¨è¾¾å¼</h4><p>åœ¨ Kotlin ä¸­,æ²¡æœ‰Javaä¸­ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆæ¡ä»¶ ? ç„¶å : å¦åˆ™ï¼‰, å› ä¸º<strong>if - else</strong> æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå³å®ƒä¼šè¿”å›ä¸€ä¸ªå€¼ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> num1 = <span class="number">1</span></div><div class="line"><span class="keyword">val</span> num2 = <span class="number">2</span></div><div class="line"><span class="keyword">val</span> max = <span class="keyword">if</span> (num1 &gt; num2) num1 <span class="keyword">else</span> num2</div><div class="line">println(max)</div><div class="line">println(<span class="keyword">if</span> (num1 &lt; num2) <span class="string">"if - else è¡¨è¾¾å¼"</span> <span class="keyword">else</span> num2)</div></pre></td></tr></table></figure><p>ifçš„åˆ†æ”¯å¯ä»¥æ˜¯ä»£ç å—ï¼Œæœ€åçš„è¡¨è¾¾å¼ä½œä¸ºè¯¥å—çš„å€¼ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">println(</div><div class="line">        <span class="keyword">if</span> (num1 &lt; num2) &#123;</div><div class="line">            println(<span class="string">"num1 &lt; num2"</span>)</div><div class="line">            <span class="string">"if - else è¡¨è¾¾å¼"</span></div><div class="line">        &#125; <span class="keyword">else</span> num2</div><div class="line">)</div></pre></td></tr></table></figure><h4 id="When-è¡¨è¾¾å¼"><a href="#When-è¡¨è¾¾å¼" class="headerlink" title="When è¡¨è¾¾å¼"></a>When è¡¨è¾¾å¼</h4><p>åœ¨ Kotlin ä¸­,<strong><code>when</code></strong> å–ä»£äº†Javaä¸­ <code>switch</code> ã€‚å£°æ˜è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">when</span>[(è¡¨è¾¾å¼)]&#123;</div><div class="line">  [æ¡ä»¶åˆ†æ”¯<span class="number">1</span>,æ¡ä»¶åˆ†æ”¯<span class="number">2</span>(å¯å¤šä¸ª é€—å·åˆ†éš”)] -&gt; controlStructureBody [SEMI]</div><div class="line">  [<span class="keyword">else</span> åˆ†æ”¯] -&gt; controlStructureBody [SEMI]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>SEMI ä»£è¡¨ <code>ï¼›æˆ–è€… æ¢è¡Œ</code> , åœ¨controlStructureBody æ˜¯ä»£ç å—ä¸”æœ‰å˜é‡å£°æ˜æ—¶ä½¿ç”¨, ç¤ºä¾‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">when</span> &#123;</div><div class="line">&#125; <span class="comment">//æœ€ç®€å•çš„å½¢å¼</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> randomNum = Random().nextInt(<span class="number">5</span>)</div><div class="line"><span class="keyword">when</span> (randomNum) &#123;</div><div class="line">  <span class="number">0</span>, <span class="number">1</span> -&gt; println(<span class="string">"randomNum == 0 or randomNum == 1"</span>) <span class="comment">//å¤šä¸ªåˆ†æ”¯æ¡ä»¶æ”¾åœ¨ä¸€èµ·ï¼Œç”¨é€—å·åˆ†éš”</span></div><div class="line">  <span class="number">2</span> -&gt; println(<span class="string">"randomNum == 2"</span>)</div><div class="line">  <span class="keyword">else</span> -&gt; println(<span class="string">"otherwise"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å¦‚æœä¸æä¾›å‚æ•°ï¼Œæ‰€æœ‰çš„åˆ†æ”¯æ¡ä»¶éƒ½æ˜¯ç®€å•çš„å¸ƒå°”è¡¨è¾¾å¼ï¼Œè€Œå½“ä¸€ä¸ªåˆ†æ”¯çš„æ¡ä»¶ä¸ºçœŸæ—¶åˆ™æ‰§è¡Œè¯¥åˆ†æ”¯</span></div><div class="line"><span class="keyword">when</span> &#123;</div><div class="line">  randomNum == <span class="number">0</span> -&gt; &#123;</div><div class="line">    <span class="keyword">var</span> a = <span class="number">2</span>; println(<span class="string">"is 0"</span>) <span class="comment">//;</span></div><div class="line">    <span class="keyword">var</span> b = <span class="number">3</span></div><div class="line">    println(<span class="string">"is 0"</span>) <span class="comment">//æ¢è¡Œ</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//å…¶ä»–åˆ†æ”¯éƒ½ä¸æ»¡è¶³æ¡ä»¶å°†ä¼šæ±‚å€¼ else åˆ†æ”¯</span></div><div class="line"><span class="keyword">when</span> &#123;</div><div class="line">  randomNum == <span class="number">0</span> -&gt; println(<span class="string">"randomNum is 0"</span>)</div><div class="line">  randomNum == <span class="number">1</span> -&gt; println(<span class="string">"randomNum is 1"</span>)</div><div class="line">  <span class="keyword">else</span> -&gt; println(<span class="string">"otherwise"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>NOTE: <code>when</code> ä½œä¸ºä¸€ä¸ªè¡¨è¾¾å¼ä½¿ç”¨ï¼Œåˆ™å¿…é¡»æœ‰ <code>else</code> åˆ†æ”¯ï¼Œ é™¤éæ‰€æœ‰çš„å¯èƒ½æƒ…å†µéƒ½å·²ç»è¦†ç›–äº†ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> an = <span class="keyword">when</span> (<span class="number">1</span>) &#123;</div><div class="line">    <span class="number">1</span> -&gt; <span class="number">1</span></div><div class="line">    <span class="keyword">else</span> -&gt; <span class="string">"never arrive"</span></div><div class="line">&#125;</div><div class="line">println(an)</div><div class="line"><span class="keyword">when</span> (randomNum == <span class="number">3</span>) &#123;</div><div class="line">    <span class="literal">true</span> -&gt; println(<span class="string">"is 3"</span>)</div><div class="line">    <span class="literal">false</span> -&gt; println(randomNum)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="For-å¾ªç¯"><a href="#For-å¾ªç¯" class="headerlink" title="For å¾ªç¯"></a>For å¾ªç¯</h4><p><code>for</code> å¾ªç¯å¯ä»¥å¯¹ä»»ä½•æä¾›è¿­ä»£å™¨ï¼ˆiteratorï¼‰çš„å¯¹è±¡è¿›è¡Œéå†ã€‚<a href="https://kotlinlang.org/docs/reference/grammar.html#for" target="_blank" rel="external">è¯­æ³•</a></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (item <span class="keyword">in</span> collection) print(item)</div><div class="line"><span class="keyword">for</span> (index <span class="keyword">in</span> collection.indices) print(collection[index])</div></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> array = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="comment">//for</span></div><div class="line"><span class="keyword">for</span> (index <span class="keyword">in</span> array.indices) print(array[index]);println() <span class="comment">//ç´¢å¼•éå†ä¸€ä¸ªæ•°ç»„æˆ–è€…ä¸€ä¸ª list</span></div><div class="line"><span class="keyword">for</span> (item <span class="keyword">in</span> array) print(item);println()</div><div class="line"><span class="comment">//åº“å‡½æ•° forEachIndexed</span></div><div class="line">array.forEachIndexed &#123; index, item -&gt;  print(<span class="string">"[<span class="subst">$index</span>] = <span class="subst">$item</span> \t"</span>)&#125;</div><div class="line">println()</div><div class="line"><span class="comment">//åº“å‡½æ•° withIndex</span></div><div class="line"><span class="keyword">for</span> ((index, value) <span class="keyword">in</span> array.withIndex()) &#123;</div><div class="line">    println(<span class="string">"the element at <span class="subst">$index</span> is <span class="subst">$value</span>"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¦‚ä¸Šæ‰€è¿°ï¼Œ<strong>for</strong> å¯ä»¥å¾ªç¯éå†ä»»ä½•æä¾›äº†è¿­ä»£å™¨çš„å¯¹è±¡ã€‚å³ï¼š</p><ul><li>æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°æˆ–è€…æ‰©å±•å‡½æ•° <code>iterator()</code>ï¼Œå®ƒçš„è¿”å›ç±»å‹ <code>Iterator&lt;T&gt;</code></li><li>æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°æˆ–è€…æ‰©å±•å‡½æ•° <code>next()</code></li><li>æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°æˆ–è€…æ‰©å±•å‡½æ•° <code>hasNext()</code> è¿”å› <code>Boolean</code>ã€‚</li></ul><p>è¿™ä¸‰ä¸ªå‡½æ•°éƒ½éœ€è¦æ ‡è®°ä¸º <code>operator</code>ã€‚</p><h4 id="While-å¾ªç¯"><a href="#While-å¾ªç¯" class="headerlink" title="While å¾ªç¯"></a>While å¾ªç¯</h4><p><code>while</code> å’Œ <code>do..while</code> ç…§å¸¸ä½¿ç”¨ã€‚å°ç™½åº”è¯¥ä¹Ÿå¯ä»¥ææ‚å§ã€‚ã€‚ã€‚</p><h4 id="å¾ªç¯ä¸­çš„Breakå’Œcontinue"><a href="#å¾ªç¯ä¸­çš„Breakå’Œcontinue" class="headerlink" title="å¾ªç¯ä¸­çš„Breakå’Œcontinue"></a>å¾ªç¯ä¸­çš„Breakå’Œcontinue</h4><p>åœ¨å¾ªç¯ä¸­ Kotlin æ”¯æŒä¼ ç»Ÿçš„ <code>break</code> å’Œ <code>continue</code> æ“ä½œç¬¦ã€‚</p><h3 id="è¿”å›å’Œè·³è½¬"><a href="#è¿”å›å’Œè·³è½¬" class="headerlink" title="è¿”å›å’Œè·³è½¬"></a>è¿”å›å’Œè·³è½¬</h3><p>Kotlin æœ‰ä¸‰ç§ç»“æ„åŒ–è·³è½¬è¡¨è¾¾å¼ï¼š</p><ul><li>returnã€‚é»˜è®¤ä»æœ€ç›´æ¥åŒ…å›´å®ƒçš„å‡½æ•°æˆ–è€…<a href="#åŒ¿åå‡½æ•°">åŒ¿åå‡½æ•°</a>è¿”å›ã€‚</li><li>breakã€‚ç»ˆæ­¢æœ€ç›´æ¥åŒ…å›´å®ƒçš„å¾ªç¯ã€‚</li><li>continueã€‚ç»§ç»­ä¸‹ä¸€æ¬¡æœ€ç›´æ¥åŒ…å›´å®ƒçš„å¾ªç¯ã€‚</li></ul><h4 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h4><p>åœ¨ Kotlin ä¸­ä»»ä½•è¡¨è¾¾å¼éƒ½å¯ä»¥ç”¨æ ‡ç­¾ï¼ˆlabelï¼‰æ¥æ ‡è®°ã€‚ æ ‡ç­¾çš„æ ¼å¼ä¸ºæ ‡è¯†ç¬¦åè·Ÿ <code>@</code> ç¬¦å·ï¼Œä¾‹å¦‚ï¼š<code>abc@</code>ã€<code>fooBar@</code>éƒ½æ˜¯æœ‰æ•ˆçš„æ ‡ç­¾ï¼ˆå‚è§<a href="https://www.kotlincn.net/docs/reference/grammar.html#labelReference" target="_blank" rel="external">è¯­æ³•</a>ï¼‰ã€‚ è¦ä¸ºä¸€ä¸ªè¡¨è¾¾å¼åŠ æ ‡ç­¾ï¼Œæˆ‘ä»¬åªè¦åœ¨å…¶å‰åŠ æ ‡ç­¾å³å¯ã€‚</p><p>Break å’Œ Continue çš„æ ‡ç­¾æ§åˆ¶è·³è½¬, return æ ‡ç­¾æ§åˆ¶è¿”å›ç›®æ ‡ï¼Œç¤ºä¾‹:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">out@</span> <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</div><div class="line">    <span class="keyword">for</span> (j <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (j == <span class="number">2</span>) <span class="keyword">break</span><span class="symbol">@out</span>;print(<span class="string">"[<span class="subst">$i</span> , <span class="subst">$j</span>] "</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">println()</div><div class="line"><span class="symbol">out@</span> <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</div><div class="line">    <span class="keyword">for</span> (j <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (j == <span class="number">2</span>) <span class="keyword">continue</span><span class="symbol">@out</span>;print(<span class="string">"[<span class="subst">$i</span> , <span class="subst">$j</span>] "</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">println()</div><div class="line"><span class="keyword">var</span> nullInt: <span class="built_in">Int</span>? = <span class="number">1</span></div><div class="line">  nullInt = <span class="literal">null</span></div><div class="line"><span class="keyword">var</span> anLong = nullInt?.toLong() ?: <span class="keyword">return</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">performLabelReturn</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> array = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">    array.forEach &#123;</div><div class="line">        <span class="keyword">if</span> (it == <span class="number">2</span>) <span class="keyword">return</span>  <span class="comment">//</span></div><div class="line">        println(it)</div><div class="line">    &#125;</div><div class="line">    println(<span class="string">"performLabelReturn can't reach"</span>)</div><div class="line">&#125;</div><div class="line">performLabelReturn()</div><div class="line">println()</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">performLabelLambdaLimitReturn</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> array = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">    array.forEach &#123;</div><div class="line">        <span class="keyword">if</span> (it == <span class="number">2</span>) <span class="keyword">return</span><span class="symbol">@forEach</span> <span class="comment">//</span></div><div class="line">        println(it)</div><div class="line">    &#125;</div><div class="line">    println(<span class="string">"performLabelLambdaLimitReturn can reach"</span>)</div><div class="line">&#125;</div><div class="line">performLabelLambdaLimitReturn()</div><div class="line">println()</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">performLabelLimitReturn</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> array = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">    array.forEach <span class="symbol">limit@</span> &#123;</div><div class="line">        <span class="keyword">if</span> (it == <span class="number">2</span>) <span class="keyword">return</span><span class="symbol">@limit</span> <span class="comment">//</span></div><div class="line">        println(it)</div><div class="line">    &#125;</div><div class="line">    println(<span class="string">"performLabelLimitReturn can reach"</span>)</div><div class="line">&#125;</div><div class="line">performLabelLimitReturn()</div><div class="line">println()</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">performLabelAnonymousLambdaLimitReturn</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> array = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">    array.forEach(<span class="function"><span class="title">fun</span><span class="params">(value: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> (value == <span class="number">2</span>) <span class="keyword">return</span>  <span class="comment">// local return to the caller of the anonymous fun, i.e. the forEach loop</span></div><div class="line">        println(value)</div><div class="line">    &#125;)</div><div class="line">    println(<span class="string">"performLabelAnonymousLambdaLimitReturn can reach"</span>)</div><div class="line">&#125;</div><div class="line">performLabelAnonymousLambdaLimitReturn()</div><div class="line">println()</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">a</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span><span class="symbol">@a</span> <span class="number">12</span></div><div class="line">&#125;</div><div class="line">println(a())</div></pre></td></tr></table></figure><h2 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h2><h3 id="ç±»ä¸å¯¹è±¡"><a href="#ç±»ä¸å¯¹è±¡" class="headerlink" title="ç±»ä¸å¯¹è±¡"></a>ç±»ä¸å¯¹è±¡</h3><p>å£°æ˜ç±»ï¼ˆclassï¼‰è¯­æ³•<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[è®¿é—®ä¿®é¥°ç¬¦ é»˜è®¤<span class="keyword">public</span>] [éè®¿é—®ä¿®é¥°ç¬¦ é»˜è®¤ <span class="keyword">final</span>] <span class="class"><span class="keyword">class</span> ç±»å </span></div><div class="line">[è®¿é—®ä¿®é¥°ç¬¦ é»˜è®¤<span class="keyword">public</span>] [ä¸»æ„é€ å‡½æ•°] [å‚æ•°] [: çˆ¶ç±» é»˜è®¤ä¸º Any]  [ç±»ä½“]</div></pre></td></tr></table></figure></p><p>å®šä¹‰ç±»ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmptyClass</span>  </span></div><div class="line">println(EmptyClass() <span class="keyword">is</span> Any)</div></pre></td></tr></table></figure><p>NOTEï¼š [] ä»£è¡¨å¯ä»¥çœç•¥. Kotliin ä¸­<strong>ä¿®é¥°ç¬¦</strong> ä¸Java ç•¥ä¸åŒï¼ŒJavaè¯­è¨€æä¾›äº†å¾ˆå¤šä¿®é¥°ç¬¦ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š</p><ul><li>è®¿é—®ä¿®é¥°ç¬¦</li><li>éè®¿é—®ä¿®é¥°ç¬¦</li></ul><p>æ›´è¯¦ç»†çš„ Java ä¿®é¥°ç¬¦ è¯·å‚è€ƒ<br><a href="http://www.runoob.com/java/java-modifier-types.html" target="_blank" rel="external">Java ä¿®é¥°ç¬¦ _ èœé¸Ÿæ•™ç¨‹</a></p><p>Kotliin ä¸­æ²¡æ˜¾å¼å£°æ˜<strong>ä¿®é¥°ç¬¦</strong> ,é»˜è®¤å¯è§æ€§æ˜¯ <code>public</code>ã€‚</p><h4 id="è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"><a href="#è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦" class="headerlink" title="è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"></a>è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦</h4><p>ç±»ã€å¯¹è±¡ã€æ¥å£ã€æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å±æ€§å’Œå®ƒä»¬çš„ setter éƒ½å¯ä»¥æœ‰ <em>å¯è§æ€§ä¿®é¥°ç¬¦</em>ã€‚ ï¼ˆgetter æ€»æ˜¯ä¸å±æ€§æœ‰ç€ç›¸åŒçš„å¯è§æ€§ã€‚ï¼‰ åœ¨ Kotlin ä¸­æœ‰è¿™å››ä¸ªå¯è§æ€§ä¿®é¥°ç¬¦ï¼š<code>private</code>ã€ <code>protected</code>ã€ <code>internal</code> å’Œ <code>public</code>ã€‚</p><table><thead><tr><th>ä¿®é¥°ç¬¦</th><th>æ˜¯å¦æ”¯æŒé¡¶çº§å£°æ˜</th><th>å½“å‰æ–‡ä»¶</th><th>åŒä¸€æ¨¡å—</th></tr></thead><tbody><tr><td>private</td><td>Y</td><td>Y</td><td>N</td></tr><tr><td>protected</td><td>N</td><td>~~~~</td><td>~~~~</td></tr><tr><td>internal</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>public</td><td>Y</td><td>Y</td><td>Y</td></tr></tbody></table><p>NOTE:</p><ol><li><p><code>protected</code> ä¸æ”¯æŒé¡¶çº§å£°æ˜,å› ä¸ºæ–‡ä»¶æ²¡æœ‰ç»§æ‰¿å…³ç³»ã€‚</p></li><li><blockquote><p><code>internal</code> æ˜¯ç¼–è¯‘åœ¨ä¸€èµ·çš„ä¸€å¥— Kotlin æ–‡ä»¶ï¼š</p><ul><li>ä¸€ä¸ª IntelliJ IDEA æ¨¡å—ï¼›</li><li>ä¸€ä¸ª Maven é¡¹ç›®ï¼›</li><li>ä¸€ä¸ª Gradle æºé›†ï¼›</li><li>ä¸€æ¬¡ ï¼œkotlincï¼ Ant ä»»åŠ¡æ‰§è¡Œæ‰€ç¼–è¯‘çš„ä¸€å¥—æ–‡ä»¶ã€‚</li></ul></blockquote></li><li><blockquote><p>å¯¹äºç±»å’Œæ¥å£å†…éƒ¨å£°æ˜çš„æˆå‘˜å¯è§ä¿®é¥°ç¬¦ä¸Java ç±»ä¼¼:</p><ul><li><code>private</code> ä»…è¯¥ç±»å’Œæ¥å£å†…éƒ¨å¯è§ï¼›</li><li><code>protectd</code> è¯¥ç±»å’Œæ¥å£å†…éƒ¨å¯è§ä¸”å­ç±»å¯è§</li><li><code>internal</code> <em>è¯¥æ¨¡å—å†…</em> å¯è§</li><li><code>public</code> éƒ½å¯è§</li></ul></blockquote></li></ol><h4 id="éè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"><a href="#éè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦" class="headerlink" title="éè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"></a>éè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦</h4><p>kotlin å®šä¹‰ç±»ã€å¯¹è±¡ã€æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å±æ€§æ—¶é»˜è®¤åŠ äº† <code>final</code> ä¿®é¥°ç¬¦, æ¥å£é»˜è®¤æ˜¯  <code>open</code> ä¸ä¹‹ç›¸åã€‚èƒ½è¢«ç»§æ‰¿ã€è¢«è¦†ç›–ã€‚</p><p>NOTEï¼šåœ¨ final ä¿®é¥° class ä¸‹ ç”¨ open ä¿®é¥°è¯¥ç±»çš„æˆå‘˜æ— æ•ˆï¼Œåœ¨ final ç¼ºçœä¿®é¥°ç¬¦ä¸‹ å†ç”¨ final ä¿®é¥°æ˜¾å¾— <code>Redundant</code> å†—ä½™ï¼Œä½†åœ¨ <code>override</code> æ—¶å¯ä½¿ç”¨<code>final</code> å…³é”®å­—å†åº¦ä¿®é¥°</p><p>æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">val</span> name = <span class="string">"å“”å“”"</span> <span class="comment">//private can't open</span></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">open</span> <span class="keyword">val</span> bloodType = <span class="string">"AB"</span></div><div class="line">    <span class="keyword">internal</span> <span class="keyword">val</span> number = <span class="number">1000</span></div><div class="line">    <span class="keyword">open</span> <span class="keyword">val</span> age = <span class="number">28</span></div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="class"><span class="keyword">class</span> <span class="title">Nested</span> </span>&#123;</div><div class="line">        <span class="keyword">val</span> body = &#123;&#125;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">val</span> cipher = <span class="literal">null</span></div><div class="line"></div><div class="line">        <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">            <span class="comment">//can't access private</span></div><div class="line"><span class="comment">//            println(name)</span></div><div class="line"><span class="comment">//            println(bloodType)</span></div><div class="line"><span class="comment">//            println(number)</span></div><div class="line"><span class="comment">//            println(age)</span></div><div class="line"></div><div class="line">            body</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        println(name) <span class="comment">//can't access private</span></div><div class="line">        println(bloodType)</div><div class="line">        println(number)</div><div class="line">        println(age)</div><div class="line"></div><div class="line">        Nested().body</div><div class="line"></div><div class="line"><span class="comment">//        Nested().cipher//Kotlin ä¸­å¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å†…éƒ¨ç±»çš„ private æˆå‘˜</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> : <span class="type">Father</span></span>() &#123;</div><div class="line">    <span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">val</span> bloodType: String = <span class="string">"O"</span> <span class="comment">//protected // final Redundant</span></div><div class="line"><span class="comment">//    override public val bloodType: String = "O" // èƒ½è¦†ç›–</span></div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">val</span> age: <span class="built_in">Int</span> = <span class="number">10</span> <span class="comment">// public</span></div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123; <span class="comment">//Warning: 'open' has no effect in a final class</span></div><div class="line"><span class="comment">//        println(name) //can't access private</span></div><div class="line">        println(bloodType)</div><div class="line">        println(number)</div><div class="line">        println(age)</div><div class="line"></div><div class="line">        Nested().body</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">BigSon</span> : <span class="type">Father</span></span>() &#123;</div><div class="line">    <span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">val</span> bloodType: String = <span class="string">"AB"</span>  <span class="comment">//can use final</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>NOTEï¼šå±€éƒ¨å˜é‡ã€å‡½æ•°å’Œç±»ä¸èƒ½æœ‰å¯è§æ€§ä¿®é¥°ç¬¦ã€‚Kotlin ä¸­å¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å†…éƒ¨ç±»çš„ private æˆå‘˜(ä¸Javaä¸åŒ)ã€‚</p><h4 id="ç±»æˆå‘˜"><a href="#ç±»æˆå‘˜" class="headerlink" title="ç±»æˆå‘˜"></a>ç±»æˆå‘˜</h4><p>ç±»å¯ä»¥åŒ…å«</p><ul><li><a href="#æ„é€ å‡½æ•°">æ„é€ å‡½æ•°</a>å’Œåˆå§‹åŒ–å—</li><li><a href="#å‡½æ•°">å‡½æ•°</a></li><li><a href="#å±æ€§">å±æ€§</a></li><li><a href="#åµŒå¥—ç±»å’Œå†…éƒ¨ç±»">åµŒå¥—ç±»å’Œå†…éƒ¨ç±»</a></li><li><a href="#å¯¹è±¡å£°æ˜l">å¯¹è±¡å£°æ˜</a></li></ul><h4 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><p>ä¸€ä¸ªç±»å¯ä»¥æœ‰ä¸€ä¸ªä¸»æ„é€ å‡½æ•°å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ¬¡æ„é€ å‡½æ•°ã€‚ä¸»æ„é€ å‡½æ•°æ˜¯ç±»å¤´çš„ä¸€éƒ¨åˆ†ï¼šå®ƒè·Ÿåœ¨ç±»åï¼ˆå’Œè®¿é—®ä¿®é¥°ç¬¦ [é»˜è®¤ public]ï¼‰åã€‚ä¸»æ„é€ å‡½æ•°æœ‰æ³¨è§£æˆ–å¯è§æ€§ä¿®é¥°ç¬¦ï¼Œè¿™ä¸ª <strong>constructor</strong> å…³é”®å­—æ˜¯å¿…éœ€çš„ï¼Œå¹¶ä¸”è¿™äº›ä¿®é¥°ç¬¦åœ¨å®ƒå‰é¢ã€‚éæŠ½è±¡ç±»æ²¡æœ‰å£°æ˜ä»»ä½•ï¼ˆä¸»æˆ–æ¬¡ï¼‰æ„é€ å‡½æ•°ï¼Œå®ƒä¼šæœ‰ä¸€ä¸ªç”Ÿæˆçš„ä¸å¸¦å‚æ•°çš„ä¸»æ„é€ å‡½æ•°ã€‚æ„é€ å‡½æ•°çš„å¯è§æ€§æ˜¯ publicã€‚</p><p>NOTEï¼šè‹¥è¦ä¿®æ”¹ä¸»æ„é€ å‡½æ•°çš„å¯è§æ€§,éœ€è¦æ·»åŠ ä¸€ä¸ªæ˜¾å¼ <strong>constructor</strong> å…³é”®å­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class A private constructor() &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><p>Kotlin ååˆ†ç®€ä¾¿, å¯ä»¥åœ¨<strong>ä¸»æ„é€ å‡½æ•°</strong>å†…å£°æ˜å±æ€§ï¼ˆå¯å˜çš„ï¼ˆvarï¼‰æˆ–åªè¯»çš„ï¼ˆvalï¼‰ï¼‰ä»¥åŠåˆå§‹åŒ–å±æ€§é»˜è®¤å€¼ï¼ˆ<strong>æ¬¡æ„é€ å‡½æ•°</strong>æ˜¯ä¸å…è®¸çš„ï¼‰, ä¸”ä¸ºè¯¥ç±»æˆå‘˜å±æ€§, <strong>ä¸»æ„é€ å‡½æ•°</strong>å†…ä¸èƒ½åŒ…å«é™¤äº†å£°æ˜å±æ€§ä»»ä½•çš„ä»£ç ã€‚æä¾›äº† <strong>init</strong> å…³é”®å­—ä½œä¸ºå‰ç¼€çš„<strong>åˆå§‹åŒ–å—ï¼ˆinitializer blocksï¼‰</strong>ã€‚</p><h4 id="æ¬¡æ„é€ å‡½æ•°"><a href="#æ¬¡æ„é€ å‡½æ•°" class="headerlink" title="æ¬¡æ„é€ å‡½æ•°"></a>æ¬¡æ„é€ å‡½æ•°</h4><p>å£°æ˜åœ¨ç±»ä½“å†…ä»¥ <code>constructor</code> å…³é”®å­—çš„å‡½æ•°ã€‚è‹¥è¯¥ç±»æœ‰ä¸»æ„é€ å‡½æ•°,æ¬¡æ„é€ å‡½æ•°éƒ½éœ€è¦ç”¨ <code>this</code> å…³é”®å­—ç›´æ¥æˆ–é—´æ¥å§”æ‰˜ç»™ä¸»æ„é€ å‡½æ•°ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> /*<span class="keyword">private</span>*/ <span class="keyword">constructor</span></span>(firstName: String) &#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">A</span> //<span class="title">empty</span> <span class="title">class</span> ä¸‹é¢æ¥ç€æ˜¯æ¬¡æ„é€ å‡½æ•° ï¼Œ<span class="title">Error</span>: <span class="type">Expecting member declaration</span>, <span class="type">æœŸå¾…æˆå‘˜å£°æ˜</span></span></div><div class="line"></div><div class="line">    <span class="keyword">val</span> money = <span class="number">1000</span>_000</div><div class="line"></div><div class="line">    init &#123;</div><div class="line">        println(<span class="string">"init block: firstName= <span class="subst">$firstName</span>"</span>)</div><div class="line">        println(<span class="string">"init block: money= <span class="subst">$money</span>"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//æ¬¡æ„é€ å‡½æ•°</span></div><div class="line">    <span class="keyword">constructor</span>(firstName: String, age: <span class="built_in">Int</span>) : <span class="keyword">this</span>(firstName) &#123;</div><div class="line">        println(<span class="string">"secondary constructor: firstName= <span class="subst">$firstName</span>"</span>)</div><div class="line">        println(<span class="string">"secondary constructor: age= <span class="subst">$age</span>"</span>)</div><div class="line">        println(<span class="string">"init block: money= <span class="subst">$money</span>"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">constructor</span> (firstName: String, age: <span class="built_in">Int</span>, money: <span class="built_in">Int</span>) : <span class="keyword">this</span>(firstName, age) &#123;</div><div class="line">        println(<span class="string">"secondary constructor: firstName= <span class="subst">$firstName</span>"</span>)</div><div class="line">        println(<span class="string">"secondary constructor: age= <span class="subst">$age</span>"</span>)</div><div class="line">        println(<span class="string">"init block: money= <span class="subst">$money</span>"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">æ³¨æ„ï¼šåœ¨ JVM ä¸Šï¼Œå¦‚æœä¸»æ„é€ å‡½æ•°çš„æ‰€æœ‰çš„å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆ ä¸€ä¸ªé¢å¤–çš„æ— å‚æ„é€ å‡½æ•°ï¼Œå®ƒå°†ä½¿ç”¨é»˜è®¤å€¼ã€‚è¿™ä½¿å¾— Kotlin æ›´æ˜“äºä½¿ç”¨åƒ Jackson æˆ–è€… JPA è¿™æ ·çš„é€šè¿‡æ— å‚æ„é€ å‡½æ•°åˆ›å»ºç±»çš„å®ä¾‹çš„åº“ã€‚</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span></span>(<span class="keyword">val</span> customerName: String = <span class="string">""</span>)</div></pre></td></tr></table></figure><h4 id="åˆ›å»ºç±»çš„å®ä¾‹"><a href="#åˆ›å»ºç±»çš„å®ä¾‹" class="headerlink" title="åˆ›å»ºç±»çš„å®ä¾‹"></a>åˆ›å»ºç±»çš„å®ä¾‹</h4><p>Kotlin å¹¶ä¸éœ€è¦ new å…³é”®å­—åˆ›å»ºå®ä¾‹, åƒæ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨æ„é€ å‡½æ•°å³å¯ã€‚</p><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><p>Java çš„è¶…ç±»æ˜¯ <code>Object</code> , è€Œ Kotlin çš„æ˜¯ Anyã€‚</p><p>è‹¥çˆ¶ç±»æœ‰ä¸»æ„é€ å‡½æ•°ä¸”å¸¦å‚æ•°,å­ç±»å¿…é¡»ç”¨ä¸»æ„é€ å‡½æ•°å°†å‚æ•°åˆå§‹åŒ–ï¼Œå¦‚ä¸‹:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>(firstName: String) : Person(firstName) &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ³¨æ„:å‚æ•°åˆå§‹åŒ–æ—¶,å­çˆ¶ç±»å¿…é¡»ä¸€è‡´ã€‚</p><p>çˆ¶ç±»æ²¡æœ‰ä¸»æ„é€ å‡½æ•°, é‚£ä¹ˆæ¯ä¸ªæ¬¡æ„é€ å‡½æ•°å¿…é¡»ä½¿ç”¨ super å…³é”®å­—åˆå§‹åŒ–å…¶åŸºç±»å‹ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(name: String) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">constructor</span>(name: String, age: <span class="built_in">Int</span>) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Woman</span> : <span class="type">Human &#123;</span></span></div><div class="line">    <span class="keyword">constructor</span>(name: String) : <span class="keyword">super</span>(name)</div><div class="line">    <span class="keyword">constructor</span>(name: String, age: <span class="built_in">Int</span>) : <span class="keyword">super</span>(name, age)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å…è®¸é€šè¿‡ä¸»æ„é€ å‡½æ•°è¦†ç›–æ¬¡æ„é€ å‡½æ•°</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span></span>(name: String) : Human(name)</div></pre></td></tr></table></figure><h4 id="è¦†ç›–-override"><a href="#è¦†ç›–-override" class="headerlink" title="è¦†ç›–(override)"></a>è¦†ç›–(<strong>override</strong>)</h4><p> <code>final</code> , <code>open</code> æ˜¯å¦å¯è¦†ç›–ä¿®é¥°ç¬¦ å’Œ <code>override</code>  æ ‡æ³¨è¦†ç›–ç±»ã€å¯¹è±¡ã€æ¥å£ã€æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å±æ€§ã€‚</p><h4 id="è¦†ç›–è§„åˆ™"><a href="#è¦†ç›–è§„åˆ™" class="headerlink" title="è¦†ç›–è§„åˆ™"></a>è¦†ç›–è§„åˆ™</h4><p>åœ¨ Kotlin ä¸­ï¼Œå®ç°ç»§æ‰¿ç”±ä¸‹è¿°è§„åˆ™è§„å®š:å¦‚æœä¸€ä¸ªç±»ä»å®ƒçš„ç›´æ¥è¶…ç±»ç»§æ‰¿ç›¸åŒæˆå‘˜çš„å¤šä¸ªå®ç°ï¼Œ å®ƒå¿…é¡»è¦†ç›–è¿™ä¸ªæˆå‘˜å¹¶æä¾›å…¶è‡ªå·±çš„å®ç°(ä¹Ÿè®¸ç”¨ç»§æ‰¿æ¥çš„å…¶ä¸­ä¹‹ä¸€)æ¥æ¶ˆé™¤æ­§ä¹‰ã€‚ ä¸ºäº†è¡¨ç¤ºé‡‡ç”¨ ä»å“ªä¸ªè¶…ç±»å‹ç»§æ‰¿çš„å®ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨ç”±å°–æ‹¬å·ä¸­è¶…ç±»å‹åé™å®šçš„ super ï¼Œå¦‚ super<base> :</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">run</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"Thread#run"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">start</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"Thread#start"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">run</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"Thread#run"</span>)</div><div class="line">    &#125; <span class="comment">// æ¥å£æˆå‘˜é»˜è®¤å°±æ˜¯â€œopenâ€çš„</span></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HandlerThread</span></span>() : Runnable, Thread() &#123;</div><div class="line">    <span class="comment">//ç¼–è¯‘å™¨è¦æ±‚è¦†ç›– run():</span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">run</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>&lt;Thread&gt;.run() <span class="comment">// è°ƒç”¨ Thread.run()</span></div><div class="line">        <span class="keyword">super</span>&lt;Runnable&gt;.run() <span class="comment">// è°ƒç”¨ Runnable.run()</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h3><p>ç±»å’Œå…¶ä¸­çš„æŸäº›æˆå‘˜å¯ä»¥å£°æ˜ä¸º abstract ã€‚ æŠ½è±¡æˆå‘˜åœ¨æœ¬ç±»ä¸­å¯ä»¥ä¸ç”¨å®ç°ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ç”¨ open æ ‡æ³¨ä¸€ä¸ªæŠ½è±¡ç±»æˆ–è€…å‡½æ•°â€”â€”å› ä¸ºè¿™ä¸è¨€è€Œå–»ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractClass</span></span>&#123; <span class="comment">//open å¤šä½™çš„,å› ä¸ºæŠ½è±¡ç±»ç»ˆç©¶æ˜¯çˆ¶ç±»,æ‰€ä»¥æ›´ä¸èƒ½ç”¨final ä¿®é¥°</span></div><div class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">doSomething</span><span class="params">()</span></span> &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">fly</span><span class="params">()</span></span> <span class="comment">//å­ç±»å¿…é¡» override</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbstractClassImpl</span> : <span class="type">AbstractClass</span></span>() &#123;</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">fly</span><span class="params">()</span></span> &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">doSomething</span><span class="params">()</span></span> &#123;<span class="comment">//override å¼€æ”¾æˆå‘˜</span></div><div class="line">        <span class="keyword">super</span>.doSomething()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><p>ç”¨å…³é”®å­— <strong>interface</strong> æ¥å®šä¹‰æ¥å£ã€‚Kotlin çš„æ¥å£å‡½æ•°å¯ä»¥æœ‰å®ç°, å±æ€§å¿…é¡»æ˜¯æŠ½è±¡çš„ï¼ˆé»˜è®¤æŠ½è±¡ï¼‰, æˆ–è€…æä¾› <code>get</code> è®¿é—®å™¨å®ç°, ä¸”ä¸èƒ½æœ‰å¹•åå­—æ®µ(backing field)ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> kotlinLanguage = KotlinLanguage()</div><div class="line">    println(kotlinLanguage.language)</div><div class="line">    println(kotlinLanguage.that)</div><div class="line">    println(kotlinLanguage.that === kotlinLanguage)</div><div class="line">    kotlinLanguage.onReady()</div><div class="line">    kotlinLanguage.onUpgrade()</div><div class="line"></div><div class="line">    MultipurposePrinter().print()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">KotlinInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">val</span> language <span class="keyword">get</span>() = <span class="string">"Kotlin"</span></div><div class="line">    <span class="keyword">val</span> that: KotlinInterface</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onUpgrade</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"call#onUpgrade"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onReady</span><span class="params">()</span></span> <span class="comment">//</span></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">KotlinLanguage</span> : <span class="type">KotlinInterface &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="keyword">val</span> that: KotlinInterface</div><div class="line">        <span class="keyword">get</span>() = <span class="keyword">this</span></div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onReady</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"call#onReady"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Printer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ColorPrinter</span> : <span class="type">Printer &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"ColorPrinter#print"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="comment">//    val printerType get() = "ColorPrinter"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">BlackPrinter</span> : <span class="type">Printer &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"BlackPrinter#print"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">val</span> printerType <span class="keyword">get</span>() = <span class="string">"BlackPrinter"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultipurposePrinter</span> : <span class="type">ColorPrinter</span>, <span class="type">BlackPrinter &#123;</span></span></div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"MultipurposePrinter#print"</span>)</div><div class="line">        <span class="keyword">super</span>&lt;BlackPrinter&gt;.print()</div><div class="line">        <span class="keyword">super</span>&lt;ColorPrinter&gt;.print()</div><div class="line"></div><div class="line">        <span class="keyword">super</span>.printerType</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="åµŒå¥—ç±»å’Œå†…éƒ¨ç±»"><a href="#åµŒå¥—ç±»å’Œå†…éƒ¨ç±»" class="headerlink" title="åµŒå¥—ç±»å’Œå†…éƒ¨ç±»"></a>åµŒå¥—ç±»å’Œå†…éƒ¨ç±»</h3><p>ç±»å¯ä»¥åµŒå¥—åœ¨å…¶ä»–ç±»ä¸­</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    println(KotlinNestedInnerClass.KotlinNestedClass().bra())</div><div class="line">    println(KotlinNestedInnerClass().KotlinInnerClass().bra())</div><div class="line">    println(KotlinNestedInnerClass().KotlinInnerClass().reference())</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinNestedInnerClass</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">val</span> bra: String = <span class="string">"C"</span></div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">KotlinNestedClass</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">bra</span><span class="params">()</span></span> = KotlinNestedInnerClass().bra</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//å†…éƒ¨ç±» æ ‡è®°ä¸º inner ä»¥ä¾¿èƒ½å¤Ÿè®¿é—®å¤–éƒ¨ç±»çš„æˆå‘˜ã€‚å†…éƒ¨ç±»ä¼šå¸¦æœ‰ä¸€ä¸ªå¯¹å¤–éƒ¨ç±»çš„å¯¹è±¡çš„å¼•ç”¨</span></div><div class="line">    inner <span class="class"><span class="keyword">class</span> <span class="title">KotlinInnerClass</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">bra</span><span class="params">()</span></span> = bra</div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">reference</span><span class="params">()</span></span> = <span class="keyword">this</span><span class="symbol">@KotlinNestedInnerClass</span>  <span class="comment">//This è¡¨è¾¾å¼</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//åŒ¿åå†…éƒ¨ç±» @see å¯¹è±¡å£°æ˜(object)</span></div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¦‚æœå¯¹è±¡æ˜¯å‡½æ•°å¼ Java æ¥å£ï¼ˆå³å…·æœ‰å•ä¸ªæŠ½è±¡æ–¹æ³•çš„ Java æ¥å£ï¼‰çš„å®ä¾‹ï¼Œ ä½ å¯ä»¥ä½¿ç”¨å¸¦æ¥å£ç±»å‹å‰ç¼€çš„lambdaè¡¨è¾¾å¼åˆ›å»ºå®ƒï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> run  = Runnable &#123;  &#125;</div></pre></td></tr></table></figure><h3 id="å¯¹è±¡-object"><a href="#å¯¹è±¡-object" class="headerlink" title="å¯¹è±¡(object)"></a>å¯¹è±¡(object)</h3><p>åœ¨Java ä¸­, åŒ¿åå†…éƒ¨ç±»éšå¤„å¯è§ã€‚ç„¶è€Œ Kotlin ç”¨ <code>object</code> å…³é”®å­—æä¾›äº†å¯¹è±¡å£°æ˜ä»¥åŠå¯¹è±¡è¡¨è¾¾å¼ç‰¹æ€§, åˆ›å»ºå•ä¾‹ã€åŒ¿åå¯¹è±¡, ä¼´ç”Ÿå¯¹è±¡(ç±»å†…éƒ¨çš„å¯¹è±¡å£°æ˜) so easyã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> point = <span class="keyword">object</span> <span class="comment">/*: Any()*/</span> &#123; <span class="comment">//é»˜è®¤ç»§æ‰¿ Any</span></div><div class="line">    <span class="keyword">var</span> x: <span class="built_in">Int</span> = <span class="number">0</span> <span class="comment">//å¿…é¡»è¿›è¡Œåˆå§‹åŒ–</span></div><div class="line">    <span class="keyword">var</span> y: <span class="built_in">Int</span> = <span class="number">0</span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">toString</span><span class="params">()</span></span>: String &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"point[<span class="subst">$x</span>ï¼Œ<span class="subst">$y</span>]"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">point.x = <span class="number">100</span></div><div class="line">point.y = <span class="number">300</span></div><div class="line">println(point)</div><div class="line"><span class="keyword">val</span> singleton = Singleton</div><div class="line"><span class="keyword">val</span> singleton1 = Singleton</div><div class="line">println(singleton === singleton1)</div><div class="line"></div><div class="line"><span class="comment">//å¯¹è±¡å£°æ˜</span></div><div class="line"><span class="keyword">object</span> Singleton &#123; <span class="comment">//å†³ä¸èƒ½å£°æ˜å±€éƒ¨ä½œç”¨åŸŸ(å‡½æ•°ä¸­)</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>NOTE: å¦‚ä½•åŒºåˆ†å¯¹è±¡å£°æ˜å’Œå¯¹è±¡è¡¨è¾¾å¼, é¡¾åæ€ä¹‰, æœ‰åå­—çš„æ˜¯å¯¹è±¡å£°æ˜ï¼ˆobject Singletonï¼‰, æ²¡åå­—çš„æ˜¯å¯¹è±¡è¡¨è¾¾å¼ï¼ˆanonymous objectï¼‰ã€‚</p><p>å…³äº <code>object</code> ä½¿ç”¨ç»†èŠ‚,ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­ä¸ºå¤§å®¶æ¼”ç¤º:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">KotlinObject</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">privateObject</span><span class="params">()</span></span> = <span class="keyword">object</span> &#123; <span class="comment">//è¿”å›: &lt;anonymous object : Any&gt;</span></div><div class="line">        <span class="keyword">val</span> name = <span class="string">"123"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">publicObject</span><span class="params">()</span></span> = <span class="keyword">object</span> &#123; <span class="comment">// è¿”å›Any å»ºè®®private</span></div><div class="line">        <span class="keyword">val</span> name = <span class="string">"ABC"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">run</span><span class="params">()</span></span> &#123;</div><div class="line">        println(privateObject().name)</div><div class="line">        <span class="comment">//println(publicObject().name) //é”™è¯¯ï¼šæœªèƒ½è§£æçš„å¼•ç”¨â€œnameâ€</span></div><div class="line">        <span class="keyword">var</span> visible = <span class="literal">true</span></div><div class="line">        call(<span class="keyword">object</span> : CallBack &#123;</div><div class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">()</span></span> &#123;</div><div class="line">                visible <span class="comment">//å¯¹è±¡è¡¨è¾¾å¼ä¸­çš„ä»£ç å¯ä»¥è®¿é—®æ¥è‡ªåŒ…å«å®ƒçš„ä½œç”¨åŸŸçš„å˜é‡</span></div><div class="line">                println(<span class="string">"Anonymous#call@<span class="subst">$&#123;this.hashCode()&#125;</span>"</span>)</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;)</div><div class="line">        call (<span class="keyword">object</span> : CallBack &#123;</div><div class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">()</span></span> &#123;</div><div class="line">                visible <span class="comment">//å¯¹è±¡è¡¨è¾¾å¼ä¸­çš„ä»£ç å¯ä»¥è®¿é—®æ¥è‡ªåŒ…å«å®ƒçš„ä½œç”¨åŸŸçš„å˜é‡</span></div><div class="line">                println(<span class="string">"Anonymous#call@<span class="subst">$&#123;this.hashCode()&#125;</span>"</span>)</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;)</div><div class="line">        call(OneCallBack)</div><div class="line">        call(OneCallBack)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">object</span> OneCallBack : CallBack &#123;</div><div class="line">        <span class="comment">//å› ä¸ºå¯¹è±¡è¡¨è¾¾å¼ä¸èƒ½ç»‘å®šåå­—,è¿™ç§°ä¸ºå¯¹è±¡å£°æ˜</span></div><div class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">()</span></span> &#123;</div><div class="line">            println(<span class="string">"OneCallBack#call@<span class="subst">$&#123;this.hashCode()&#125;</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">(call: <span class="type">CallBack</span>)</span></span> &#123;</div><div class="line">        call.call()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">CallBack</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">()</span></span>: <span class="built_in">Unit</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">KotlinObject().run()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç§æœ‰å‡½æ•°æ—¶,è¿”å›<code>object</code>ç±»å‹æ˜¯åŒ¿åå¯¹è±¡ç±»å‹, å¦åˆ™æ˜¯ <code>Any</code>ã€‚ä¸Java ä¸åŒå†…éƒ¨ç±»ä¹Ÿå¯è®¿é—®é final å˜é‡ã€‚å¯¹è±¡å£°æ˜å®åˆ™æ˜¯å•ä¾‹ã€‚</p><h4 id="ä¼´ç”Ÿå¯¹è±¡ï¼ˆcompanion-objectï¼‰"><a href="#ä¼´ç”Ÿå¯¹è±¡ï¼ˆcompanion-objectï¼‰" class="headerlink" title="ä¼´ç”Ÿå¯¹è±¡ï¼ˆcompanion objectï¼‰"></a>ä¼´ç”Ÿå¯¹è±¡ï¼ˆcompanion objectï¼‰</h4><p>ä¸ Java æˆ– C# ä¸åŒï¼Œåœ¨ Kotlin ä¸­ç±»æ²¡æœ‰é™æ€æ–¹æ³•ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒå»ºè®®ç®€å•åœ°ä½¿ç”¨åŒ…çº§å‡½æ•°ã€‚</p><p>ç±»å†…éƒ¨çš„å¯¹è±¡å£°æ˜å¯ä»¥ç”¨ <code>companion</code> å…³é”®å­—æ ‡è®°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">World</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//Companion æ˜¯companion object é»˜è®¤åå­—å¯çœç•¥,ä»…ä¸”æœ‰ä¸€ä¸ªä¼´ç”Ÿå¯¹è±¡</span></div><div class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> Companion : Observer &#123;</div><div class="line">        <span class="meta">@JvmField</span> <span class="comment">//@JvmField æ ‡æ³¨è¿™æ ·çš„å±æ€§ä½¿å…¶æˆä¸ºä¸å±æ€§æœ¬èº«å…·æœ‰ç›¸åŒå¯è§æ€§çš„é™æ€å­—æ®µã€‚</span></div><div class="line">        <span class="keyword">val</span> time = System.nanoTime()</div><div class="line"></div><div class="line">        const <span class="keyword">val</span> VERSION = <span class="string">"1.1.4.2"</span> <span class="comment">//kotlin å¸¸é‡(const æ ‡æ³¨çš„ï¼ˆåœ¨ç±»ä¸­ä»¥åŠåœ¨é¡¶å±‚çš„ï¼‰å±æ€§), åœ¨ Java ä¸­ä¼šæˆä¸ºé™æ€å­—æ®µï¼š</span></div><div class="line"></div><div class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">update</span><span class="params">(o: <span class="type">Observable</span>?, arg: <span class="type">Any</span>?)</span></span> &#123;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//        @JvmStatic  //æ‰“å¼€æ³¨é‡Šç¼–è¯‘æŠ¥é”™,å­˜åœ¨ç›¸åŒçš„å‡½æ•°å£°æ˜, è¿™å……åˆ†åœ°è¯æ˜äº†ä¼´ç”Ÿå¯¹è±¡çš„æˆå‘˜çœ‹èµ·æ¥åƒå…¶ä»–è¯­è¨€çš„é™æ€æˆå‘˜ï¼Œåœ¨è¿è¡Œæ—¶ä»–ä»¬ä»ç„¶æ˜¯çœŸå®å¯¹è±¡çš„å®ä¾‹æˆå‘˜</span></div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">sayHello</span><span class="params">()</span></span> &#123;</div><div class="line">            println(<span class="string">"sayHello@<span class="subst">$&#123;this.hashCode()&#125;</span> "</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">sayHello</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"sayHello@<span class="subst">$&#123;this.hashCode()&#125;</span> "</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    World.sayHello()</div><div class="line">    World.Companion.sayHello()</div><div class="line">    World().sayHello()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Java ä¸­è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticTest</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        System.out.println(World.Companion);</div><div class="line">        System.out.println(World.VERSION);</div><div class="line">        System.out.println(World.time);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>NOTE:ä¼´ç”Ÿå¯¹è±¡å®é™…æ˜¯å¯¹è±¡çš„å®ä¾‹æˆå‘˜ï¼Œ JVM å¹³å°ï¼Œå¦‚æœä½¿ç”¨ <code>@JvmStatic</code> æ³¨è§£ï¼Œä½ å¯ä»¥å°†ä¼´ç”Ÿå¯¹è±¡çš„æˆå‘˜ç”Ÿæˆä¸ºçœŸæ­£çš„é™æ€æ–¹æ³•å’Œå­—æ®µã€‚æ›´è¯¦ç»†ä¿¡æ¯è¯·å‚è§<a href="https://www.kotlincn.net/docs/reference/java-to-kotlin-interop.html#é™æ€å­—æ®µ" target="_blank" rel="external">Java äº’æ“ä½œæ€§</a>ä¸€èŠ‚ ã€‚</p><p>å¯¹è±¡è¡¨è¾¾å¼å’Œå¯¹è±¡å£°æ˜ä¹‹é—´æœ‰ä¸€ä¸ªé‡è¦çš„è¯­ä¹‰å·®åˆ«ï¼š</p><ul><li>å¯¹è±¡è¡¨è¾¾å¼æ˜¯åœ¨ä½¿ç”¨ä»–ä»¬çš„åœ°æ–¹<strong>ç«‹å³</strong>æ‰§è¡Œï¼ˆåŠåˆå§‹åŒ–ï¼‰çš„</li><li>å¯¹è±¡å£°æ˜æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®åˆ°æ—¶<strong>å»¶è¿Ÿ</strong>åˆå§‹åŒ–çš„</li><li>ä¼´ç”Ÿå¯¹è±¡çš„åˆå§‹åŒ–æ˜¯åœ¨ç›¸åº”çš„ç±»è¢«åŠ è½½ï¼ˆè§£æï¼‰æ—¶ï¼Œä¸ Java é™æ€åˆå§‹åŒ–å™¨çš„è¯­ä¹‰ç›¸åŒ¹é…</li></ul><h3 id="æ•°æ®ç±»"><a href="#æ•°æ®ç±»" class="headerlink" title="æ•°æ®ç±»"></a>æ•°æ®ç±»</h3><p>æˆ‘ä»¬ç»å¸¸åˆ›å»ºä¸€äº›åªä¿å­˜æ•°æ®çš„ç±»ã€‚åœ¨è¿™äº›ç±»ä¸­ï¼Œä¸€äº›æ ‡å‡†å‡½æ•°å¾€å¾€æ˜¯ä»æ•°æ®æœºæ¢°æ¨å¯¼è€Œæ¥çš„ã€‚åœ¨ Kotlin ä¸­ï¼Œè¿™å«åš <strong>æ•°æ®ç±»</strong> å¹¶æ ‡è®°ä¸º <code>data</code>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> user1 = KotlinDataClass.User(<span class="string">"å°æ˜"</span>, <span class="number">19</span>)</div><div class="line">    <span class="keyword">val</span> user2 = KotlinDataClass.User(<span class="string">"å°æ˜"</span>, <span class="number">19</span>)</div><div class="line">    println(user1 == user2)</div><div class="line">    println(user1)</div><div class="line">    <span class="keyword">val</span> copyXiaoMing = user1.copy(age = <span class="number">20</span>)</div><div class="line">    println(copyXiaoMing)</div><div class="line">    println(user1.component1())</div><div class="line">    <span class="keyword">val</span> bb = KotlinDataClass.User(<span class="string">"bb"</span>)</div><div class="line">    println(bb)</div><div class="line"></div><div class="line">    <span class="comment">//æ•°æ®ç±»å’Œè§£æ„å£°æ˜</span></div><div class="line">    <span class="keyword">val</span> (name, age) = KotlinDataClass.User(<span class="string">"Lisa"</span>, <span class="number">18</span>)</div><div class="line">    println(<span class="string">"<span class="subst">$name</span>, <span class="subst">$age</span> years of age"</span>)</div><div class="line"></div><div class="line">    <span class="comment">//æ ‡å‡†æ•°æ®ç±»</span></div><div class="line">    <span class="keyword">val</span> anPair: Pair&lt;<span class="built_in">Char</span>, <span class="built_in">Char</span>&gt; = Pair(<span class="string">'A'</span>, <span class="string">'B'</span>)</div><div class="line">    println(<span class="string">"first = <span class="subst">$&#123;anPair.first&#125;</span>, second = <span class="subst">$&#123;anPair.second&#125;</span>"</span>)</div><div class="line">    <span class="keyword">val</span> (a,b,c) = Triple(<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>)</div><div class="line">    println(<span class="string">"(<span class="subst">$a</span>, <span class="subst">$b</span>, <span class="subst">$c</span>)"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinDataClass</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line"></div><div class="line">    <span class="comment">//æ•°æ®ç±»æœ¬èº«æ˜¯ final,å¿…é¡»æœ‰ä¸»æ„é€ å™¨,è‡³å°‘ä¸€ä¸ªå‚æ•°</span></div><div class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> age: <span class="built_in">Int</span> = <span class="number">0</span>) : Person() &#123;</div><div class="line"></div><div class="line">        <span class="comment">//ç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸»æ„é€ å‡½æ•°çš„å‚æ•°ç”Ÿæˆä»¥ä¸‹å‡½æ•°,æ ¹æ®éœ€æ±‚ override</span></div><div class="line"></div><div class="line"><span class="comment">//    override fun equals(other: Any?): Boolean &#123;</span></div><div class="line"><span class="comment">//        return super.equals(other)</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//    override fun hashCode(): Int &#123;</span></div><div class="line"><span class="comment">//        return super.hashCode()</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//    override fun toString(): String &#123;</span></div><div class="line"><span class="comment">//        return super.toString()</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line"><span class="comment">//    Error: Conflicting overloads:</span></div><div class="line"><span class="comment">//    fun component1()&#123;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨è‡ªåŠ¨ä»ä¸»æ„é€ å‡½æ•°ä¸­å£°æ˜çš„æ‰€æœ‰å±æ€§å¯¼å‡ºä»¥ä¸‹æˆå‘˜ï¼š</p><ul><li><code>equals()</code>/<code>hashCode()</code> å¯¹ï¼Œ</li><li><code>toString()</code> æ ¼å¼æ˜¯ <code>&quot;User(name=John, age=42)&quot;</code>ï¼Œ</li><li><a href="#å‡½æ•°"><code>componentN()</code> å‡½æ•°</a> æŒ‰å£°æ˜é¡ºåºå¯¹åº”äºæ‰€æœ‰å±æ€§ï¼Œ</li><li><code>copy()</code> å‡½æ•°, å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ä»…æ”¹å˜æŸäº›å±æ€§ã€‚</li></ul><p>ä¸ºäº†ç¡®ä¿ç”Ÿæˆçš„ä»£ç çš„ä¸€è‡´æ€§å’Œæœ‰æ„ä¹‰çš„è¡Œä¸ºï¼Œæ•°æ®ç±»å¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š</p><ul><li>ä¸»æ„é€ å‡½æ•°éœ€è¦è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ï¼›</li><li>ä¸»æ„é€ å‡½æ•°çš„æ‰€æœ‰å‚æ•°éœ€è¦æ ‡è®°ä¸º <code>val</code> æˆ– <code>var</code>ï¼›</li><li>æ•°æ®ç±»ä¸èƒ½æ˜¯æŠ½è±¡ã€å¼€æ”¾ã€å¯†å°æˆ–è€…å†…éƒ¨çš„ï¼›</li><li>ï¼ˆåœ¨1.1ä¹‹å‰ï¼‰æ•°æ®ç±»åªèƒ½å®ç°æ¥å£ã€‚</li></ul><p>è‡ª 1.1 èµ·ï¼Œæ•°æ®ç±»å¯ä»¥æ‰©å±•å…¶ä»–ç±»ï¼ˆç¤ºä¾‹è¯·å‚è§<a href="#å¯†å°ç±»">å¯†å°ç±»</a>ï¼‰ã€‚</p><p>åœ¨ JVM ä¸­ï¼Œå¦‚æœç”Ÿæˆçš„ç±»éœ€è¦å«æœ‰ä¸€ä¸ªæ— å‚çš„æ„é€ å‡½æ•°ï¼Œåˆ™æ‰€æœ‰çš„å±æ€§å¿…é¡»æŒ‡å®šé»˜è®¤å€¼ã€‚ ï¼ˆå‚è§<a href="https://www.kotlincn.net/docs/reference/classes.html#æ„é€ å‡½æ•°" target="_blank" rel="external">æ„é€ å‡½æ•°</a>ï¼‰ã€‚</p><h3 id="å¯†å°ç±»"><a href="#å¯†å°ç±»" class="headerlink" title="å¯†å°ç±»"></a>å¯†å°ç±»</h3><p>å¯†å°ç±»ç”¨æ¥è¡¨ç¤ºå—é™çš„ç±»ç»§æ‰¿ç»“æ„ï¼šå½“ä¸€ä¸ªå€¼ä¸ºæœ‰é™é›†ä¸­çš„ç±»å‹ã€è€Œä¸èƒ½æœ‰ä»»ä½•å…¶ä»–ç±»å‹æ—¶ã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œä»–ä»¬æ˜¯<a href="#æšä¸¾ç±»">æšä¸¾ç±»</a>çš„æ‰©å±•ï¼šæšä¸¾ç±»å‹çš„å€¼é›†åˆä¹Ÿæ˜¯å—é™çš„ï¼Œä½†æ¯ä¸ªæšä¸¾å¸¸é‡åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹ï¼Œè€Œå¯†å°ç±»çš„ä¸€ä¸ªå­ç±»å¯ä»¥æœ‰å¯åŒ…å«çŠ¶æ€çš„å¤šä¸ªå®ä¾‹ã€‚</p><p>NOTEï¼š <code>sealed</code> ä¸èƒ½ä¿®é¥° interface ,abstract class(ä¼šæŠ¥ warning,ä½†æ˜¯ä¸ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯)</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> kotlinSealedClass = ChildrenKotlinSealedClass()</div><div class="line">    println(eval(kotlinSealedClass))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">sealed</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinSealedClass</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildrenKotlinSealedClass</span> : <span class="type">KotlinSealedClass</span></span>()</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GirlKotlinSealedClass</span> : <span class="type">KotlinSealedClass</span></span>()</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">eval</span><span class="params">(k: <span class="type">KotlinSealedClass</span>)</span></span>: String = <span class="keyword">when</span> (k) &#123;</div><div class="line">    <span class="keyword">is</span> ChildrenKotlinSealedClass -&gt; <span class="string">"ChildrenKotlinSealedClass"</span></div><div class="line">    <span class="keyword">is</span> GirlKotlinSealedClass -&gt; <span class="string">"GirlKotlinSealedClass"</span></div><div class="line">    <span class="comment">//ä¸å†éœ€è¦ else åˆ†æ”¯ å·²ç»è¦†ç›–äº†æ‰€æœ‰çš„æƒ…å†µ</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æšä¸¾ç±»"><a href="#æšä¸¾ç±»" class="headerlink" title="æšä¸¾ç±»"></a>æšä¸¾ç±»</h3><p>æšä¸¾ç±»çš„æœ€åŸºæœ¬çš„ç”¨æ³•æ˜¯å®ç°ç±»å‹å®‰å…¨çš„æšä¸¾, æ¯ä¸ªæšä¸¾å¸¸é‡éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡, éœ€ç”¨é€—å·åˆ†å¼€ã€‚ç¤ºä¾‹å¦‚ä¸‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> (it <span class="keyword">in</span> KotlinEnumClass.Direction.values()) &#123;</div><div class="line">        println(it)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//å¿…é¡»ä¸å£°æ˜æšä¸¾ç±»å‹åç§°ä¸€è‡´, å¦åˆ™æŠ›å‡º IllegalArgumentException å¼‚å¸¸ã€‚</span></div><div class="line">    <span class="keyword">val</span> north = KotlinEnumClass.Direction.valueOf(<span class="string">"NORTH"</span>)</div><div class="line">    println(north === KotlinEnumClass.Direction.NORTH)</div><div class="line"></div><div class="line">    <span class="comment">//æšä¸¾å¸¸é‡éƒ½å…·æœ‰åœ¨æšä¸¾ç±»å£°æ˜ä¸­è·å–å…¶åç§°å’Œä½ç½®çš„å±æ€§</span></div><div class="line">    <span class="keyword">val</span> (name, ordinal) = KotlinEnumClass.Direction.EAST</div><div class="line">    println(<span class="string">"<span class="subst">$name</span> <span class="subst">$ordinal</span>"</span>)</div><div class="line"></div><div class="line"></div><div class="line">    KotlinEnumClass().printAllValues&lt;KotlinEnumClass.ProtocolState&gt;()</div><div class="line">    println()</div><div class="line">    KotlinEnumClass().printValue&lt;KotlinEnumClass.ProtocolState&gt;(<span class="string">"WAITING"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinEnumClass</span> </span>&#123;</div><div class="line">    <span class="comment">//ç±»å‹å®‰å…¨çš„æšä¸¾</span></div><div class="line">    <span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">Direction</span> </span>&#123;</div><div class="line">        NORTH, SOUTH, WEST, EAST;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//æšä¸¾éƒ½æ˜¯æšä¸¾ç±»çš„å®ä¾‹,å¯ä»¥åˆå§‹åŒ–</span></div><div class="line">    <span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">Color</span></span>(<span class="keyword">val</span> rgb: <span class="built_in">Int</span>) &#123;</div><div class="line">        RED(<span class="number">0xFF0000</span>),</div><div class="line">        GREEN(<span class="number">0x00FF00</span>),</div><div class="line">        BLUE(<span class="number">0x0000FF</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//æšä¸¾å¸¸é‡ä¹Ÿå¯ä»¥å£°æ˜è‡ªå·±çš„åŒ¿åç±»</span></div><div class="line">    <span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">ProtocolState</span> </span>&#123;</div><div class="line">        WAITING &#123;</div><div class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">signal</span><span class="params">()</span></span> = TALKING</div><div class="line">        &#125;,</div><div class="line"></div><div class="line">        TALKING &#123;</div><div class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">signal</span><span class="params">()</span></span> = WAITING</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">signal</span><span class="params">()</span></span>: ProtocolState</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//åˆ—å‡ºå®šä¹‰çš„æšä¸¾å¸¸é‡</span></div><div class="line">    <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : Enum&lt;T&gt;</span>&gt; <span class="title">printAllValues</span><span class="params">()</span></span> &#123;</div><div class="line">        print(enumValues&lt;T&gt;().joinToString &#123; it.name &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//é€šè¿‡åç§°è·å–æšä¸¾å¸¸é‡</span></div><div class="line">    <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : Enum&lt;T&gt;</span>&gt; <span class="title">printValue</span><span class="params">(name: <span class="type">String</span>)</span></span> &#123;</div><div class="line">        print(enumValueOf&lt;T&gt;(name))</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æšä¸¾å¸¸é‡è¿˜å®ç°äº† <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-comparable/index.html" target="_blank" rel="external">Comparable</a> æ¥å£ï¼Œ å…¶ä¸­è‡ªç„¶é¡ºåºæ˜¯å®ƒä»¬åœ¨æšä¸¾ç±»ä¸­å®šä¹‰çš„é¡ºåºã€‚</p><p>NOTE: <code>val (name, ordinal) = KotlinEnumClass.Direction.EAST</code>  ä¹‹æ‰€ä»¥å¯ä»¥ç¼–è¯‘é€šè¿‡, å› ä¸ºæˆ‘å¯¹æšä¸¾ç±»è¿›è¡Œ<a href="#è§£æ„å£°æ˜">è§£æ„å£°æ˜</a> </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å­¦è€Œè‡´ç”¨</span></div><div class="line"><span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;E : Enum&lt;E&gt;</span>&gt; Enum<span class="type">&lt;E&gt;</span>.<span class="title">component1</span><span class="params">()</span></span> = <span class="keyword">this</span>.name</div><div class="line"><span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;E : Enum&lt;E&gt;</span>&gt; Enum<span class="type">&lt;E&gt;</span>.<span class="title">component2</span><span class="params">()</span></span> = <span class="keyword">this</span>.ordinal</div></pre></td></tr></table></figure><h3 id="æ³¨è§£ç±»"><a href="#æ³¨è§£ç±»" class="headerlink" title="æ³¨è§£ç±»"></a>æ³¨è§£ç±»</h3><p>å­¦ä¹ Java çš„åº”è¯¥å¯¹æ³¨è§£ä¸é™Œç”Ÿ,ä¸äº†è§£å¯ä»¥å…ˆçœ‹çœ‹<a href="http://wiki.jikexueyuan.com/project/java-reflection/java-at.html" target="_blank" rel="external"> Javaçš„æ³¨è§£</a>ã€‚</p><h4 id="æ³¨è§£å£°æ˜"><a href="#æ³¨è§£å£°æ˜" class="headerlink" title="æ³¨è§£å£°æ˜"></a>æ³¨è§£å£°æ˜</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[è®¿é—®ä¿®é¥°ç¬¦ é»˜è®¤<span class="keyword">public</span>] [éè®¿é—®ä¿®é¥°ç¬¦ é»˜è®¤åªèƒ½ä¸º <span class="keyword">final</span> ä¸èƒ½æ˜¾å¼ä¿®é¥°] <span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> ç±»å </span></div><div class="line">[è®¿é—®ä¿®é¥°ç¬¦ åªèƒ½ä¸º<span class="keyword">public</span>] [ä¸»æ„é€ å‡½æ•° <span class="keyword">constructor</span> å…³é”®å­—å¯æœ‰å¯æ— ] [<span class="keyword">val</span>å‚æ•°]</div></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">internal</span> <span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinFileName</span></span>(<span class="keyword">val</span> name:String)</div></pre></td></tr></table></figure><p>å…è®¸çš„å‚æ•°ç±»å‹æœ‰ï¼š</p><ul><li>å¯¹åº”äº Java åŸç”Ÿç±»å‹çš„ç±»å‹ï¼ˆIntã€ Longç­‰ï¼‰ä»¥åŠå­—ç¬¦ä¸²</li><li>ç±» <code>KClass</code>ã€æšä¸¾</li><li>å…¶ä»–æ³¨è§£</li><li>ä¸Šé¢å·²åˆ—ç±»å‹çš„æ•°ç»„</li></ul><p>NOTE: æ³¨è§£å‚æ•°ä¸èƒ½æœ‰å¯ç©ºç±»å‹ï¼Œå› ä¸º JVM ä¸æ”¯æŒå°† <code>null</code> ä½œä¸ºæ³¨è§£å±æ€§çš„å€¼å­˜å‚¨ã€‚å¦‚æœæ³¨è§£ç”¨ä½œå¦ä¸€ä¸ªæ³¨è§£çš„å‚æ•°ï¼Œåˆ™å…¶åç§°ä¸ä»¥ @ å­—ç¬¦ä¸ºå‰ç¼€, ä¸”æ–°çš„æ³¨è§£ç±»è®¿é—®æƒé™ä¸èƒ½æ¯”å…¶ä¸­ä¸€ä¸ªæ³¨è§£çš„å‚æ•°çš„è®¿é—®æƒé™è¦å¤§</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">internal</span> <span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> <span class="title">FileScope</span> </span></div><div class="line"><span class="keyword">constructor</span>(<span class="meta">@ApplicationScope</span> <span class="keyword">val</span> file: KotlinFileName)</div></pre></td></tr></table></figure><p>æ³¨è§£çš„é™„åŠ å±æ€§å¯ä»¥é€šè¿‡ç”¨å…ƒæ³¨è§£æ ‡æ³¨æ³¨è§£ç±»æ¥æŒ‡å®šï¼š</p><ul><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.annotation/-target/index.html" target="_blank" rel="external"><code>@Target</code></a> æŒ‡å®šå¯ä»¥ç”¨è¯¥æ³¨è§£æ ‡æ³¨çš„å…ƒç´ çš„å¯èƒ½çš„ç±»å‹ï¼ˆç±»ã€å‡½æ•°ã€å±æ€§ã€è¡¨è¾¾å¼ç­‰ï¼‰ï¼›</li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.annotation/-retention/index.html" target="_blank" rel="external"><code>@Retention</code></a> æŒ‡å®šè¯¥æ³¨è§£æ˜¯å¦å­˜å‚¨åœ¨ç¼–è¯‘åçš„ class æ–‡ä»¶ä¸­ï¼Œä»¥åŠå®ƒåœ¨è¿è¡Œæ—¶èƒ½å¦é€šè¿‡åå°„å¯è§ ï¼ˆé»˜è®¤éƒ½æ˜¯ trueï¼‰ï¼›</li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.annotation/-repeatable/index.html" target="_blank" rel="external"><code>@Repeatable</code></a> å…è®¸åœ¨å•ä¸ªå…ƒç´ ä¸Šå¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„è¯¥æ³¨è§£ï¼›</li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.annotation/-must-be-documented/index.html" target="_blank" rel="external"><code>@MustBeDocumented</code></a> æŒ‡å®šè¯¥æ³¨è§£æ˜¯å…¬æœ‰ API çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”åº”è¯¥åŒ…å«åœ¨ç”Ÿæˆçš„ API æ–‡æ¡£ä¸­æ˜¾ç¤ºçš„ç±»æˆ–æ–¹æ³•çš„ç­¾åä¸­ã€‚</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Target(AnnotationTarget.CLASS,</span></div><div class="line">        AnnotationTarget.FILE,</div><div class="line">        AnnotationTarget.FUNCTION,</div><div class="line">        AnnotationTarget.VALUE_PARAMETER,</div><div class="line">        AnnotationTarget.EXPRESSION)</div><div class="line"><span class="meta">@Retention(AnnotationRetention.SOURCE)</span></div><div class="line"><span class="meta">@MustBeDocumented</span></div><div class="line"><span class="keyword">annotation</span> <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationScope</span></span></div></pre></td></tr></table></figure><h4 id="Lambda-è¡¨è¾¾å¼"><a href="#Lambda-è¡¨è¾¾å¼" class="headerlink" title="Lambda è¡¨è¾¾å¼"></a>Lambda è¡¨è¾¾å¼</h4><p>æ³¨è§£ä¹Ÿå¯ä»¥ç”¨äº lambda è¡¨è¾¾å¼ã€‚å®ƒä»¬ä¼šè¢«åº”ç”¨äºç”Ÿæˆ lambda è¡¨è¾¾å¼ä½“çš„ <code>invoke()</code> æ–¹æ³•ä¸Šã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> <span class="title">Anonymous</span></span></div><div class="line"><span class="keyword">val</span> run = <span class="meta">@KotlinAnnotation</span>.Anonymous &#123; println(<span class="string">"run"</span>) &#125;</div></pre></td></tr></table></figure><h4 id="Use-site-Targets-ä½¿ç”¨å¤„-ç›®æ ‡"><a href="#Use-site-Targets-ä½¿ç”¨å¤„-ç›®æ ‡" class="headerlink" title="Use-site Targets (ä½¿ç”¨å¤„ ç›®æ ‡)"></a>Use-site Targets (ä½¿ç”¨å¤„ ç›®æ ‡)</h4><p>å½“å¯¹å±æ€§æˆ–ä¸»æ„é€ å‡½æ•°å‚æ•°è¿›è¡Œæ ‡æ³¨æ—¶ï¼Œä»ç›¸åº”çš„ Kotlin å…ƒç´ ç”Ÿæˆçš„ Java å…ƒç´ ä¼šæœ‰å¤šä¸ªï¼Œå› æ­¤åœ¨ç”Ÿæˆçš„ Java å­—èŠ‚ç ä¸­è¯¥æ³¨è§£æœ‰å¤šä¸ªå¯èƒ½ä½ç½® ã€‚æ”¯æŒçš„ä½¿ç”¨å¤„ç›®æ ‡çš„å®Œæ•´åˆ—è¡¨ä¸ºï¼š</p><ul><li><code>file</code></li><li><code>property</code>ï¼ˆå…·æœ‰æ­¤ç›®æ ‡çš„æ³¨è§£å¯¹ Java ä¸å¯è§ï¼‰</li><li><code>field</code></li><li><code>get</code>ï¼ˆå±æ€§ getterï¼‰</li><li><code>set</code>ï¼ˆå±æ€§ setterï¼‰</li><li><code>receiver</code>ï¼ˆæ‰©å±•å‡½æ•°æˆ–å±æ€§çš„æ¥æ”¶è€…å‚æ•°ï¼‰</li><li><code>param</code>ï¼ˆæ„é€ å‡½æ•°å‚æ•°ï¼‰</li><li><code>setparam</code>ï¼ˆå±æ€§ setter å‚æ•°ï¼‰</li><li><code>delegate</code>ï¼ˆä¸ºå§”æ‰˜å±æ€§å­˜å‚¨å…¶å§”æ‰˜å®ä¾‹çš„å­—æ®µï¼‰</li></ul><p>å¯ä»¥ä½¿ç”¨ç›¸åŒçš„è¯­æ³•æ¥æ³¨é‡Šæ•´ä¸ªæ–‡ä»¶ã€‚è¦æ‰§è¡Œæ­¤æ“ä½œï¼Œè¯·å°†ç›®æ ‡æ–‡ä»¶çš„æ³¨é‡Šæ”¾åœ¨æ–‡ä»¶çš„é¡¶å±‚ï¼Œåœ¨åŒ…æŒ‡ä»¤ä¹‹å‰æˆ–åœ¨æ‰€æœ‰å¯¼å…¥ä¹‹å‰ï¼Œå¦‚æœæ–‡ä»¶ä½äºé»˜è®¤åŒ…ä¸­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@file:JvmName</span>(<span class="string">"KotlinAnnotationKt"</span>)</div><div class="line"></div><div class="line"><span class="keyword">package</span> demo</div></pre></td></tr></table></figure><p>å¦‚æœè¦æŒ‡å®šç²¾ç¡®åœ°æŒ‡å®šåº”è¯¥å¦‚ä½•ç”Ÿæˆè¯¥æ³¨è§£ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@å¤„ç›®æ ‡å…ƒç´ :[æ³¨è§£A æ³¨è§£B ] ... <span class="comment">//åŒä¸€ç›®æ ‡åªæœ‰1ä¸ªæ³¨è§£æ—¶æ–¹æ‹¬å·å¯ä»¥çœç•¥</span></div></pre></td></tr></table></figure><p>ç®€å•ç¤ºä¾‹å¦‚ä¸‹:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>(<span class="meta">@field:FieldScope</span> <span class="keyword">val</span> name: String, <span class="meta">@get:</span>[ApplicationScope FunScope] <span class="keyword">val</span> age: <span class="built_in">Int</span>)</div></pre></td></tr></table></figure><p>å¦‚æœä¸æŒ‡å®šä½¿ç”¨å¤„ç›®æ ‡ï¼Œåˆ™æ ¹æ®æ­£åœ¨ä½¿ç”¨çš„æ³¨è§£çš„ <code>@Target</code> æ³¨è§£æ¥é€‰æ‹©ç›®æ ‡ ã€‚</p><h4 id="Java-æ³¨è§£"><a href="#Java-æ³¨è§£" class="headerlink" title="Java æ³¨è§£"></a>Java æ³¨è§£</h4><p>Java æ³¨è§£ä¸ Kotlin 100% å…¼å®¹ï¼š</p><p>kotlin</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å£°æ˜æ³¨è§£</span></div><div class="line"><span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> <span class="title">Targets</span></span>(<span class="keyword">vararg</span> <span class="keyword">val</span> value: KClass&lt;*&gt;)</div><div class="line"><span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> <span class="title">TargetArrays</span></span>(<span class="keyword">val</span> value: Array&lt;KClass&lt;*&gt;&gt;)</div><div class="line"></div><div class="line"><span class="meta">@JavaAnnotation</span>.Describe(<span class="string">"see"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">See</span></span></div><div class="line"><span class="meta">@JavaAnnotation</span>.SinceJava(name = <span class="string">"jdk"</span>, version = <span class="number">1</span>_8_0)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">JDK</span></span></div><div class="line"><span class="meta">@JavaAnnotation</span>.Targets(Any::<span class="class"><span class="keyword">class</span>, <span class="type">String::class)</span></span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Targets</span></span></div><div class="line"><span class="meta">@JavaAnnotation</span>.Targets(*arrayOf(Any::<span class="class"><span class="keyword">class</span>, <span class="type">String::class))</span></span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Targets2</span></span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">printId</span><span class="params">(intId: <span class="type">JavaAnnotation</span>.<span class="type">IntId</span>)</span></span> &#123;</div><div class="line">    println(intId.value)</div><div class="line">&#125;</div><div class="line"><span class="meta">@JavaAnnotation</span>.IntId(<span class="built_in">Int</span>.MAX_VALUE)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Res</span></span></div><div class="line">printId(Res::<span class="class"><span class="keyword">class</span>.<span class="title">annotations</span>[0] <span class="title">as</span> <span class="title">JavaAnnotation</span>.<span class="title">IntId</span>)</span></div></pre></td></tr></table></figure><p>java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@KotlinAnnotation</span>.ApplicationScope</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaAnnotation</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Class clazz = Class.forName(<span class="string">"jsource.JavaAnnotation"</span>);</div><div class="line">            Annotation annotation = clazz.getAnnotation(KotlinAnnotation.ApplicationScope.class);</div><div class="line">            System.out.println(annotation);</div><div class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@KotlinAnnotation</span>.Targets(&#123;String.class, Integer.class&#125;)</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TargetClass</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@KotlinAnnotation</span>.TargetArrays(&#123;String.class, Integer.class&#125;)</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TargetArrays</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> Describe &#123;</div><div class="line">        <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> SinceJava &#123;</div><div class="line">        <span class="function">String <span class="title">name</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">int</span> <span class="title">version</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> Targets &#123;</div><div class="line">        Class[] value();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> IntId &#123;</div><div class="line">        <span class="function"><span class="keyword">int</span> <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> -1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h3><p>ä¸ Java ç±»ä¼¼ï¼ŒKotlin ä¸­çš„æ³›å‹,å¦‚ä¸‹ç¤ºä¾‹:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">val</span> emptyListString = List&lt;String&gt;()</div><div class="line">    <span class="keyword">val</span> listString = List(<span class="string">"C"</span>, <span class="string">"D"</span>)</div><div class="line">    assertEquals(<span class="number">0</span>, emptyListString.size, <span class="string">"empty"</span>)</div><div class="line">    printList(listString)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ³›å‹ç±»</span></div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">List</span>&lt;<span class="type">T</span>&gt;</span>(<span class="keyword">vararg</span> elements: T) : Iterable&lt;T&gt; &#123;</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">iterator</span><span class="params">()</span></span>: Iterator&lt;T&gt; &#123;</div><div class="line">        <span class="keyword">return</span> elementsArray.iterator()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">val</span> elementsArray = mutableListOf(*elements)</div><div class="line"></div><div class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(index: <span class="type">Int</span>)</span></span>: T = elementsArray[index]</div><div class="line"></div><div class="line">    <span class="keyword">val</span> size: <span class="built_in">Int</span> = elementsArray.size</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ³›å‹æ–¹æ³• printList</span></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;E&gt;</span> <span class="title">printList</span><span class="params">(inputList: <span class="type">List</span>&lt;<span class="type">E</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> (element <span class="keyword">in</span> inputList) &#123;</div><div class="line">        println(<span class="string">"<span class="subst">$element</span> "</span>)</div><div class="line">    &#125;</div><div class="line">    println()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸ Java ä¸åŒï¼ŒKotlin ä¸­çš„æ³›å‹æ²¡æœ‰é€šé…ç¬¦ç±»å‹ï¼Œå®ƒæœ‰ï¼šå£°æ˜å¤„å‹å˜ï¼ˆdeclaration-site varianceï¼‰ä¸ç±»å‹æŠ•å½±ï¼ˆtype projectionsï¼‰ã€‚</p><h4 id="å‹å˜"><a href="#å‹å˜" class="headerlink" title="å‹å˜"></a>å‹å˜</h4><p>Java ä¸­çš„æ³›å‹æ˜¯<strong>ä¸å‹å˜çš„</strong>ï¼Œè¿™æ„å‘³ç€ <code>List&lt;String&gt;</code> å¹¶<strong>ä¸æ˜¯</strong><code>List&lt;Object&gt;</code> çš„å­ç±»å‹ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; strs = new ArrayList&lt;String&gt;();</div><div class="line">List&lt;Object&gt; objs =(List) strs;</div><div class="line">objs.add(<span class="number">1</span>);</div><div class="line">String s = strs.<span class="keyword">get</span>(<span class="number">0</span>); <span class="comment">// ï¼ï¼ï¼ ClassCastExceptionï¼šæ— æ³•å°†æ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></div></pre></td></tr></table></figure><p>PECSåŸåˆ™,åœ¨Java <code>&lt;? extends T&gt;ã€&lt;? super T&gt;</code> <strong>é€šé…ç¬¦ç±»å‹å‚æ•°</strong>,å‰è€…åªèƒ½è¯»å–, ä¸èƒ½å†™å…¥,åè€…åä¹‹ã€‚ä¾¿æœ‰ä¸€æ¡è§„å¾‹ï¼Œâ€Producer Extends, Consumer Superâ€ï¼š</p><ul><li><code>Producer Extends</code> â€“ å¦‚æœä½ éœ€è¦ä¸€ä¸ªåªè¯»Listï¼Œç”¨å®ƒæ¥produce Tï¼Œé‚£ä¹ˆä½¿ç”¨<code>? extends T</code>ã€‚</li><li><code>Consumer Super</code> â€“ å¦‚æœä½ éœ€è¦ä¸€ä¸ªåªå†™Listï¼Œç”¨å®ƒæ¥consume Tï¼Œé‚£ä¹ˆä½¿ç”¨<code>? super T</code>ã€‚</li><li>å¦‚æœéœ€è¦åŒæ—¶è¯»å–ä»¥åŠå†™å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨é€šé…ç¬¦äº†ã€‚</li></ul><p>åŒæ ·PECSåŸåˆ™é€‚ç”¨äº Kotlin:</p><ul><li><code>Producer Extends</code> â€“  ä½¿å¾—ç±»å‹æ˜¯<strong>åå˜çš„ï¼ˆcovariantï¼‰</strong>ã€‚</li><li><code>Consumer Super</code> â€“  ä½¿å¾—ç±»å‹æ˜¯<strong>é€†å˜æ€§ï¼ˆcontravarianceï¼‰</strong>ã€‚</li></ul><p>NOTE: <em>PECS ä»£è¡¨ç”Ÿäº§è€…-Extensï¼Œæ¶ˆè´¹è€…-Superï¼ˆProducer-Extends, Consumer-Superï¼‰ã€‚</em>ä¸€ä¸ªç”Ÿäº§è€…å¯¹è±¡ï¼Œåªæ˜¯ä¿è¯<strong>ç±»å‹å®‰å…¨</strong>ã€‚</p><h4 id="å£°æ˜å¤„å‹å˜"><a href="#å£°æ˜å¤„å‹å˜" class="headerlink" title="å£°æ˜å¤„å‹å˜"></a>å£°æ˜å¤„å‹å˜</h4><p>Java ä¸­<code>List&lt;String&gt;</code> ä¸èƒ½ç›´æ¥èµ‹å€¼<code>List&lt;Object&gt;</code> ,åœ¨ Kotlin ä¸­ï¼Œæä¾› <strong>out</strong> ä¿®é¥°ç¬¦ç¡®ä¿æ¥å£æˆ–ç±»æˆå‘˜ä¸­<strong>è¿”å›</strong><code>out</code>ï¼ˆç”Ÿäº§ï¼‰ï¼Œå¹¶ä»ä¸è¢« <code>in</code> (æ¶ˆè´¹)ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> stringList = listOf&lt;String&gt;()</div><div class="line"><span class="keyword">val</span> anyList: List&lt;Any&gt; = stringList</div></pre></td></tr></table></figure><p>kotlin List æ¥å£å£°æ˜:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">List</span>&lt;<span class="type">out E</span>&gt; : <span class="type">Collection</span>&lt;<span class="type">E</span>&gt;</span></div></pre></td></tr></table></figure><p><strong>in</strong>ã€‚å®ƒä½¿å¾—ä¸€ä¸ªç±»å‹å‚æ•°<strong>é€†å˜</strong>ï¼šåªå¯ä»¥è¢«æ¶ˆè´¹è€Œä¸å¯ä»¥è¢«ç”Ÿäº§ã€‚é€†å˜ç±»çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ <code>Comparable</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">abstract class Comparable&lt;in T&gt; &#123;</div><div class="line">    abstract fun compareTo(other: T): Int</div><div class="line">&#125;</div><div class="line"></div><div class="line">fun demo(x: Comparable&lt;Number&gt;) &#123;</div><div class="line">    x.compareTo(1.0) // 1.0 æ‹¥æœ‰ç±»å‹ Doubleï¼Œå®ƒæ˜¯ Number çš„å­ç±»å‹</div><div class="line">    // å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°† x èµ‹ç»™ç±»å‹ä¸º Comparable &lt;Double&gt; çš„å˜é‡</div><div class="line">    val y: Comparable&lt;Double&gt; = x // OKï¼</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç±»å‹å‚æ•° <code>T</code> è¢«å£°æ˜ä¸º <strong>out</strong> æ—¶ï¼Œè™½ç„¶ <code>**&lt;Base&gt;</code> å¯ä»¥å®‰å…¨åœ°ä½œä¸º <code>**&lt;Derived&gt;</code>çš„è¶…ç±», å°±åªèƒ½å‡ºç°<strong>è¾“å‡º</strong>-ä½ç½®ã€‚</p><p>å› ä¸ºå®ƒåœ¨ç±»å‹å‚æ•°å£°æ˜å¤„æä¾›ï¼Œæ‰€ä»¥è¢«ç§°åš<strong>å£°æ˜å¤„å‹å˜</strong>ã€‚ è¿™ä¸ Java çš„<strong>ä½¿ç”¨å¤„å‹å˜</strong>ç›¸åï¼Œå…¶ç±»å‹ç”¨é€”é€šé…ç¬¦ä½¿å¾—ç±»å‹åå˜ã€‚<strong>in</strong> åä¹‹ã€‚</p><p><strong>NOTEï¼šæ¶ˆè´¹è€… in, ç”Ÿäº§è€… out </strong></p><h4 id="ç±»å‹æŠ•å½±-ä½¿ç”¨å¤„å‹å˜"><a href="#ç±»å‹æŠ•å½±-ä½¿ç”¨å¤„å‹å˜" class="headerlink" title="ç±»å‹æŠ•å½± (ä½¿ç”¨å¤„å‹å˜)"></a>ç±»å‹æŠ•å½± (ä½¿ç”¨å¤„å‹å˜)</h4><p>å°†ç±»å‹å‚æ•° T å£°æ˜ä¸º <strong>out</strong> éå¸¸æ–¹ä¾¿ï¼Œå¹¶ä¸”èƒ½é¿å…ä½¿ç”¨å¤„å­ç±»å‹åŒ–çš„éº»çƒ¦ï¼Œä½†æ˜¯æœ‰äº›ç±»å®é™…ä¸Š<strong>ä¸èƒ½</strong>é™åˆ¶ä¸ºåªè¿”å› <code>T</code>  æ¯”å¦‚ Arrayï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> ints: Array&lt;<span class="keyword">out</span> <span class="built_in">Int</span>&gt; = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="keyword">val</span> any = Array&lt;Any&gt;(<span class="number">3</span>) &#123; <span class="string">""</span> &#125;</div><div class="line"><span class="comment">//out ç”Ÿäº§è€… ç›¸å½“äºJava ? extends T</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">copy</span><span class="params">(from: <span class="type">Array</span>&lt;<span class="type">out</span> <span class="type">Any</span>&gt;, to: <span class="type">Array</span>&lt;<span class="type">Any</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> from.indices) &#123;</div><div class="line">        to[index] = from[index]</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">copy(from = ints, to = any)</div><div class="line"><span class="keyword">for</span> (items <span class="keyword">in</span> any) &#123;</div><div class="line">    println(items)</div><div class="line">&#125;</div><div class="line"><span class="comment">//out æ¶ˆè´¹è€… ç›¸å½“äºJava ? super T</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">fill</span><span class="params">(dest: <span class="type">Array</span>&lt;<span class="type">in</span> <span class="type">Int</span>&gt;, value: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> dest.indices) &#123;</div><div class="line">        dest[index] = (dest[index] <span class="keyword">as</span>? <span class="built_in">Int</span>)!!.times(value)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">fill(any, <span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (items <span class="keyword">in</span> any) &#123;</div><div class="line">    println(items)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸Šé¢<strong>out in ç±»å‹æŠ•å½±</strong>, ä¹Ÿå°±æ˜¯Java çš„ä½¿ç”¨å¤„å‹å˜ <code>? [extends][super] T</code> </p><h4 id="æ˜ŸæŠ•å½±"><a href="#æ˜ŸæŠ•å½±" class="headerlink" title="æ˜ŸæŠ•å½±"></a>æ˜ŸæŠ•å½±</h4><p>è‹¥ç±»å‹å‚æ•°ä¸€æ— æ‰€çŸ¥ï¼Œä½†ä»ç„¶å¸Œæœ›ä»¥å®‰å…¨çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚ è¿™é‡Œçš„å®‰å…¨æ–¹å¼æ˜¯å®šä¹‰æ³›å‹ç±»å‹çš„è¿™ç§æŠ•å½±ï¼Œè¯¥æ³›å‹ç±»å‹çš„æ¯ä¸ªå…·ä½“å®ä¾‹åŒ–å°†æ˜¯è¯¥æŠ•å½±çš„å­ç±»å‹ã€‚</p><p>Kotlin ä¸ºæ­¤æä¾›äº†æ‰€è°“çš„<strong>æ˜ŸæŠ•å½±</strong>è¯­æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> star: List&lt;*&gt; = listOf(<span class="string">"C"</span>, <span class="string">"D"</span>, <span class="number">1</span>, <span class="number">2</span>)</div><div class="line"><span class="keyword">val</span> any1: Any? = star[<span class="number">0</span>]</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">compareTo2</span><span class="params">(x: <span class="type">Comparable</span>&lt;*&gt;)</span></span></div></pre></td></tr></table></figure><ul><li>å¯¹äº <code>Foo &lt;out T&gt;</code>ï¼Œå…¶ä¸­ <code>T</code> æ˜¯ä¸€ä¸ªå…·æœ‰ä¸Šç•Œ <code>TUpper</code> çš„åå˜ç±»å‹å‚æ•°ï¼Œ<code>Foo &lt;*&gt;</code> ç­‰ä»·äº <code>Foo &lt;out TUpper&gt;</code>ã€‚ è¿™æ„å‘³ç€å½“ <code>T</code> æœªçŸ¥æ—¶ï¼Œä½ å¯ä»¥å®‰å…¨åœ°ä» <code>Foo &lt;*&gt;</code> <em>è¯»å–</em> <code>TUpper</code> çš„å€¼ã€‚</li><li>å¯¹äº <code>Foo &lt;in T&gt;</code>ï¼Œå…¶ä¸­ <code>T</code> æ˜¯ä¸€ä¸ªé€†å˜ç±»å‹å‚æ•°ï¼Œ<code>Foo &lt;*&gt;</code> ç­‰ä»·äº <code>Foo &lt;in Nothing&gt;</code>ã€‚ è¿™æ„å‘³ç€å½“ <code>T</code> æœªçŸ¥æ—¶ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥ä»¥å®‰å…¨çš„æ–¹å¼<em>å†™å…¥</em> <code>Foo &lt;*&gt;</code>ã€‚</li><li>å¯¹äº <code>Foo &lt;T&gt;</code>ï¼Œå…¶ä¸­ <code>T</code> æ˜¯ä¸€ä¸ªå…·æœ‰ä¸Šç•Œ <code>TUpper</code> çš„ä¸å‹å˜ç±»å‹å‚æ•°ï¼Œ<code>Foo&lt;*&gt;</code> å¯¹äºè¯»å–å€¼æ—¶ç­‰ä»·äº <code>Foo&lt;out TUpper&gt;</code> è€Œå¯¹äºå†™å€¼æ—¶ç­‰ä»·äº <code>Foo&lt;in Nothing&gt;</code>ã€‚</li></ul><p>å¦‚æœæ³›å‹ç±»å‹å…·æœ‰å¤šä¸ªç±»å‹å‚æ•°ï¼Œåˆ™æ¯ä¸ªç±»å‹å‚æ•°éƒ½å¯ä»¥å•ç‹¬æŠ•å½±ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœç±»å‹è¢«å£°æ˜ä¸º <code>interface Function &lt;in T, out U&gt;</code>ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä»¥ä¸‹æ˜ŸæŠ•å½±ï¼š</p><ul><li><code>Function&lt;*, String&gt;</code> è¡¨ç¤º <code>Function&lt;in Nothing, String&gt;</code>ï¼›</li><li><code>Function&lt;Int, *&gt;</code> è¡¨ç¤º <code>Function&lt;Int, out Any?&gt;</code>ï¼›</li><li><code>Function&lt;*, *&gt;</code> è¡¨ç¤º <code>Function&lt;in Nothing, out Any?&gt;</code>ã€‚</li></ul><p><em>æ³¨æ„</em>ï¼šæ˜ŸæŠ•å½±éå¸¸åƒ Java çš„åŸå§‹ç±»å‹ï¼Œä½†æ˜¯å®‰å…¨ã€‚</p><h4 id="æ³›å‹çº¦æŸ"><a href="#æ³›å‹çº¦æŸ" class="headerlink" title="æ³›å‹çº¦æŸ"></a>æ³›å‹çº¦æŸ</h4><p>èƒ½å¤Ÿæ›¿æ¢ç»™å®šç±»å‹å‚æ•°çš„æ‰€æœ‰å¯èƒ½ç±»å‹çš„é›†åˆå¯ä»¥ç”±<strong>æ³›å‹çº¦æŸ</strong>é™åˆ¶ã€‚</p><p>æœ€å¸¸è§çš„çº¦æŸç±»å‹æ˜¯ä¸ Java çš„ <em>extends</em> å…³é”®å­—å¯¹åº”çš„ <strong>ä¸Šç•Œ</strong>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : Number&gt;</span> <span class="title">add</span><span class="params">(t: <span class="type">T</span>)</span></span> &#123;</div><div class="line">    <span class="comment">// â€¦â€¦</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">add(<span class="number">1</span>)</div><div class="line">add(<span class="string">""</span>) <span class="comment">//not allow</span></div></pre></td></tr></table></figure><p>é»˜è®¤çš„ä¸Šç•Œï¼ˆå¦‚æœæ²¡æœ‰å£°æ˜ï¼‰æ˜¯ <code>Any?</code>ã€‚åœ¨å°–æ‹¬å·ä¸­åªèƒ½æŒ‡å®šä¸€ä¸ªä¸Šç•Œã€‚ å¦‚æœåŒä¸€ç±»å‹å‚æ•°éœ€è¦å¤šä¸ªä¸Šç•Œï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå•ç‹¬çš„ <strong>where</strong>-å­å¥ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">cloneWhenGreater</span><span class="params">(t: <span class="type">T</span>)</span></span></div><div class="line">        where T : Number,</div><div class="line">              <span class="comment">//              T : String, åªæŒ‡å®šä¸€ä¸ªclass ,æ¥å£å¯ä»¥å¤šä¸ª</span></div><div class="line">              T : kotlin.Comparable&lt;T&gt;,</div><div class="line">              T : Cloneable &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><p>Kotlin åŒ C# å’Œ Gosu ç±»ä¼¼ï¼Œèƒ½å¤Ÿæ‰©å±•ä¸€ä¸ªç±»çš„æ–°åŠŸèƒ½è€Œæ— éœ€ç»§æ‰¿è¯¥ç±»æˆ–ä½¿ç”¨åƒè£…é¥°è€…è¿™æ ·çš„ä»»ä½•ç±»å‹çš„è®¾è®¡æ¨¡å¼ã€‚ è¿™é€šè¿‡å«åš <strong>æ‰©å±•</strong> çš„ç‰¹æ®Šå£°æ˜å®Œæˆã€‚Kotlin æ”¯æŒ <strong>æ‰©å±•å‡½æ•°</strong> å’Œ <strong>æ‰©å±•å±æ€§</strong>ã€‚</p><h4 id="æ‰©å±•å‡½æ•°å’Œå±æ€§"><a href="#æ‰©å±•å‡½æ•°å’Œå±æ€§" class="headerlink" title="æ‰©å±•å‡½æ•°å’Œå±æ€§"></a>æ‰©å±•å‡½æ•°å’Œå±æ€§</h4><p>å£°æ˜ä¸€ä¸ªæ‰©å±•å‡½æ•°å’Œå±æ€§ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ª <strong>æ¥æ”¶è€…ç±»å‹</strong> ä¹Ÿå°±æ˜¯è¢«æ‰©å±•çš„ç±»å‹æ¥ä½œä¸ºä»–çš„å‰ç¼€ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">KotlinExtension</span> </span>&#123;</div><div class="line">    <span class="comment">//æˆå‘˜å‡½æ•°æ¯”æ‰©å±•å‡½æ•°ä¼˜å…ˆ</span></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">member</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"call#member"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">fileName</span><span class="params">()</span></span>: String &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"KotlinExtension.class"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">companion</span> <span class="keyword">object</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ‰©å±•çš„å¯¹è±¡ç±»å‹ KotlinExtension</span></div><div class="line"><span class="function"><span class="keyword">fun</span> KotlinExtension.<span class="title">extensionFun</span><span class="params">()</span></span> &#123;</div><div class="line">    println(<span class="string">"this@<span class="subst">$&#123;this&#125;</span> call#extensionFun"</span>) <span class="comment">//</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> KotlinExtension.<span class="title">member</span><span class="params">()</span></span> &#123;</div><div class="line">    println(<span class="string">"call#extension"</span>) <span class="comment">//</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ¥æ”¶è€…ç±»å‹è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ³›å‹ è¦åœ¨å‡½æ•°åå‰å£°æ˜æ³›å‹å‚æ•°</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;E&gt;</span> List<span class="type">&lt;E&gt;</span>.<span class="title">addAll</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ‰©å±•å±æ€§(Extension Property)  å®é™…æ‰©å±•get* å‡½æ•°è€Œå·²</span></div><div class="line"><span class="keyword">val</span> KotlinExtension.fileName</div><div class="line">    <span class="keyword">get</span>() = <span class="string">"KotlinExtension.kt"</span></div></pre></td></tr></table></figure><p>NOTE: <strong>this</strong> å…³é”®å­—åœ¨æ‰©å±•å‡½æ•°å†…éƒ¨å¯¹åº”åˆ°æ¥æ”¶è€…å¯¹è±¡ï¼ˆä¼ è¿‡æ¥çš„åœ¨ç‚¹ç¬¦å·å‰çš„å¯¹è±¡ï¼‰</p><h4 id="å¯ç©ºæ¥æ”¶è€…"><a href="#å¯ç©ºæ¥æ”¶è€…" class="headerlink" title="å¯ç©ºæ¥æ”¶è€…"></a>å¯ç©ºæ¥æ”¶è€…</h4><p>å¯ç©ºçš„æ¥æ”¶è€…ç±»å‹ä¹Ÿèƒ½å®šä¹‰æ‰©å±•ï¼Œåœ¨å¯¹è±¡å˜é‡ä¸Šè°ƒç”¨å€¼ä¸º nullæ—¶ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‡½æ•°ä½“å†…æ£€æµ‹ <code>this == null</code>ï¼Œ</p><p>æ£€æµ‹å‘ç”Ÿåœ¨æ‰©å±•å‡½æ•°çš„å†…éƒ¨ã€‚æœ€å¥½çš„ä¾‹å­,å¦‚ Library.ktä¸­:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> Any?.<span class="title">toString</span><span class="params">()</span></span>: String</div></pre></td></tr></table></figure><h4 id="ä¼´ç”Ÿå¯¹è±¡çš„æ‰©å±•"><a href="#ä¼´ç”Ÿå¯¹è±¡çš„æ‰©å±•" class="headerlink" title="ä¼´ç”Ÿå¯¹è±¡çš„æ‰©å±•"></a>ä¼´ç”Ÿå¯¹è±¡çš„æ‰©å±•</h4><p>ä¼´ç”Ÿå¯¹è±¡çš„æ‰©å±•å’Œå®šä¹‰æ‰©å±•å‡½æ•°å’Œå±æ€§ä¸€è‡´:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> KotlinExtension.Companion.anProperty: <span class="built_in">Int</span> <span class="keyword">get</span>() = <span class="number">1</span></div><div class="line"><span class="function"><span class="keyword">fun</span> KotlinExtension.Companion.<span class="title">extensionFun</span><span class="params">()</span></span> &#123;</div><div class="line">    println(<span class="string">"call#Companion.extensionFun"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="æ‰©å±•çš„ä½œç”¨åŸŸ"><a href="#æ‰©å±•çš„ä½œç”¨åŸŸ" class="headerlink" title="æ‰©å±•çš„ä½œç”¨åŸŸ"></a>æ‰©å±•çš„ä½œç”¨åŸŸ</h4><p>å¤§å¤šæ•°åœ¨é¡¶å±‚å®šä¹‰æ‰©å±•ï¼Œè¦ä½¿ç”¨æ‰€å®šä¹‰åŒ…ä¹‹å¤–çš„ä¸€ä¸ªæ‰©å±•ï¼Œå¯¼åŒ…å°±å¯ä»¥ä½¿ç”¨å®ƒã€‚ç±»å†…éƒ¨ä¹Ÿå¯ä»¥å£°æ˜æ‰©å±•ï¼ˆæˆ‘è®¤ä¸ºè¿™å¹¶æ— åµç”¨ï¼‰åœ¨è¿™æ ·çš„æ‰©å±•å†…éƒ¨ï¼Œè¯¥ç±»çš„å¯¹è±¡å’Œæ¥æ”¶è€…çš„å¯¹è±¡æˆå‘˜ï¼Œè‡ªç”±è®¿é—®ã€‚æ‰©å±•å£°æ˜æ‰€åœ¨çš„ç±»çš„å®ä¾‹ç§°ä¸º <strong>åˆ†å‘æ¥æ”¶è€…</strong>ï¼Œæ‰©å±•æ–¹æ³•è°ƒç”¨æ‰€åœ¨çš„æ¥æ”¶è€…ç±»å‹çš„å®ä¾‹ç§°ä¸º <strong>æ‰©å±•æ¥æ”¶è€…</strong>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">KotlinInteriorExtension</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">start</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"call#start"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> KotlinExtension.<span class="title">stop</span><span class="params">()</span></span>&#123;</div><div class="line">        start()</div><div class="line">        member() <span class="comment">//æ‰©å±•å£°æ˜ä¸ºæˆå‘˜æ—¶ æ‰©å±•å‡½æ•°ä¼˜å…ˆ</span></div><div class="line">        <span class="keyword">this</span><span class="symbol">@KotlinInteriorExtension</span>.member() <span class="comment">//ä½¿ç”¨ é™å®šthis</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">member</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"call#member"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="æ‰©å±•æ˜¯é™æ€è§£æçš„"><a href="#æ‰©å±•æ˜¯é™æ€è§£æçš„" class="headerlink" title="æ‰©å±•æ˜¯é™æ€è§£æçš„"></a>æ‰©å±•æ˜¯é™æ€è§£æçš„</h4><p>è°¨è®°æ‰©å±•ä¸èƒ½çœŸæ­£çš„ä¿®æ”¹ä»–ä»¬æ‰€æ‰©å±•çš„ç±»ï¼Œ ä»…ä»…æ˜¯å¯ä»¥é€šè¿‡è¯¥ç±»å‹çš„å˜é‡ç”¨ç‚¹è¡¨è¾¾å¼å»è°ƒç”¨è¿™ä¸ªæ–°å‡½æ•°ã€‚</p><p>æ‰©å±•å‡½æ•°æ˜¯é™æ€åˆ†å‘çš„ï¼Œæ˜¯ç”±å‡½æ•°è°ƒç”¨æ‰€åœ¨çš„è¡¨è¾¾å¼çš„ç±»å‹æ¥å†³å®šã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ‰©å±•æ˜¯é™æ€è§£æçš„</span></div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">LocalBookmark</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CloudBookmark</span> : <span class="type">LocalBookmark</span></span>()</div><div class="line"></div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">LocalBookmarkManage</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> LocalBookmark.<span class="title">sync</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"syncToCloud"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> CloudBookmark.<span class="title">sync</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"syncFromCloud"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">syncLocal</span><span class="params">(localBookmark: <span class="type">LocalBookmark</span>)</span></span> &#123;</div><div class="line">        localBookmark.sync()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CloudBookmarkManage</span> : <span class="type">LocalBookmarkManage</span></span>() &#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> LocalBookmark.<span class="title">sync</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"syncFromLocal"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> CloudBookmark.<span class="title">sync</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"syncToLocal"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//run</span></div><div class="line">LocalBookmarkManage().syncLocal(localBookmark) <span class="comment">//è¾“å‡º syncToCloud</span></div><div class="line">CloudBookmarkManage().syncLocal(cloudBookmark) <span class="comment">//è¾“å‡º syncFromLocal â€”â€” åˆ†å‘æ¥æ”¶è€…è™šæ‹Ÿè§£æ</span></div><div class="line"></div><div class="line">LocalBookmarkManage().syncLocal(cloudBookmark)<span class="comment">//è¾“å‡º syncToCloud â€”â€” æ‰©å±•æ¥æ”¶è€…é™æ€è§£æ</span></div><div class="line">CloudBookmarkManage().syncLocal(localBookmark)<span class="comment">//è¾“å‡º syncFromLocal â€”â€” åˆ†å‘æ¥æ”¶è€…è™šæ‹Ÿè§£æ</span></div></pre></td></tr></table></figure><p>å‡½æ•°çš„åˆ†å‘å¯¹äºåˆ†å‘æ¥æ”¶è€…ç±»å‹æ˜¯è™šæ‹Ÿçš„ï¼Œä½†å¯¹äºæ‰©å±•æ¥æ”¶è€…ç±»å‹ä¸€å®šæ˜¯é™æ€çš„ã€‚</p><h3 id="å§”æ‰˜"><a href="#å§”æ‰˜" class="headerlink" title="å§”æ‰˜"></a>å§”æ‰˜</h3><p>kotlin æ”¯æŒå§”æ‰˜ç±»å’Œå±æ€§, ä½¿ç”¨å…³é”®å­— <code>by</code> . </p><h4 id="ç±»å§”æ‰˜"><a href="#ç±»å§”æ‰˜" class="headerlink" title="ç±»å§”æ‰˜"></a>ç±»å§”æ‰˜</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Printer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span></div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPrinter</span> : <span class="type">Printer &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"ColorPrinter#print"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlackPrinter</span> : <span class="type">Printer &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"BlackPrinter#print"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultipurposePrinter</span></span>(<span class="keyword">val</span> printer: Printer) : Printer <span class="keyword">by</span> printer &#123;</div><div class="line">    <span class="comment">//å¯è¦†ç›– , ä¸è¦†ç›–è½¬å‘printer print æ–¹æ³•</span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> &#123;</div><div class="line">        printer.print()</div><div class="line">        println(<span class="string">"override#print"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    MultipurposePrinter(ColorPrinter()).print()</div><div class="line">    MultipurposePrinter(BlackPrinter()).print()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>by xxa</code> -å­å¥è¡¨ç¤º<code>xxa</code> å°†ä¼šåœ¨ ç±»ä¸­å†…éƒ¨å­˜å‚¨ã€‚ å¹¶ä¸”ç¼–è¯‘å™¨å°†ç”Ÿæˆè½¬å‘ç»™ <code>xxa</code> çš„æ‰€æœ‰æˆå‘˜å‡½æ•°ã€‚</p><h4 id="å§”æ‰˜å±æ€§"><a href="#å§”æ‰˜å±æ€§" class="headerlink" title="å§”æ‰˜å±æ€§"></a>å§”æ‰˜å±æ€§</h4><p>kotlin æ ‡å‡†åº“å®ç°å¦‚ä¸‹å¸¸è§çš„å±æ€§ç±»å‹:</p><ul><li>å»¶è¿Ÿå±æ€§ï¼ˆlazy propertiesï¼‰: å…¶å€¼åªåœ¨é¦–æ¬¡è®¿é—®æ—¶è®¡ç®—ï¼Œ</li><li>å¯è§‚å¯Ÿå±æ€§ï¼ˆobservable propertiesï¼‰: ç›‘å¬å™¨ä¼šæ”¶åˆ°æœ‰å…³æ­¤å±æ€§å˜æ›´çš„é€šçŸ¥ï¼Œ</li><li>æŠŠå¤šä¸ªå±æ€§å‚¨å­˜åœ¨ä¸€ä¸ªæ˜ å°„ï¼ˆmapï¼‰ä¸­ï¼Œè€Œä¸æ˜¯æ¯ä¸ªå­˜åœ¨å•ç‹¬çš„å­—æ®µä¸­ã€‚</li></ul><h5 id="å»¶è¿Ÿå±æ€§-Lazy"><a href="#å»¶è¿Ÿå±æ€§-Lazy" class="headerlink" title="å»¶è¿Ÿå±æ€§ Lazy"></a>å»¶è¿Ÿå±æ€§ Lazy</h5><p><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/lazy.html" target="_blank" rel="external"><code>lazy()</code></a> æ˜¯æ¥å—ä¸€ä¸ª lambda å¹¶è¿”å›ä¸€ä¸ª <code>Lazy &lt;T&gt;</code> å®ä¾‹çš„å‡½æ•°ï¼Œè¿”å›çš„å®ä¾‹å¯ä»¥ä½œä¸ºå®ç°å»¶è¿Ÿå±æ€§çš„å§”æ‰˜ï¼š ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>get()</code> ä¼šæ‰§è¡Œå·²ä¼ é€’ç»™ <code>lazy()</code> çš„ lambda è¡¨è¾¾å¼å¹¶è®°å½•ç»“æœï¼Œ åç»­è°ƒç”¨ <code>get()</code> åªæ˜¯è¿”å›è®°å½•çš„ç»“æœã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äº lazy å±æ€§çš„æ±‚å€¼æ˜¯<strong>åŒæ­¥é”çš„ï¼ˆsynchronizedï¼‰</strong>ï¼šè¯¥å€¼åªåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è®¡ç®—ï¼Œå¹¶ä¸”æ‰€æœ‰çº¿ç¨‹ä¼šçœ‹åˆ°ç›¸åŒçš„å€¼ã€‚å¦‚æœåˆå§‹åŒ–å§”æ‰˜çš„åŒæ­¥é”ä¸æ˜¯å¿…éœ€çš„ï¼Œè¿™æ ·å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œï¼Œé‚£ä¹ˆå°† <code>LazyThreadSafetyMode.PUBLICATION</code> ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>lazy()</code> å‡½æ•°ã€‚ è€Œå¦‚æœä½ ç¡®å®šåˆå§‹åŒ–å°†æ€»æ˜¯å‘ç”Ÿåœ¨å•ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ <code>LazyThreadSafetyMode.NONE</code> æ¨¡å¼ï¼Œ å®ƒä¸ä¼šæœ‰ä»»ä½•çº¿ç¨‹å®‰å…¨çš„ä¿è¯å’Œç›¸å…³çš„å¼€é”€ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> lazyValue <span class="keyword">by</span> lazy&lt;String&gt;(LazyThreadSafetyMode.SYNCHRONIZED) &#123;</div><div class="line">    println(<span class="string">"computed!"</span>)</div><div class="line">    <span class="string">"Hello"</span> <span class="comment">//åŒæ­¥é”çš„ï¼ˆsynchronizedï¼‰</span></div><div class="line">&#125;</div><div class="line">println(lazyValue)</div><div class="line">println(lazyValue)</div></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">computed!</div><div class="line">Hello</div><div class="line">Hello</div></pre></td></tr></table></figure><h5 id="å¯è§‚å¯Ÿå±æ€§-Observable"><a href="#å¯è§‚å¯Ÿå±æ€§-Observable" class="headerlink" title="å¯è§‚å¯Ÿå±æ€§ Observable"></a>å¯è§‚å¯Ÿå±æ€§ Observable</h5><p><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.properties/-delegates/observable.html" target="_blank" rel="external"><code>Delegates.observable()</code></a> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šåˆå§‹å€¼å’Œä¿®æ”¹æ—¶å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰ã€‚ æ¯å½“æˆ‘ä»¬ç»™å±æ€§èµ‹å€¼æ—¶ä¼šè°ƒç”¨è¯¥å¤„ç†ç¨‹åºï¼ˆåœ¨èµ‹å€¼<em>å</em>æ‰§è¡Œï¼‰ã€‚å®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼šè¢«èµ‹å€¼çš„å±æ€§ã€æ—§å€¼å’Œæ–°å€¼ã€‚</p><p>å¦‚æœä½ æƒ³èƒ½å¤Ÿæˆªè·ä¸€ä¸ªèµ‹å€¼å¹¶â€œå¦å†³â€å®ƒï¼Œå°±ä½¿ç”¨ <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.properties/-delegates/vetoable.html" target="_blank" rel="external"><code>vetoable()</code></a> å–ä»£ <code>observable()</code>ã€‚ åœ¨å±æ€§è¢«èµ‹æ–°å€¼ç”Ÿæ•ˆ<em>ä¹‹å‰</em>ä¼šè°ƒç”¨ä¼ é€’ç»™ <code>vetoable</code> çš„å¤„ç†ç¨‹åºã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name <span class="keyword">by</span> Delegates.observable(<span class="string">"No Name"</span>) &#123; prop, old, new -&gt;</div><div class="line">    println(<span class="string">"è¢«èµ‹å€¼çš„å±æ€§ï¼š<span class="subst">$&#123;prop.name&#125;</span>,  <span class="subst">$old</span> &gt; <span class="subst">$new</span>"</span>)</div><div class="line">&#125;</div><div class="line">name = <span class="string">"ä¸¡å„€å¼"</span></div><div class="line">name = <span class="string">"å¼"</span></div><div class="line"><span class="keyword">var</span> skip <span class="keyword">by</span> Delegates.vetoable(<span class="string">"Null"</span>) &#123; property, oldValue, newValue -&gt;</div><div class="line">    println(<span class="string">"è¢«èµ‹å€¼çš„å±æ€§ï¼š<span class="subst">$&#123;property.name&#125;</span>,  <span class="subst">$oldValue</span> &gt; <span class="subst">$newValue</span>"</span>)</div><div class="line">    <span class="literal">false</span></div><div class="line">&#125;</div><div class="line">skip = <span class="string">"Test"</span></div><div class="line">println(skip)</div></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­è¾“å‡ºï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">è¢«èµ‹å€¼çš„å±æ€§ï¼šname,  No Name &gt; ä¸¡å„€å¼</div><div class="line">è¢«èµ‹å€¼çš„å±æ€§ï¼šname,  ä¸¡å„€å¼ &gt; å¼</div><div class="line">è¢«èµ‹å€¼çš„å±æ€§ï¼šskip,  Null &gt; Test</div><div class="line">Null</div></pre></td></tr></table></figure><h5 id="æŠŠå±æ€§å‚¨å­˜åœ¨æ˜ å°„ä¸­"><a href="#æŠŠå±æ€§å‚¨å­˜åœ¨æ˜ å°„ä¸­" class="headerlink" title="æŠŠå±æ€§å‚¨å­˜åœ¨æ˜ å°„ä¸­"></a>æŠŠå±æ€§å‚¨å­˜åœ¨æ˜ å°„ä¸­</h5><p>Map å¯ä½œä¸ºå§”æ‰˜æ¥å®ç°å§”æ‰˜å±æ€§ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> languageMap = mapOf(<span class="string">"language"</span> to <span class="string">"kotlin"</span>)</div><div class="line"><span class="keyword">val</span> language <span class="keyword">by</span> languageMap <span class="comment">//å˜é‡åå°±æ˜¯mapçš„key å¦åˆ™æ‰¾ä¸åˆ°è¯¥key Exception: NoSuchElementException</span></div><div class="line">println(language)</div></pre></td></tr></table></figure><p>è‹¥è¦ <code>var</code> å±æ€§åªéœ€è¦ä½¿ç”¨ <code>MutableMap</code> ã€‚åŒæ ·ä¹Ÿé€‚ç”¨äºç±»</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>(map: Map&lt;String, Any?&gt;) &#123;</div><div class="line">    <span class="keyword">val</span> name: String <span class="keyword">by</span> map</div><div class="line">    <span class="keyword">val</span> age: <span class="built_in">Int</span>     <span class="keyword">by</span> map</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">make</span><span class="params">()</span></span> &#123;</div><div class="line">        println(<span class="string">"make"</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">enable</span><span class="params">()</span></span> = <span class="literal">true</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">val</span> user = User(mapOf(</div><div class="line">        <span class="string">"name"</span> to <span class="string">"John Doe"</span>,</div><div class="line">        <span class="string">"age"</span> to <span class="number">25</span></div><div class="line">))</div><div class="line">println(<span class="string">"<span class="subst">$&#123;user.name&#125;</span> <span class="subst">$&#123;user.age&#125;</span>"</span>)<span class="comment">//ok</span></div></pre></td></tr></table></figure><h5 id="å±€éƒ¨å§”æ‰˜å±æ€§"><a href="#å±€éƒ¨å§”æ‰˜å±æ€§" class="headerlink" title="å±€éƒ¨å§”æ‰˜å±æ€§"></a>å±€éƒ¨å§”æ‰˜å±æ€§</h5><p>what? çœ‹ <code>lazy()</code> å¼ºå¤§çš„åˆå§‹åŒ–ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">letMake</span><span class="params">(take: ()</span></span> -&gt; User) &#123;</div><div class="line">    <span class="keyword">val</span> lazyUser <span class="keyword">by</span> lazy(take)</div><div class="line">    <span class="comment">//todo change true</span></div><div class="line">    <span class="keyword">if</span> (<span class="literal">false</span> &amp;&amp; lazyUser.enable()) &#123;</div><div class="line">        lazyUser.make()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//... </span></div><div class="line">letMake &#123; -&gt;</div><div class="line">    println(<span class="string">"init"</span>)</div><div class="line">    User(mapOf(<span class="string">"Twins"</span> to <span class="number">17</span>))</div><div class="line">&#125;</div></pre></td></tr></table></figure><h5 id="è‡ªå®šä¹‰å§”æ‰˜"><a href="#è‡ªå®šä¹‰å§”æ‰˜" class="headerlink" title="è‡ªå®šä¹‰å§”æ‰˜"></a>è‡ªå®šä¹‰å§”æ‰˜</h5><p> <strong>var</strong> å±æ€§éœ€è¦å®ç°  <code>getValue()</code>  <code>setValue()</code>  å‡½æ•°,<strong>val</strong> åªæ˜¯éœ€è¦<code>getValue()</code> å³å¯ã€‚ä¸¤å‡½æ•°éƒ½éœ€è¦ç”¨ <code>operator</code> å…³é”®å­—æ¥è¿›è¡Œæ ‡è®°ã€‚</p><p>å§”æ‰˜ç±»è¿˜å¯ä»¥å®ç°åŒ…å«æ‰€éœ€ <code>operator</code> æ–¹æ³•çš„ <code>ReadOnlyProperty</code> æˆ– <code>ReadWriteProperty</code> æ¥å£ä¹‹ä¸€ã€‚ è¿™ä¿©æ¥å£æ˜¯åœ¨ Kotlin æ ‡å‡†åº“ä¸­å£°æ˜çš„ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Delegate</span> </span>&#123;</div><div class="line">  <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">getValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;)</span></span>: String &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"<span class="subst">$thisRef</span>, thank you for delegating '<span class="subst">$&#123;property.name&#125;</span>' to me!"</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">setValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;, value: <span class="type">String</span>)</span></span> &#123;</div><div class="line">    println(<span class="string">"<span class="subst">$value</span> has been assigned to '<span class="subst">$&#123;property.name&#125;</span> in <span class="subst">$thisRef</span>.'"</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReadDelegate</span> : <span class="type">ReadOnlyProperty</span>&lt;<span class="type">Any?, String</span>&gt; </span>&#123;</div><div class="line">  <span class="keyword">override</span> <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">getValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;)</span></span>: String &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"<span class="subst">$thisRef</span>, thank you for delegating '<span class="subst">$&#123;property.name&#125;</span>' to me!"</span></div><div class="line">  &#125;</div><div class="line">  <span class="comment">//ä¸éœ€è¦ setValue</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//test</span></div><div class="line"><span class="keyword">var</span> p: String  <span class="keyword">by</span> Delegate()</div><div class="line">p = <span class="string">"default"</span></div><div class="line">p = <span class="string">"<span class="subst">$p</span>  \nchange"</span></div><div class="line"><span class="keyword">val</span> read <span class="keyword">by</span> ReadDelegate()</div><div class="line">println(read)</div></pre></td></tr></table></figure><h5 id="èƒŒååŸç†"><a href="#èƒŒååŸç†" class="headerlink" title="èƒŒååŸç†"></a>èƒŒååŸç†</h5><p>åœ¨ä½¿ç”¨å§”æ‰˜çš„æ—¶, ä¸éš¾å‘ç°è¯¥å±æ€§æ˜¯å§”æ‰˜ç±»å‹ã€‚æ¯”å¦‚ï¼š <code>p is String</code> ,è¾“å‡ºfalseã€‚</p><p>åœ¨æ¯ä¸ªå§”æ‰˜å±æ€§çš„å®ç°çš„èƒŒåï¼ŒKotlin ç¼–è¯‘å™¨éƒ½ä¼šç”Ÿæˆè¾…åŠ©å±æ€§å¹¶å§”æ‰˜ç»™å®ƒã€‚ ä¾‹å¦‚ï¼Œå¯¹äºå±æ€§ <code>prop</code>ï¼Œç”Ÿæˆéšè—å±æ€§ <code>prop$delegate</code>ï¼Œè€Œè®¿é—®å™¨çš„ä»£ç åªæ˜¯ç®€å•åœ°å§”æ‰˜ç»™è¿™ä¸ªé™„åŠ å±æ€§ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> prop: Type <span class="keyword">by</span> MyDelegate()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è¿™æ®µæ˜¯ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„ç›¸åº”ä»£ç ï¼š</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">val</span> prop$delegate = MyDelegate()</div><div class="line">    <span class="keyword">var</span> prop: Type</div><div class="line">        <span class="keyword">get</span>() = prop$delegate.getValue(<span class="keyword">this</span>, <span class="keyword">this</span>::prop)</div><div class="line">        <span class="keyword">set</span>(value: Type) = prop$delegate.setValue(<span class="keyword">this</span>, <span class="keyword">this</span>::prop, value)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p> Kotlin ç¼–è¯‘å™¨åœ¨å‚æ•°ä¸­æä¾›äº†å…³äº <code>prop</code> çš„æ‰€æœ‰å¿…è¦ä¿¡æ¯ï¼šç¬¬ä¸€ä¸ªå‚æ•° <code>this</code> å¼•ç”¨åˆ°å¤–éƒ¨ç±» <code>C</code> çš„å®ä¾‹è€Œ <code>this::prop</code> æ˜¯ <code>KProperty</code> ç±»å‹çš„åå°„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æè¿° <code>prop</code> è‡ªèº«ã€‚</p><h5 id="æä¾›å§”æ‰˜"><a href="#æä¾›å§”æ‰˜" class="headerlink" title="æä¾›å§”æ‰˜"></a>æä¾›å§”æ‰˜</h5><p>kotlin æä¾› <code>provideDelegate</code> æ“ä½œç¬¦ï¼Œå¯ä»¥æ‰©å±•åˆ›å»ºå±æ€§å®ç°æ‰€å§”æ‰˜å¯¹è±¡çš„é€»è¾‘ã€‚ä½¿ç”¨åœºæ™¯æ˜¯åœ¨åˆ›å»ºå±æ€§æ—¶ï¼ˆè€Œä¸ä»…åœ¨å…¶ getter æˆ– setter ä¸­ï¼‰æ£€æŸ¥å±æ€§ä¸€è‡´æ€§ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">R</span> </span>&#123;</div><div class="line">  <span class="keyword">object</span> id &#123;</div><div class="line">    <span class="keyword">val</span> textView = <span class="number">0x003</span></div><div class="line">    <span class="keyword">val</span> imageView = <span class="number">0x004</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">object</span> string &#123;</div><div class="line">    <span class="keyword">val</span> hello_world = <span class="number">0x001</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">object</span> drawable &#123;</div><div class="line">    <span class="keyword">val</span> icon_launch = <span class="number">0x002</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">View</span></span>(<span class="keyword">val</span> id: <span class="built_in">Int</span>)</div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageView</span></span>(id: <span class="built_in">Int</span>) : View(id)</div><div class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">TextView</span></span>(id: <span class="built_in">Int</span>, <span class="keyword">var</span> text: String = <span class="string">""</span>) : View(id)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">val</span> helloWorld <span class="keyword">by</span> findResourceById&lt;String&gt;(R.string.hello_world)</div><div class="line">  <span class="keyword">val</span> textView <span class="keyword">by</span> findResourceById&lt;TextView&gt;(R.id.textView)</div><div class="line"></div><div class="line">  <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T&gt;</span> <span class="title">findResourceById</span><span class="params">(id: <span class="type">Int</span>)</span></span>: ResourceLoader&lt;T&gt; &#123;</div><div class="line">    <span class="keyword">return</span> ResourceLoader&lt;T&gt;(id)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">fun</span> <span class="title">draw</span><span class="params">()</span></span> &#123;</div><div class="line">    println(helloWorld)</div><div class="line">    textView.text = <span class="string">"Hello"</span></div><div class="line">    println(textView.text)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResourceLoader</span>&lt;<span class="type">out T</span>&gt;</span>(<span class="keyword">val</span> id: <span class="built_in">Int</span>) &#123;</div><div class="line">  <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">provideDelegate</span><span class="params">(</span></span></div><div class="line">    thisRef: <span class="type">MyActivity</span>,</div><div class="line">    prop: <span class="type">KProperty</span>&lt;*&gt;</div><div class="line">  ): ReadOnlyProperty&lt;MyActivity, T&gt; &#123;</div><div class="line">    <span class="keyword">return</span> ResDelegate&lt;T&gt;(id)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ResDelegate</span>&lt;<span class="type">out V</span>&gt;</span>(<span class="keyword">val</span> id: <span class="built_in">Int</span>) : ReadOnlyProperty&lt;MyActivity, V&gt; &#123;</div><div class="line">    <span class="keyword">val</span> cacheKProperty = mutableMapOf&lt;String, Any&gt;()</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getValue</span><span class="params">(thisRef: <span class="type">MyActivity</span>, property: <span class="type">KProperty</span>&lt;*&gt;)</span></span>: V &#123;</div><div class="line">      <span class="keyword">val</span> last = cacheKProperty[property.name]</div><div class="line">      <span class="keyword">if</span> (last != <span class="literal">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> last <span class="keyword">as</span> V</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">val</span> value = <span class="keyword">when</span> (property.returnType.classifier) &#123;</div><div class="line">        String::<span class="class"><span class="keyword">class</span> -&gt; <span class="title">property</span>.<span class="title">name</span> <span class="title">as</span> <span class="title">V</span></span></div><div class="line">        View::<span class="class"><span class="keyword">class</span> -&gt; <span class="title">View</span></span>(id) <span class="keyword">as</span> V</div><div class="line">        TextView::<span class="class"><span class="keyword">class</span> -&gt; <span class="title">TextView</span></span>(id) <span class="keyword">as</span> V</div><div class="line">        ImageView::<span class="class"><span class="keyword">class</span> -&gt; <span class="title">ImageView</span></span>(id) <span class="keyword">as</span> V</div><div class="line">        <span class="keyword">else</span> -&gt; <span class="keyword">throw</span> NoSuchElementException()</div><div class="line">      &#125;</div><div class="line">      cacheKProperty.put(property.name, value!!)</div><div class="line">      <span class="keyword">return</span> value</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æä¾›å§”æ‰˜, å¹¶ä¸å¤æ‚ã€‚é€šè¿‡ä¸€ä¸ªå‡½æ•°å»è·å–å§”æ‰˜è€Œå·²ã€‚<code>provideDelegate</code> æ–¹æ³•åªå½±å“è¾…åŠ©å±æ€§çš„åˆ›å»ºï¼Œå¹¶ä¸ä¼šå½±å“ä¸º getter æˆ– setter ç”Ÿæˆçš„ä»£ç ã€‚</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="å‡½æ•°ç”¨æ³•"><a href="#å‡½æ•°ç”¨æ³•" class="headerlink" title="å‡½æ•°ç”¨æ³•"></a>å‡½æ•°ç”¨æ³•</h3><p>Kotlin ä¸­çš„å‡½æ•°ä½¿ç”¨ <code>fun</code> å…³é”®å­—å£°æ˜</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">funName</span><span class="params">(å‚æ•°)</span></span>[: returnType(é»˜è®¤ <span class="built_in">Unit</span>)] ...</div></pre></td></tr></table></figure><h4 id="å‡½æ•°å‚æ•°è§„åˆ™"><a href="#å‡½æ•°å‚æ•°è§„åˆ™" class="headerlink" title="å‡½æ•°å‚æ•°è§„åˆ™"></a>å‡½æ•°å‚æ•°è§„åˆ™</h4><ul><li>å‡½æ•°å‚æ•°ä½¿ç”¨ Pascal è¡¨ç¤ºæ³•å®šä¹‰ï¼Œå³ <em>name</em>: <em>type</em> , å‚æ•°ç”¨é€—å·éš”å¼€ã€‚</li><li>æ¯ä¸ªå‚æ•°å¿…é¡»æœ‰æ˜¾å¼ç±»å‹, å‚æ•°è¿˜å¯ä»¥æœ‰é»˜è®¤å€¼ï¼Œå½“çœç•¥ç›¸åº”çš„å‚æ•°æ—¶ä½¿ç”¨é»˜è®¤å€¼, ä»¥å‡å°‘é‡è½½æ•°é‡ã€‚</li><li>è¦†ç›–å¸¦æœ‰é»˜è®¤å‚æ•°å€¼çš„æ–¹æ³•æ—¶ï¼Œé»˜è®¤å‚æ•°å€¼çœç•¥ã€‚</li><li>å¦‚æœä¸€ä¸ªé»˜è®¤å‚æ•°åœ¨ä¸€ä¸ªæ— é»˜è®¤å€¼çš„å‚æ•°ä¹‹å‰ï¼Œé‚£ä¹ˆè¯¥é»˜è®¤å€¼åªèƒ½é€šè¿‡ä½¿ç”¨<a href="https://www.kotlincn.net/docs/reference/functions.html#å‘½åå‚æ•°" target="_blank" rel="external">å‘½åå‚æ•°</a>è°ƒç”¨è¯¥å‡½æ•°æ¥ä½¿ç”¨</li><li>å¦‚æœæœ€åä¸€ä¸ª <a href="https://www.kotlincn.net/docs/reference/lambdas.html#lambda-è¡¨è¾¾å¼ä¸åŒ¿åå‡½æ•°" target="_blank" rel="external">lambda è¡¨è¾¾å¼</a>å‚æ•°ä»æ‹¬å·å¤–ä¼ ç»™å‡½æ•°å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆå…è®¸é»˜è®¤å‚æ•°ä¸ä¼ å€¼</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">invoke</span><span class="params">(method: <span class="type">String</span>, invoke: <span class="type">Any</span> = this)</span></span> &#123;</div><div class="line">  println(<span class="string">"call#method= <span class="subst">$method</span> <span class="subst">$invoke</span>"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">invokeWithNameParameter</span><span class="params">(status: <span class="type">Int</span> = <span class="number">0</span>, method: <span class="type">String</span>, invoke: <span class="type">Any</span> = this)</span></span> &#123;</div><div class="line">  println(<span class="string">"call#method= <span class="subst">$method</span> <span class="subst">$invoke</span>"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">invokeWithLambda</span><span class="params">(status: <span class="type">Int</span> = <span class="number">0</span>, method: <span class="type">String</span> = <span class="string">"invokeWithLambda"</span>, invoke: <span class="type">Any</span> = this, apply: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">  println(<span class="string">"call#method= <span class="subst">$method</span> <span class="subst">$invoke</span>"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Source</span> </span>&#123;</div><div class="line">  <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">read</span><span class="params">(b: <span class="type">Array</span>&lt;<span class="type">Byte</span>&gt;, off: <span class="type">Int</span> = <span class="number">0</span>, len: <span class="type">Int</span> = b.size)</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileSource</span> : <span class="type">Source</span></span>() &#123;</div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">read</span><span class="params">(b: <span class="type">Array</span>&lt;<span class="type">Byte</span>&gt;, off: <span class="type">Int</span>, len: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">    println(<span class="string">"b.length = <span class="subst">$&#123;b.size&#125;</span> off = <span class="subst">$off</span> len = <span class="subst">$len</span>"</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//test</span></div><div class="line">invoke(<span class="string">"invoke"</span>)</div><div class="line">invokeWithNameParameter(method = <span class="string">"invokeWithNameParameter"</span>)</div><div class="line">invokeWithLambda(status = <span class="number">1</span>) &#123; println(<span class="string">"invokeWithLambda"</span>) &#125;</div><div class="line">invokeWithLambda &#123; println(<span class="string">"invokeWithLambda"</span>) &#125;</div><div class="line">FileSource().read(arrayOf(<span class="string">'A'</span>.toByte(), <span class="string">'B'</span>.toByte()))</div></pre></td></tr></table></figure><h4 id="å¯å˜æ•°é‡çš„å‚æ•°ï¼ˆVarargsï¼‰"><a href="#å¯å˜æ•°é‡çš„å‚æ•°ï¼ˆVarargsï¼‰" class="headerlink" title="å¯å˜æ•°é‡çš„å‚æ•°ï¼ˆVarargsï¼‰"></a>å¯å˜æ•°é‡çš„å‚æ•°ï¼ˆVarargsï¼‰</h4><p>å‡½æ•°çš„å‚æ•°ï¼ˆé€šå¸¸æ˜¯æœ€åä¸€ä¸ªï¼‰å¯ä»¥ç”¨ <code>vararg</code> ä¿®é¥°ç¬¦æ ‡è®°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">varargFun</span><span class="params">(method: <span class="type">String</span> = <span class="string">"varargFun"</span>, <span class="keyword">vararg</span> s: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">  s.forEach &#123; print(it) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">val</span> b = intArrayOf(<span class="number">6</span>, <span class="number">8</span>)</div><div class="line"><span class="comment">// vararg å‚æ•° ç±»å‹æ˜¯åŸºæœ¬ç±»å‹,å³æ˜¯ *Array ç±»å‹ å¦åˆ™ Array&lt;out T&gt;</span></div><div class="line">varargFun(<span class="string">"1"</span>, <span class="number">2</span>, <span class="number">4</span>, *b, <span class="number">10</span>)</div></pre></td></tr></table></figure><p><strong>ä¼¸å±•ï¼ˆspreadï¼‰</strong>æ“ä½œç¬¦ï¼ˆåœ¨æ•°ç»„å‰é¢åŠ  <code>*</code>ï¼‰,å¯ä»¥æ•°ç»„å…ƒç´ æ·»åŠ åˆ°vararg å˜é‡ä¸­å»</p><h4 id="è¿”å›-Unit-çš„å‡½æ•°"><a href="#è¿”å›-Unit-çš„å‡½æ•°" class="headerlink" title="è¿”å› Unit çš„å‡½æ•°"></a>è¿”å› Unit çš„å‡½æ•°</h4><p>å¦‚æœä¸€ä¸ªå‡½æ•°ä¸è¿”å›ä»»ä½•æœ‰ç”¨çš„å€¼ï¼Œå®ƒçš„è¿”å›ç±»å‹æ˜¯ <code>Unit</code>ã€‚<code>Unit</code> æ˜¯ä¸€ç§åªæœ‰ä¸€ä¸ªå€¼â€”â€”<code>Unit</code> çš„ç±»å‹ã€‚è¿™ä¸ªå€¼ä¸éœ€è¦æ˜¾å¼è¿”å›ã€‚Unit å°±åƒJava çš„ <code>Void</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">printHello</span><span class="params">(name: <span class="type">String</span>?)</span></span>: <span class="built_in">Unit</span> &#123;</div><div class="line">  <span class="keyword">if</span> (name != <span class="literal">null</span>)</div><div class="line">  println(<span class="string">"Hello <span class="subst">$&#123;name&#125;</span>"</span>)</div><div class="line">  <span class="keyword">else</span></div><div class="line">  println(<span class="string">"Hi there!"</span>)</div><div class="line">  <span class="comment">// `return Unit` æˆ–è€… `return` æ˜¯å¯é€‰çš„</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="å•è¡¨è¾¾å¼å‡½æ•°"><a href="#å•è¡¨è¾¾å¼å‡½æ•°" class="headerlink" title="å•è¡¨è¾¾å¼å‡½æ•°"></a>å•è¡¨è¾¾å¼å‡½æ•°</h4><p>å½“å‡½æ•°è¿”å›å•ä¸ªè¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥çœç•¥èŠ±æ‹¬å·å¹¶ä¸”åœ¨ <strong>=</strong> ç¬¦å·ä¹‹åæŒ‡å®šä»£ç ä½“å³å¯ã€‚å½“è¿”å›å€¼ç±»å‹å¯ç”±ç¼–è¯‘å™¨æ¨æ–­æ—¶ï¼Œæ˜¾å¼å£°æ˜è¿”å›ç±»å‹æ˜¯<a href="https://www.kotlincn.net/docs/reference/functions.html#æ˜¾å¼è¿”å›ç±»å‹" target="_blank" rel="external">å¯é€‰</a>çš„, ä½†å…·æœ‰å—ä»£ç ä½“çš„å‡½æ•°å¿…é¡»å§‹ç»ˆæ˜¾å¼æŒ‡å®šè¿”å›ç±»å‹ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">double</span><span class="params">(x: <span class="type">Int</span>)</span></span> = x * <span class="number">2</span></div></pre></td></tr></table></figure><h4 id="ä¸­ç¼€è¡¨ç¤ºæ³•"><a href="#ä¸­ç¼€è¡¨ç¤ºæ³•" class="headerlink" title="ä¸­ç¼€è¡¨ç¤ºæ³•"></a>ä¸­ç¼€è¡¨ç¤ºæ³•</h4><p>Kotlinæ”¯æŒæ•°å­—è¿ç®—çš„æ ‡å‡†é›†,æ­£æ˜¯ç”¨äº†ä¸­ç¼€è¡¨ç¤ºæ³•ï¼Œå½“å‡½æ•°æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å°±èƒ½ç”¨ <code>infix</code> å…³é”®å­—æ ‡æ³¨</p><ul><li>ä»–ä»¬æ˜¯æˆå‘˜å‡½æ•°æˆ–<a href="https://www.kotlincn.net/docs/reference/extensions.html" target="_blank" rel="external">æ‰©å±•å‡½æ•°</a></li><li>ä»–ä»¬åªæœ‰ä¸€ä¸ªå‚æ•°</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> String.<span class="title">append</span><span class="params">(s: <span class="type">String</span>)</span></span>: String &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"<span class="subst">$this</span><span class="subst">$s</span>"</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> <span class="title">call</span><span class="params">(method: <span class="type">String</span>)</span></span> &#123;</div><div class="line">    println(<span class="string">"call#method= <span class="subst">$method</span>"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">val</span> s = <span class="string">"infix"</span> append <span class="string">" gc"</span></div><div class="line">println(s)</div><div class="line"><span class="keyword">this</span> call (<span class="string">"append"</span>)</div></pre></td></tr></table></figure><h3 id="å‡½æ•°ä½œç”¨åŸŸ"><a href="#å‡½æ•°ä½œç”¨åŸŸ" class="headerlink" title="å‡½æ•°ä½œç”¨åŸŸ"></a>å‡½æ•°ä½œç”¨åŸŸ</h3><p>åœ¨ Kotlin ä¸­å‡½æ•°å¯ä»¥åœ¨æ–‡ä»¶é¡¶å±‚å£°æ˜ï¼Œè¿™æ„å‘³ç€ä½ ä¸éœ€è¦åƒä¸€äº›è¯­è¨€å¦‚ Javaã€C# æˆ– Scala é‚£æ ·åˆ›å»ºä¸€ä¸ªç±»æ¥ä¿å­˜ä¸€ä¸ªå‡½æ•°ã€‚æ­¤å¤–é™¤äº†é¡¶å±‚å‡½æ•°ï¼ŒKotlin ä¸­å‡½æ•°ä¹Ÿå¯ä»¥å£°æ˜åœ¨å±€éƒ¨ä½œç”¨åŸŸã€ä½œä¸ºæˆå‘˜å‡½æ•°ä»¥åŠæ‰©å±•å‡½æ•°ã€‚</p><ul><li>åœ¨ç±»æˆ–å¯¹è±¡å†…éƒ¨å®šä¹‰çš„å‡½æ•°â€”â€”æˆå‘˜å‡½æ•°</li><li>ä¸€ä¸ªå‡½æ•°åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨â€”â€”å±€éƒ¨å‡½æ•°</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//æˆå‘˜å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">memberFun</span><span class="params">()</span></span> &#123;</div><div class="line">  <span class="keyword">val</span> visited = <span class="string">""</span></div><div class="line">  <span class="function"><span class="keyword">fun</span> <span class="title">partialFun</span><span class="params">()</span></span> &#123;    <span class="comment">//å±€éƒ¨å‡½æ•°</span></div><div class="line">    println(visited)</div><div class="line">  &#125;</div><div class="line">  partialFun()</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æ³›å‹å‡½æ•°"><a href="#æ³›å‹å‡½æ•°" class="headerlink" title="æ³›å‹å‡½æ•°"></a>æ³›å‹å‡½æ•°</h3><p>å‡½æ•°å¯ä»¥æœ‰æ³›å‹å‚æ•°ï¼Œé€šè¿‡åœ¨å‡½æ•°åå‰ä½¿ç”¨å°–æ‹¬å·æŒ‡å®šã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">singletonList</span><span class="params">(item: <span class="type">T</span>)</span></span>: List&lt;T&gt; &#123;</div><div class="line">  <span class="keyword">return</span> listOf(item)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h3><p>é«˜é˜¶å‡½æ•°æ˜¯å°†å‡½æ•°ç”¨ä½œå‚æ•°æˆ–è¿”å›å€¼çš„å‡½æ•°ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å‡½æ•°ç”¨ä½œå‚æ•° () -&gt; Unit ä¸å¸¦å‚æ•°å¹¶ ä¸”è¿”å› Unit ç±»å‹å€¼çš„å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">(runnable: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">  println(<span class="string">"post before"</span>)</div><div class="line">  runnable()</div><div class="line">  println(<span class="string">"post after"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">postDelay</span><span class="params">(delay: <span class="type">Int</span>, runnable: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">  println(<span class="string">"postDelay before"</span>)</div><div class="line">  runnable()</div><div class="line">  println(<span class="string">"postDelay after"</span>)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">  post(<span class="keyword">this</span>::sayHi) <span class="comment">//å‡½æ•°å¼•ç”¨</span></div><div class="line">  post &#123; println(<span class="string">"post"</span>) &#125;</div><div class="line">  postDelay(<span class="number">1000</span>) &#123; println(<span class="string">"postDelay"</span>) &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>() -&gt; Unit</code> è¢«ç§°ä¸º<a href="#å‡½æ•°ç±»å‹">å‡½æ•°ç±»å‹</a> , <code>::</code> æ“ä½œç¬¦å¯å‚è§<a href="#å‡½æ•°å¼•ç”¨">å‡½æ•°å¼•ç”¨</a>, å½“ä¸€ä¸ªå‡½æ•°æ¥å—å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼Œlambda è¡¨è¾¾å¼å‚æ•°å¯ä»¥åœ¨åœ†æ‹¬å·å‚æ•°åˆ—è¡¨ä¹‹å¤–ä¼ é€’ã€‚ å‚è§ <a href="https://www.kotlincn.net/docs/reference/grammar.html#callSuffix" target="_blank" rel="external">callSuffix</a> çš„è¯­æ³•ã€‚</p><h4 id="Lambda-è¡¨è¾¾å¼ä¸åŒ¿åå‡½æ•°"><a href="#Lambda-è¡¨è¾¾å¼ä¸åŒ¿åå‡½æ•°" class="headerlink" title="Lambda è¡¨è¾¾å¼ä¸åŒ¿åå‡½æ•°"></a>Lambda è¡¨è¾¾å¼ä¸åŒ¿åå‡½æ•°</h4><p>ä¸€ä¸ª lambda è¡¨è¾¾å¼æˆ–åŒ¿åå‡½æ•°æ˜¯ä¸€ä¸ªâ€œå‡½æ•°å­—é¢å€¼â€ï¼Œå³ä¸€ä¸ªæœªå£°æ˜çš„å‡½æ•°ï¼Œ ä½œä¸ºè¡¨è¾¾å¼ä¼ é€’ã€‚</p><h5 id="Lambda-è¡¨è¾¾å¼è¯­æ³•"><a href="#Lambda-è¡¨è¾¾å¼è¯­æ³•" class="headerlink" title="Lambda è¡¨è¾¾å¼è¯­æ³•"></a>Lambda è¡¨è¾¾å¼è¯­æ³•</h5><p>lambda è¡¨è¾¾å¼æ€»æ˜¯è¢«å¤§æ‹¬å·æ‹¬ç€,å®Œæ•´è¯­æ³•å½¢å¼çš„å‚æ•°å£°æ˜æ”¾åœ¨æ‹¬å·å†…ï¼Œå¹¶æœ‰å¯é€‰çš„ç±»å‹æ ‡æ³¨ï¼Œ å‡½æ•°ä½“è·Ÿåœ¨ä¸€ä¸ª <code>-&gt;</code> ç¬¦å·ä¹‹åã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">println(&#123;&#125;) <span class="comment">//è¾“å‡º: () -&gt; kotlin.Unit</span></div><div class="line">println(&#123; <span class="string">"String"</span> &#125;)<span class="comment">//è¾“å‡º: () -&gt; kotlin.String</span></div><div class="line"><span class="keyword">val</span> string = &#123; <span class="string">"String"</span> &#125;</div><div class="line">println(string())<span class="comment">//è¾“å‡º: String</span></div></pre></td></tr></table></figure><p>æŒ–æ§½,ä¸Šé¢çš„æ˜¯ä»€ä¹ˆé¬¼ã€‚æ²¡äº†è§£<a href="https://zh.wikipedia.org/wiki/%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0" target="_blank" rel="external">Lambda è¡¨è¾¾å¼</a> çš„ï¼Œå½“ç„¶ä¼šå›°æƒ‘ä¸å·²ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">explicitAnonymous</span><span class="params">()</span></span>: () -&gt; <span class="built_in">Int</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123; -&gt; <span class="number">1</span> &#125; <span class="comment">//æ²¡å‚æ•°ä¸èƒ½æœ‰æ‹¬å·() -&gt; ä¹Ÿå¯ç•¥</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥å°±ç®€å•æ˜äº†ã€‚<code>{}</code> å£°æ˜äº†ä¸ªåŒ¿åå‡½æ•°,ç¼–è¯‘å™¨ä½œä»¥ä¸‹å¤„ç† </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">local <span class="keyword">final</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;anonymous&gt;</span><span class="params">()</span></span>: <span class="built_in">Unit</span></div></pre></td></tr></table></figure><p>å½“ä¸€ä¸ªç©ºå‚æ•°çš„åŒ¿åå‡½æ•°, å¦‚ <code>{ &quot;String&quot; }</code> ,ç¼–è¯‘å™¨ä¼šå°†lambda ä¸»ä½“ä¸­çš„æœ€åä¸€ä¸ªæˆ–å¯èƒ½æ˜¯å•ä¸ªï¼‰è¡¨è¾¾å¼ä¼šè§†ä¸ºè¿”å›å€¼ã€‚è‹¥æ˜¯<code>{ &quot;String&quot;;1 }</code> åˆ™è¾“å‡º <code>() -&gt; kotlin.Int</code></p><p>å¯é€‰çš„ç±»å‹æ ‡æ³¨,å•è¡¨è¾¾å¼å‡½æ•°æ—¶,æ˜¾å¼å£°æ˜è¿”å›ç±»å‹æ˜¯å¯é€‰çš„,åŒ¿åçš„å‚æ•°ç±»å‹ä¹Ÿæ˜¯å¯é€‰çš„ã€‚éå•è¡¨è¾¾å¼å‡½æ•°æ—¶,åˆ™å˜é‡åå¯é€‰ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> sum = &#123; x: <span class="built_in">Int</span>, y: <span class="built_in">Int</span> -&gt; x + y &#125;  <span class="comment">//val sum: (Int, Int) â†’ Int</span></div><div class="line"><span class="keyword">val</span> sum2: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = &#123; x, y -&gt; x + y &#125; <span class="comment">//val sum2: (Int, Int) â†’ Int</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum3</span><span class="params">(sum: (<span class="type">Int</span>, <span class="built_in">Int</span>)</span></span> -&gt; <span class="built_in">Int</span>) &#123;</div><div class="line">  println(sum(<span class="number">0</span>,<span class="number">0</span>))</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum4</span><span class="params">(sum: (<span class="type">a</span>: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span> -&gt; <span class="built_in">Int</span>) &#123;</div><div class="line">  println(sum)</div><div class="line">&#125;</div><div class="line">sum3 &#123; a, b -&gt; <span class="number">1</span> + <span class="number">3</span> &#125;</div><div class="line">println(sum(<span class="number">1</span>, <span class="number">2</span>))</div></pre></td></tr></table></figure><p>åœ¨ Kotlin ä¸­Lambdaè¡¨è¾¾å¼çº¦å®š</p><ul><li>å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä½ ä¼ é€’ä¸€ä¸ª lambda è¡¨è¾¾å¼ä½œä¸ºç›¸åº”çš„å‚æ•°ï¼Œä½ å¯ä»¥åœ¨åœ†æ‹¬å·ä¹‹å¤–ä¼ é€’</li><li>lambda æ˜¯è¯¥è°ƒç”¨çš„å”¯ä¸€å‚æ•°ï¼Œåˆ™è°ƒç”¨ä¸­çš„åœ†æ‹¬å·å¯ä»¥å®Œå…¨çœç•¥ã€‚</li><li>å‡½æ•°å­—é¢å€¼åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œ é‚£ä¹ˆå®ƒçš„å£°æ˜å¯ä»¥çœç•¥ï¼ˆè¿åŒ <code>-&gt;</code>ï¼‰ï¼Œå…¶åç§°æ˜¯ <code>it</code>ã€‚</li><li>æœªä½¿ç”¨çš„å˜é‡å¯ç”¨ä¸‹åˆ’çº¿å–ä»£å…¶åç§°</li><li>lambda éšå¼è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼,å¯ä»¥ç”¨<a href="https://www.kotlincn.net/docs/reference/returns.html#æ ‡ç­¾å¤„è¿”å›" target="_blank" rel="external">é™å®šçš„è¿”å›</a>è¯­æ³•æ˜¾å¼è¿”å›</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">filter</span><span class="params">(predicate: (<span class="type">T</span>)</span></span> -&gt; <span class="built_in">Boolean</span>) &#123;</div><div class="line">  TODO()</div><div class="line">&#125;</div><div class="line">filter&lt;<span class="built_in">Int</span>&gt;() &#123; it &gt; <span class="number">0</span> &#125; <span class="comment">//() å¯ç•¥</span></div><div class="line">filter&lt;<span class="built_in">Int</span>&gt; &#123; it &gt; <span class="number">0</span> &#125;</div><div class="line">filter&lt;<span class="built_in">Int</span>&gt; &#123; _ -&gt; <span class="literal">false</span> &#125;</div><div class="line">filter&lt;<span class="built_in">Int</span>&gt; &#123;</div><div class="line">  <span class="keyword">val</span> shouldFilter = it &gt; <span class="number">0</span></div><div class="line">  <span class="keyword">return</span><span class="symbol">@filter</span> shouldFilter</div><div class="line">&#125;</div></pre></td></tr></table></figure><h5 id="åŒ¿åå‡½æ•°"><a href="#åŒ¿åå‡½æ•°" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h5><p>é¡¾åæ€ä¹‰,ä¸å¸¸è§„å‡½æ•°ç›¸åŒä¸éœ€è¦æŒ‡å®šå‡½æ•°å</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> sumAnonymous = <span class="function"><span class="title">fun</span><span class="params">(x: <span class="type">Int</span>, y: <span class="type">Int</span>)</span></span> = x + y <span class="comment">//è¿”å›ç±»å‹å¯ä»¥è‡ªåŠ¨æ¨æ–­</span></div><div class="line">println(sumAnonymous(<span class="number">1</span>, <span class="number">3</span>))</div><div class="line"><span class="keyword">val</span> sumAnonymous2 = <span class="function"><span class="title">fun</span><span class="params">(x: <span class="type">Int</span>, y: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</div><div class="line">  <span class="keyword">return</span> x + y</div><div class="line">&#125;</div><div class="line">filter&lt;<span class="built_in">Int</span>&gt;(<span class="function"><span class="title">fun</span><span class="params">(item)</span></span> = item &gt; <span class="number">0</span>) <span class="comment">//æ¨æ–­å‡ºçš„å‚æ•°ç±»å‹å¯ä»¥çœç•¥. åªèƒ½åœ¨æ‹¬å·å†…ä¼ é€’</span></div></pre></td></tr></table></figure><p>åŒ¿åå‡½æ•°å’Œlambda æ˜¯æœ‰åŒºåˆ«çš„ï¼ŒåŒ¿åå‡½æ•°å‚æ•°åªèƒ½åœ¨æ‹¬å·å†…ä¼ é€’ã€‚ å…è®¸å°†å‡½æ•°ç•™åœ¨åœ†æ‹¬å·å¤–çš„ç®€å†™è¯­æ³•ä»…é€‚ç”¨äº lambda è¡¨è¾¾å¼ã€‚Lambdaè¡¨è¾¾å¼ä¸åŒ¿åå‡½æ•°ä¹‹é—´çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯<a href="https://www.kotlincn.net/docs/reference/inline-functions.html#éå±€éƒ¨è¿”å›" target="_blank" rel="external">éå±€éƒ¨è¿”å›</a>çš„è¡Œä¸ºã€‚ä¸€ä¸ªä¸å¸¦æ ‡ç­¾çš„ <em>return</em> è¯­å¥æ€»æ˜¯åœ¨ç”¨ <em>fun</em> å…³é”®å­—å£°æ˜çš„å‡½æ•°ä¸­è¿”å›ã€‚è¿™æ„å‘³ç€ lambda è¡¨è¾¾å¼ä¸­çš„ <em>return</em> å°†ä»åŒ…å«å®ƒçš„å‡½æ•°è¿”å›ï¼Œè€ŒåŒ¿åå‡½æ•°ä¸­çš„ <em>return</em>å°†ä»åŒ¿åå‡½æ•°è‡ªèº«è¿”å›ã€‚</p><h5 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h5><p>Lambda è¡¨è¾¾å¼æˆ–è€…åŒ¿åå‡½æ•°ï¼ˆä»¥åŠ<a href="https://www.kotlincn.net/docs/reference/functions.html#å±€éƒ¨å‡½æ•°" target="_blank" rel="external">å±€éƒ¨å‡½æ•°</a>å’Œ<a href="https://www.kotlincn.net/docs/reference/object-declarations.html#å¯¹è±¡è¡¨è¾¾å¼" target="_blank" rel="external">å¯¹è±¡è¡¨è¾¾å¼</a>ï¼‰ å¯ä»¥è®¿é—®å…¶ <em>é—­åŒ…</em> ï¼Œå³åœ¨å¤–éƒ¨ä½œç”¨åŸŸä¸­å£°æ˜çš„å˜é‡ã€‚ ä¸ Java ä¸åŒçš„æ˜¯å¯ä»¥ä¿®æ”¹é—­åŒ…ä¸­æ•è·çš„å˜é‡ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> aNumber = <span class="number">0</span></div><div class="line">run &#123;</div><div class="line">  aNumber += <span class="number">1</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">val</span> add = <span class="function"><span class="title">fun</span><span class="params">()</span></span> &#123;</div><div class="line">  aNumber += <span class="number">1</span></div><div class="line">&#125;</div><div class="line">add()</div><div class="line">println(<span class="string">"aNumber: <span class="subst">$aNumber</span>"</span>)</div></pre></td></tr></table></figure><h5 id="å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼"><a href="#å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼" class="headerlink" title="å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼"></a>å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼</h5><p>Kotlin æä¾›äº†ä½¿ç”¨æŒ‡å®šçš„ <em>æ¥æ”¶è€…å¯¹è±¡</em> è°ƒç”¨å‡½æ•°å­—é¢å€¼çš„åŠŸèƒ½ã€‚ åœ¨å‡½æ•°å­—é¢å€¼çš„å‡½æ•°ä½“ä¸­ï¼Œå¯ä»¥è°ƒç”¨è¯¥æ¥æ”¶è€…å¯¹è±¡ä¸Šçš„æ–¹æ³•è€Œæ— éœ€ä»»ä½•é¢å¤–çš„é™å®šç¬¦ã€‚ è¿™ç±»ä¼¼äºæ‰©å±•å‡½æ•°ï¼Œå®ƒå…è®¸ä½ åœ¨å‡½æ•°ä½“å†…è®¿é—®æ¥æ”¶è€…å¯¹è±¡çš„æˆå‘˜ã€‚ å…¶ç”¨æ³•çš„æœ€é‡è¦çš„ç¤ºä¾‹ä¹‹ä¸€æ˜¯<a href="https://www.kotlincn.net/docs/reference/type-safe-builders.html" target="_blank" rel="external">ç±»å‹å®‰å…¨çš„ Groovy-é£æ ¼æ„å»ºå™¨</a>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> sumR = <span class="function"><span class="keyword">fun</span> <span class="built_in">Int</span>.<span class="params">(other: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> = <span class="keyword">this</span> + other <span class="comment">//val sumR: Int.(Int) â†’ Int</span></div><div class="line">println(<span class="number">1.</span>sumR(<span class="number">2</span>))</div></pre></td></tr></table></figure><h3 id="å†…è”å‡½æ•°"><a href="#å†…è”å‡½æ•°" class="headerlink" title="å†…è”å‡½æ•°"></a>å†…è”å‡½æ•°</h3><p>è¦çŸ¥é“ä½¿ç”¨<a href="#é«˜é˜¶å‡½æ•°">é«˜é˜¶å‡½æ•°</a>æ—¶,æ¯ä¸€ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”ä¼šæ•è·ä¸€ä¸ª<a href="#é—­åŒ…">é—­åŒ…</a>ã€‚ æ‰€ä»¥å¸¦æ¥ä¸€äº›è¿è¡Œæ—¶çš„æ•ˆç‡æŸå¤±,å³é‚£äº›åœ¨å‡½æ•°ä½“å†…ä¼šè®¿é—®åˆ°çš„å˜é‡ã€‚ å†…å­˜åˆ†é…ï¼ˆå¯¹äºå‡½æ•°å¯¹è±¡å’Œç±»ï¼‰å’Œè™šæ‹Ÿè°ƒç”¨ä¼šå¼•å…¥è¿è¡Œæ—¶é—´å¼€é”€ã€‚</p><p>kotlin æ”¯æŒ <code>inline</code> ä¿®é¥°å…·æœ‰lambdaå‚æ•°çš„å‡½æ•°,ä»¥æ¶ˆé™¤è¿™ç±»çš„å¼€é”€ã€‚(ä»…æ”¯æŒé¡¶å±‚ã€æˆå‘˜å‡½æ•°,å³ä¸æ”¯æŒå±€å‡½æ•°)</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">lockInline</span><span class="params">(lock: <span class="type">Lock</span>, body: ()</span></span> -&gt; T): T &#123;</div><div class="line">  lock.lock()</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">return</span> body()</div><div class="line">  &#125; <span class="keyword">finally</span> &#123;</div><div class="line">    lock.unlock()</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å†…è”åŸç†å…¶å®æ˜¯ç¼–è¯‘å™¨æ‹·è´ä»£ç å‰¯æœ¬ï¼ˆå¦‚:<code>body () -&gt; T</code>ï¼‰ï¼Œè¿™å¯èƒ½å¯¼è‡´ç”Ÿæˆçš„ä»£ç å¢åŠ ï¼Œä½†åœ¨å¾ªç¯ä¸­çš„â€œè¶…å¤šæ€ï¼ˆmegamorphicï¼‰â€ æƒ…å†µä¸‹,å°†åœ¨æ€§èƒ½ä¸Šæœ‰æ‰€æå‡ã€‚</p><p>ä¸å…·æœ‰lambdaå‚æ•°çš„å‡½æ•°:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123; <span class="comment">//warn å†…è”å‡½æ•°æœ€é€‚ç”¨äºå…·æœ‰lambdaå‚æ•°çš„å‡½æ•°</span></div></pre></td></tr></table></figure><p>NOTEï¼šå†…è”å‡½æ•°ä¸æ”¯æŒå±€éƒ¨å‡½æ•°</p><h4 id="ç¦ç”¨å†…è”"><a href="#ç¦ç”¨å†…è”" class="headerlink" title="ç¦ç”¨å†…è”"></a>ç¦ç”¨å†…è”</h4><p>å¯¹äºå…·æœ‰å¤šä¸ªlambdaå‚æ•°çš„å†…è”å‡½æ•°æ¥è¯´ï¼Œé»˜è®¤å†…è”, å¯ç”¨ <code>noinline</code> ä¿®é¥°lambdaå‚æ•°,ç¦ç”¨å†…è”ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">(inlined: ()</span></span> -&gt; <span class="built_in">Unit</span>, <span class="keyword">noinline</span> notInlined: () -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">  <span class="comment">// â€¦â€¦</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>noinline</code> ä»…åœ¨å†…è”å‡½æ•°ä¸­å¯ä½¿ç”¨</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">(<span class="keyword">noinline</span> notInlined: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">  <span class="comment">// â€¦â€¦ ä»…ä¸€ä¸ªå‚æ•°åˆç”¨ noinline ä¿®é¥°, inline å°†æ— æ•ˆ</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="éå±€éƒ¨è¿”å›"><a href="#éå±€éƒ¨è¿”å›" class="headerlink" title="éå±€éƒ¨è¿”å›"></a>éå±€éƒ¨è¿”å›</h4><p> lambda è¡¨è¾¾å¼å†…éƒ¨ä¸å…è®¸æ— æ ‡ç­¾çš„<code>return</code> , ä½†ä¼ ç»™çš„å‡½æ•°æ˜¯å†…è”çš„ï¼Œè¯¥ return ä¹Ÿå¯ä»¥å†…è”ï¼Œæ‰€ä»¥å®ƒæ˜¯å…è®¸è¿”å›ã€‚ç§°ä¸º<strong>éå±€éƒ¨è¿”å›</strong>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">lock</span><span class="params">(body: ()</span></span> -&gt; T): <span class="built_in">Unit</span> &#123;</div><div class="line">&#125;</div><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">lockInline</span><span class="params">(body: ()</span></span> -&gt; T): <span class="built_in">Unit</span> &#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">lock &#123;</div><div class="line">    <span class="keyword">return</span>  <span class="comment">// ä¸å…è®¸ä¸å¸¦æ ‡ç­¾çš„return. return@lock</span></div><div class="line">&#125;</div><div class="line">lockInline&#123;</div><div class="line">  <span class="keyword">return</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¾ªç¯ä¸­å¸¸ç”¨è¿™ç§ç»“æ„</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">hasZeros</span><span class="params">(ints: <span class="type">List</span>&lt;<span class="type">Int</span>&gt;)</span></span>: <span class="built_in">Boolean</span> &#123;</div><div class="line">  ints.forEach &#123;</div><div class="line">    <span class="keyword">if</span> (it == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// ä» hasZeros è¿”å›</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸€äº›å†…è”å‡½æ•°å¯èƒ½è°ƒç”¨ä¼ ç»™å®ƒä»¬çš„ä¸æ˜¯ç›´æ¥æ¥è‡ªå‡½æ•°ä½“ã€è€Œæ˜¯æ¥è‡ªå¦ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡çš„ lambda è¡¨è¾¾å¼å‚æ•°ï¼Œä¾‹å¦‚æ¥è‡ªå±€éƒ¨å¯¹è±¡æˆ–åµŒå¥—å‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥ lambda è¡¨è¾¾å¼ä¸­ä¹Ÿä¸å…è®¸éå±€éƒ¨æ§åˆ¶æµã€‚ä¸ºäº†æ ‡è¯†è¿™ç§æƒ…å†µï¼Œè¯¥ lambda è¡¨è¾¾å¼å‚æ•°éœ€è¦ç”¨ <code>crossinline</code> ä¿®é¥°ç¬¦æ ‡è®°:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">post</span><span class="params">(<span class="keyword">crossinline</span> body: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">  Runnable &#123; body() &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="å…·ä½“åŒ–çš„ç±»å‹å‚æ•°"><a href="#å…·ä½“åŒ–çš„ç±»å‹å‚æ•°" class="headerlink" title="å…·ä½“åŒ–çš„ç±»å‹å‚æ•°"></a>å…·ä½“åŒ–çš„ç±»å‹å‚æ•°</h4><p>å†…è”å‡½æ•°èƒ½æœ‰å…·ä½“åŒ–çš„ç±»å‹å‚æ•°ï¼ˆReified type parametersï¼‰,ç”¨ <code>reified</code> ä¿®é¥°ç¬¦æ¥é™å®šç±»å‹å‚æ•°</p><p>åœ¨å‰é¢æ³›å‹å‡½æ•°å­¦ä¹ ä¸­,æ˜¯ä¸èƒ½æœ‰å…·ä½“åŒ–å‚æ•°,è·å– classæ—¶å¸¦æ¥ä¸ä¾¿ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">findType</span><span class="params">(t: <span class="type">T</span>)</span></span> &#123;</div><div class="line">  <span class="comment">//å› ä¸ºT ä¸æ˜¯é™æ€å·²çŸ¥çš„ Kotlin ç±»çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä¸èƒ½ T::class</span></div><div class="line">  println((t <span class="keyword">as</span> Any)::<span class="class"><span class="keyword">class</span>)</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å†…è”å‡½æ•°æ”¯æŒå…·ä½“åŒ–çš„ç±»å‹å‚æ•°,ä¸éœ€è¦åå°„ï¼Œæ­£å¸¸çš„æ“ä½œç¬¦å¦‚ !is å’Œ as èƒ½æ­£å¸¸ä½¿ç”¨</span></div><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : Number&gt;</span> <span class="title">findReifiedType</span><span class="params">(t: <span class="type">T</span>)</span></span> &#123;</div><div class="line">  println(T::<span class="class"><span class="keyword">class</span>)</span></div><div class="line">  println(<span class="built_in">Int</span>.MIN_VALUE <span class="keyword">is</span> T)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="å†…è”å±æ€§"><a href="#å†…è”å±æ€§" class="headerlink" title="å†…è”å±æ€§"></a>å†…è”å±æ€§</h4><p><code>inline</code> ä¿®é¥°ç¬¦è¿˜å¯ä»¥ä¿®é¥°æ²¡æœ‰å¹•åå­—æ®µçš„å±æ€§çš„è®¿é—®å™¨ï¼ˆæœ‰setter/getterï¼‰,å¯å•ç‹¬æ ‡æ³¨ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> max <span class="keyword">inline</span> <span class="keyword">get</span>() = <span class="built_in">Int</span>.MAX_VALUE</div><div class="line"><span class="keyword">inline</span> <span class="keyword">val</span> max1 <span class="keyword">get</span>() = <span class="built_in">Int</span>.MAX_VALUE</div><div class="line"><span class="keyword">inline</span> <span class="keyword">val</span> max2 <span class="keyword">inline</span> <span class="keyword">get</span>() = <span class="built_in">Int</span>.MAX_VALUE <span class="comment">//ç¼–è¯‘ä¹Ÿok ã€‚ã€‚ã€‚</span></div><div class="line"></div><div class="line"><span class="comment">//Inline property cannot have backing field</span></div><div class="line"><span class="keyword">var</span> count = <span class="number">0</span></div><div class="line"><span class="keyword">var</span> counter</div><div class="line"><span class="keyword">inline</span> <span class="keyword">get</span>() = count <span class="comment">//set/get å…¶ä¸­ä¸€ä¸ªæ ‡æ³¨ä¸ºinline, éƒ½ä¸èƒ½ä½¿ç”¨ backing field</span></div><div class="line"><span class="keyword">inline</span> <span class="keyword">set</span>(value) &#123;</div><div class="line">  count = value</div><div class="line">&#125;</div><div class="line"><span class="comment">//</span></div><div class="line"><span class="keyword">inline</span> <span class="keyword">var</span> doubleCounter</div><div class="line"><span class="keyword">get</span>() = count * <span class="number">2</span> <span class="comment">//set/get å…¶ä¸­ä¸€ä¸ªæ ‡æ³¨ä¸ºinline, éƒ½ä¸èƒ½ä½¿ç”¨ backing field</span></div><div class="line"><span class="keyword">set</span>(value) &#123;</div><div class="line">  count *= value</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="å…¬æœ‰-API-å†…è”å‡½æ•°çš„é™åˆ¶"><a href="#å…¬æœ‰-API-å†…è”å‡½æ•°çš„é™åˆ¶" class="headerlink" title="å…¬æœ‰ API å†…è”å‡½æ•°çš„é™åˆ¶"></a>å…¬æœ‰ API å†…è”å‡½æ•°çš„é™åˆ¶</h4><p>å½“ä¸€ä¸ªå†…è”å‡½æ•°æ˜¯ <code>public</code> æˆ– <code>protected</code> è€Œä¸æ˜¯ <code>private</code> æˆ– <code>internal</code> å£°æ˜çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œå°±ä¼šè®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ª<a href="https://www.kotlincn.net/docs/reference/visibility-modifiers.html#æ¨¡å—" target="_blank" rel="external">æ¨¡å—çº§</a>çš„å…¬æœ‰ APIã€‚å¯ä»¥åœ¨å…¶ä»–æ¨¡å—ä¸­è°ƒç”¨å®ƒï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨å¤„å†…è”è¿™æ ·çš„è°ƒç”¨ã€‚</p><p>è¿™å¸¦æ¥äº†ä¸€äº›ç”±æ¨¡å—åšè¿™æ ·å˜æ›´æ—¶å¯¼è‡´çš„äºŒè¿›åˆ¶å…¼å®¹çš„é£é™©â€”â€”å£°æ˜ä¸€ä¸ªå†…è”å‡½æ•°ä½†è°ƒç”¨å®ƒçš„æ¨¡å—åœ¨å®ƒä¿®æ”¹åå¹¶æ²¡æœ‰é‡æ–°ç¼–è¯‘ã€‚</p><p>ä¸ºäº†æ¶ˆé™¤è¿™ç§ç”±<strong>é</strong>å…¬æœ‰ API å˜æ›´å¼•å…¥çš„ä¸å…¼å®¹çš„é£é™©ï¼Œå…¬æœ‰ API å†…è”å‡½æ•°ä½“å†…ä¸å…è®¸ä½¿ç”¨éå…¬æœ‰å£°æ˜ï¼Œå³ï¼Œä¸å…è®¸ä½¿ç”¨ <code>private</code> ä¸ <code>internal</code> å£°æ˜ä»¥åŠå…¶éƒ¨ä»¶ã€‚</p><p>ä¸€ä¸ª <code>internal</code> å£°æ˜å¯ä»¥ç”± <code>@PublishedApi</code> æ ‡æ³¨ï¼Œè¿™ä¼šå…è®¸å®ƒåœ¨å…¬æœ‰ API å†…è”å‡½æ•°ä¸­ä½¿ç”¨ã€‚å½“ä¸€ä¸ª <code>internal</code> å†…è”å‡½æ•°æ ‡è®°æœ‰ <code>@PublishedApi</code> æ—¶ï¼Œä¹Ÿä¼šåƒå…¬æœ‰å‡½æ•°ä¸€æ ·æ£€æŸ¥å…¶å‡½æ•°ä½“ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å…¬æœ‰ API å†…è”å‡½æ•°é™åˆ¶ä½¿ç”¨private ä¸ internal å£°æ˜ä»¥åŠå…¶éƒ¨ä»¶ ï¼ˆé¡¶å±‚å£°æ˜ï¼‰</span></div><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">publishApi</span><span class="params">(body: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">    privateFun()</div><div class="line">    internalFun()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@PublishedApi</span> <span class="comment">//æ£€æŸ¥å…¶å‡½æ•°ä½“åŠ ä»¥é™åˆ¶</span></div><div class="line"><span class="keyword">internal</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">internalApi</span><span class="params">(body: ()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">    privateFun()</div><div class="line">    internalFun()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">privateFun</span><span class="params">()</span></span>: <span class="built_in">Unit</span> &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> <span class="title">internalFun</span><span class="params">()</span></span>: <span class="built_in">Unit</span> &#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Kotlinä¸-Java-æ··åˆå¼€å‘"><a href="#Kotlinä¸-Java-æ··åˆå¼€å‘" class="headerlink" title="Kotlinä¸ Java æ··åˆå¼€å‘"></a>Kotlinä¸ Java æ··åˆå¼€å‘</h2><h3 id="Kotlin-ä¸­è°ƒç”¨-Java"><a href="#Kotlin-ä¸­è°ƒç”¨-Java" class="headerlink" title="Kotlin ä¸­è°ƒç”¨ Java"></a>Kotlin ä¸­è°ƒç”¨ Java</h3><h4 id="å·²æ˜ å°„ç±»å‹"><a href="#å·²æ˜ å°„ç±»å‹" class="headerlink" title="å·²æ˜ å°„ç±»å‹"></a>å·²æ˜ å°„ç±»å‹</h4><p>åœ¨Kotlin ä¸­ä½¿ç”¨Java ä»£ç ï¼Œç¼–è¯‘æœŸé—´ï¼Œ Java çš„åŸç”Ÿç±»å‹æ˜ å°„åˆ°ç›¸åº”çš„ Kotlin ç±»å‹ï¼Œè¿è¡Œæ—¶è¡¨ç¤ºä¿æŒä¸å˜ã€‚</p><table><thead><tr><th><strong>Kotlin ç±»å‹</strong></th><th><strong>Java ç±»å‹</strong></th></tr></thead><tbody><tr><td>kotlin.Byte</td><td>byte</td></tr><tr><td>kotlin.Short</td><td>short</td></tr><tr><td>kotlin.Int</td><td>int</td></tr><tr><td>kotlin.Long</td><td>long</td></tr><tr><td>kotlin.Char</td><td>char</td></tr><tr><td>kotlin.Float</td><td>float</td></tr><tr><td>kotlin.Double</td><td>double</td></tr><tr><td>kotlin.Boolean</td><td>boolean</td></tr></tbody></table><p>Java çš„è£…ç®±åŸå§‹ç±»å‹æ˜ å°„åˆ°å¯ç©ºçš„ Kotlin ç±»å‹ï¼š</p><table><thead><tr><th><strong>Kotlin ç±»å‹</strong></th><th><strong>Java ç±»å‹</strong></th></tr></thead><tbody><tr><td>kotlin.Byte?</td><td>java.lang.Byte</td></tr><tr><td>kotlin.Shortï¼Ÿ</td><td>java.lang. Short</td></tr><tr><td>kotlin.Int?</td><td>java.lang.Integer</td></tr><tr><td>kotlin.Long?</td><td>java.lang.Long</td></tr><tr><td>kotlin.Char?</td><td>java.lang.Character</td></tr><tr><td>kotlin.Float?</td><td>java.lang.Float</td></tr><tr><td>kotlin.Double?</td><td>java.lang.Double</td></tr><tr><td>kotlin.Boolean?</td><td>java.lang. Boolean</td></tr></tbody></table><p>ä¸€äº›éåŸç”Ÿçš„å†…ç½®ç±»å‹ä¹Ÿä¼šä½œæ˜ å°„ï¼š</p><table><thead><tr><th><strong>Kotlin ç±»å‹</strong></th><th><strong>Java ç±»å‹</strong></th></tr></thead><tbody><tr><td>kotlin.Any!</td><td>java.lang.Object</td></tr><tr><td>kotlin.Cloneable!</td><td>java.lang.Cloneable</td></tr><tr><td>kotlin.Comparable!</td><td>java.lang.Comparable</td></tr><tr><td>kotlin.Enum!</td><td>java.lang.Enum</td></tr><tr><td>kotlin.Annotation!</td><td>java.lang.Annotation</td></tr><tr><td>kotlin.Deprecated!</td><td>java.lang.Deprecated</td></tr><tr><td>kotlin.CharSequence!</td><td>java.lang.CharSequence</td></tr><tr><td>kotlin.String!</td><td>java.lang.String</td></tr><tr><td>kotlin.Number!</td><td>java.lang.Number</td></tr><tr><td>kotlin.Throwable!</td><td>java.lang.Throwable</td></tr></tbody></table><p>NOTE: <code>String!</code> ä¸º<a href="#ç©ºå®‰å…¨å’Œå¹³å°ç±»å‹">å¹³å°ç±»å‹è¡¨ç¤ºæ³•</a></p><p>é›†åˆç±»å‹åœ¨ Kotlin ä¸­å¯ä»¥æ˜¯åªè¯»çš„æˆ–å¯å˜çš„ï¼Œå› æ­¤ Java é›†åˆç±»å‹ä½œå¦‚ä¸‹æ˜ å°„ï¼š ï¼ˆä¸‹è¡¨ä¸­çš„æ‰€æœ‰ Kotlin ç±»å‹éƒ½é©»ç•™åœ¨ <code>kotlin.collections</code>åŒ…ä¸­ï¼‰:</p><table><thead><tr><th>Java ç±»å‹</th><th>Kotlin åªè¯»ç±»å‹</th><th>Kotlin å¯å˜ç±»å‹</th><th>åŠ è½½çš„å¹³å°ç±»å‹</th></tr></thead><tbody><tr><td>Iterator<t></t></td><td>Iterator<t></t></td><td>MutableIterator<t></t></td><td>(Mutable)Iterator<t>!</t></td></tr><tr><td>Iterable<t></t></td><td>Iterable<t></t></td><td>MutableIterable<t></t></td><td>(Mutable)Iterable<t>!</t></td></tr><tr><td>Collection<t></t></td><td>Collection<t></t></td><td>MutableCollection<t></t></td><td>(Mutable)Collection<t>!</t></td></tr><tr><td>Set<t></t></td><td>Set<t></t></td><td>MutableSet<t></t></td><td>(Mutable)Set<t>!</t></td></tr><tr><td>List<t></t></td><td>List<t></t></td><td>MutableList<t></t></td><td>(Mutable)List<t>!</t></td></tr><tr><td>ListIterator<t></t></td><td>ListIterator<t></t></td><td>MutableListIterator<t></t></td><td>(Mutable)ListIterator<t>!</t></td></tr><tr><td>Map<k, v=""></k,></td><td>Map<k, v=""></k,></td><td>MutableMap<k, v=""></k,></td><td>(Mutable)Map<k, v="">!</k,></td></tr><tr><td>Map.Entry<k, v=""></k,></td><td>Map.Entry<k, v=""></k,></td><td>MutableMap.MutableEntry<k,v></k,v></td><td>(Mutable)Map.(Mutable)Entry<k, v="">!</k,></td></tr></tbody></table><p>è¯·æ³¨æ„ï¼Œç”¨ä½œç±»å‹å‚æ•°çš„è£…ç®±åŸå§‹ç±»å‹æ˜ å°„åˆ°å¹³å°ç±»å‹ï¼š ä¾‹å¦‚ï¼Œ<code>List&lt;java.lang.Integer&gt;</code> åœ¨ Kotlin ä¸­ä¼šæˆä¸º <code>List&lt;Int!&gt;</code>ã€‚</p><p>Java çš„æ•°ç»„æŒ‰å¦‚ä¸‹æ‰€è¿°æ˜ å°„ï¼š</p><table><thead><tr><th><strong>Java ç±»å‹</strong></th><th><strong>Kotlin ç±»å‹</strong></th></tr></thead><tbody><tr><td>int[]</td><td>kotlin.IntArray!</td></tr><tr><td>String[]</td><td>kotlin.Array&lt;(out) String&gt;!</td></tr></tbody></table><h4 id="ç©ºå®‰å…¨å’Œå¹³å°ç±»å‹"><a href="#ç©ºå®‰å…¨å’Œå¹³å°ç±»å‹" class="headerlink" title="ç©ºå®‰å…¨å’Œå¹³å°ç±»å‹"></a>ç©ºå®‰å…¨å’Œå¹³å°ç±»å‹</h4><p>Java ä¸­ä»»ä½•å¼•ç”¨éƒ½å¯èƒ½æ˜¯ <code>null</code>ï¼Œè€ŒKotlin ç±»å‹å®‰å…¨(ç©ºå®‰å…¨)ã€‚ Java å£°æ˜çš„ç±»å‹åœ¨ Kotlin ä¸­ç©ºæ£€æŸ¥è·ŸJavaç›¸åŒ(å¯ç©ºï¼Œéç©º)ç§°ä¸º<strong>å¹³å°ç±»å‹</strong>ã€‚å¹³å°ç±»å‹å¯ç”¨åŠ©è®°ç¬¦<code>ï¼</code>åŠ åœ¨åé¢æ¥è¡¨ç¤º,ä½†åˆ‡è®°ä¸èƒ½åœ¨ç¨‹åºä¸­è¿™æ ·å†™ï¼Œkotlin å¹¶æ²¡æœ‰ç›¸åº”è¯­æ³•,IDE Doc å¯ä»¥æ˜¾ç¤ºã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> nullAny = JavaDataType.nullObj <span class="comment">//å®é™…: val nullAny: Any!</span></div><div class="line"><span class="keyword">val</span> safeNullAny: Any? = JavaDataType.nullObj</div><div class="line"></div><div class="line">println(safeNullAny?.hashCode())</div><div class="line">println(nullAny?.hashCode()) <span class="comment">//null check</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> notNullAny: Any = JavaDataType.nullObj <span class="comment">//èµ‹å€¼æ—¶ NPE</span></div><div class="line">nullAny.hashCode() <span class="comment">//ä½¿ç”¨æ—¶ NPE</span></div></pre></td></tr></table></figure><p>NOTEï¼šåªè¦ä¸æ˜¯JavaåŸºæœ¬ç±»å‹,åœ¨Kotlinä¸­éƒ½ä¼šæ˜ å°„ä¸º <code>T!</code></p><h4 id="Getter-å’Œ-Setter"><a href="#Getter-å’Œ-Setter" class="headerlink" title="Getter å’Œ Setter"></a>Getter å’Œ Setter</h4><p>éµå¾ª Java çº¦å®šçš„ getter å’Œ setter çš„æ–¹æ³•ï¼ˆåç§°ä»¥ <code>get</code> å¼€å¤´çš„æ— å‚æ•°æ–¹æ³•å’Œä»¥ <code>set</code> å¼€å¤´çš„å•å‚æ•°æ–¹æ³•ï¼‰åœ¨ Kotlin ä¸­è¡¨ç¤ºä¸ºå±æ€§ã€‚ <code>Boolean</code> è®¿é—®å™¨æ–¹æ³•ï¼ˆå…¶ä¸­ getter çš„åç§°ä»¥ <code>is</code> å¼€å¤´è€Œ setter çš„åç§°ä»¥ <code>set</code> å¼€å¤´ï¼‰ä¼šè¡¨ç¤ºä¸ºä¸ getter æ–¹æ³•å…·æœ‰ç›¸åŒåç§°çš„å±æ€§ã€‚ ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">import java.util.Calendar</div><div class="line"></div><div class="line">fun calendarDemo() &#123;</div><div class="line">    val calendar = Calendar.getInstance()</div><div class="line">    if (calendar.firstDayOfWeek == Calendar.SUNDAY) &#123;  // è°ƒç”¨ getFirstDayOfWeek()</div><div class="line">        calendar.firstDayOfWeek = Calendar.MONDAY      // è°ƒç”¨ll setFirstDayOfWeek()</div><div class="line">    &#125;</div><div class="line">    if (!calendar.isLenient) &#123;                         // è°ƒç”¨ isLenient()</div><div class="line">        calendar.isLenient = true                      // è°ƒç”¨ setLenient()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œå¦‚æœ Java ç±»åªæœ‰ä¸€ä¸ª setterï¼Œå®ƒåœ¨ Kotlin ä¸­ä¸ä¼šä½œä¸ºå±æ€§å¯è§ï¼Œå› ä¸º Kotlin ç›®å‰ä¸æ”¯æŒåªå†™ï¼ˆset-onlyï¼‰å±æ€§ã€‚</p><h4 id="è¿”å›-void-çš„æ–¹æ³•"><a href="#è¿”å›-void-çš„æ–¹æ³•" class="headerlink" title="è¿”å› void çš„æ–¹æ³•"></a>è¿”å› void çš„æ–¹æ³•</h4><p>å¦‚æœä¸€ä¸ª Java æ–¹æ³•è¿”å› voidï¼Œé‚£ä¹ˆä» Kotlin è°ƒç”¨æ—¶ä¸­è¿”å› <code>Unit</code>ã€‚ ä¸‡ä¸€æœ‰äººä½¿ç”¨å…¶è¿”å›å€¼ï¼Œå®ƒå°†ç”± Kotlin ç¼–è¯‘å™¨åœ¨è°ƒç”¨å¤„èµ‹å€¼ï¼Œ å› ä¸ºè¯¥å€¼æœ¬èº«æ˜¯é¢„å…ˆçŸ¥é“çš„ï¼ˆæ˜¯ <code>Unit</code>ï¼‰ã€‚</p><h4 id="å°†-Kotlin-ä¸­æ˜¯å…³é”®å­—çš„-Java-æ ‡è¯†ç¬¦è¿›è¡Œè½¬ä¹‰"><a href="#å°†-Kotlin-ä¸­æ˜¯å…³é”®å­—çš„-Java-æ ‡è¯†ç¬¦è¿›è¡Œè½¬ä¹‰" class="headerlink" title="å°† Kotlin ä¸­æ˜¯å…³é”®å­—çš„ Java æ ‡è¯†ç¬¦è¿›è¡Œè½¬ä¹‰"></a>å°† Kotlin ä¸­æ˜¯å…³é”®å­—çš„ Java æ ‡è¯†ç¬¦è¿›è¡Œè½¬ä¹‰</h4><p>ä¸€äº› Kotlin å…³é”®å­—åœ¨ Java ä¸­æ˜¯æœ‰æ•ˆæ ‡è¯†ç¬¦ï¼š<em>in</em>ã€ <em>object</em>ã€ <em>is</em> ç­‰ç­‰ã€‚ å¦‚æœä¸€ä¸ª Java åº“ä½¿ç”¨äº† Kotlin å…³é”®å­—ä½œä¸ºæ–¹æ³•ï¼Œä½ ä»ç„¶å¯ä»¥é€šè¿‡åå¼•å·ï¼ˆ`ï¼‰å­—ç¬¦è½¬ä¹‰å®ƒæ¥è°ƒç”¨è¯¥æ–¹æ³•</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">foo.`<span class="keyword">is</span>`(bar)</div></pre></td></tr></table></figure><h4 id="Java-æ³›å‹"><a href="#Java-æ³›å‹" class="headerlink" title="Java æ³›å‹"></a>Java æ³›å‹</h4><p>Kotlin çš„æ³›å‹ä¸ Java æœ‰ç‚¹ä¸åŒï¼ˆå‚è§<a href="https://www.kotlincn.net/docs/reference/generics.html" target="_blank" rel="external">æ³›å‹</a>ï¼‰ã€‚å½“å°† Java ç±»å‹å¯¼å…¥ Kotlin æ—¶ï¼Œæˆ‘ä»¬ä¼šæ‰§è¡Œä¸€äº›è½¬æ¢ï¼š</p><ul><li>Java çš„é€šé…ç¬¦è½¬æ¢æˆç±»å‹æŠ•å½±<ul><li><code>Foo&lt;? extends Bar&gt;</code> è½¬æ¢æˆ <code>Foo&lt;out Bar!&gt;!</code></li><li><code>Foo&lt;? super Bar&gt;</code> è½¬æ¢æˆ <code>Foo&lt;in Bar!&gt;!</code></li></ul></li><li>Javaçš„åŸå§‹ç±»å‹è½¬æ¢æˆæ˜ŸæŠ•å½±<ul><li><code>List</code> è½¬æ¢æˆ <code>List&lt;*&gt;!</code>ï¼Œå³ <code>List&lt;out Any?&gt;!</code></li></ul></li></ul><p>å’Œ Java ä¸€æ ·ï¼ŒKotlin åœ¨è¿è¡Œæ—¶ä¸ä¿ç•™æ³›å‹ï¼Œå³å¯¹è±¡ä¸æºå¸¦ä¼ é€’åˆ°ä»–ä»¬æ„é€ å™¨ä¸­çš„é‚£äº›ç±»å‹å‚æ•°çš„å®é™…ç±»å‹ã€‚ å³ <code>ArrayList&lt;Integer&gt;()</code> å’Œ <code>ArrayList&lt;Character&gt;()</code> æ˜¯ä¸èƒ½åŒºåˆ†çš„ã€‚ è¿™ä½¿å¾—æ‰§è¡Œ <em>is</em>-æ£€æµ‹ä¸å¯èƒ½ç…§é¡¾åˆ°æ³›å‹ã€‚ Kotlin åªå…è®¸ <em>is</em>-æ£€æµ‹æ˜ŸæŠ•å½±çš„æ³›å‹ç±»å‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> List&lt;<span class="built_in">Int</span>&gt;) <span class="comment">// é”™è¯¯ï¼šæ— æ³•æ£€æŸ¥å®ƒæ˜¯å¦çœŸçš„æ˜¯ä¸€ä¸ª Int åˆ—è¡¨</span></div><div class="line"><span class="comment">// but</span></div><div class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> List&lt;*&gt;) <span class="comment">// OKï¼šä¸ä¿è¯åˆ—è¡¨çš„å†…å®¹</span></div></pre></td></tr></table></figure><h4 id="Java-é›†åˆ"><a href="#Java-é›†åˆ" class="headerlink" title="Java é›†åˆ"></a>Java é›†åˆ</h4><p>java é›†åˆç±»å‹æ˜ å°„çš„å¹³å°ç±»å‹éƒ½æ˜¯å¯å˜çš„ï¼Œç”¨æ³•å¦‚kotlin ä¸€æ ·ï¼Œè€Œä¸” æ“ä½œç¬¦çº¦å®šåŒæ ·æœ‰æ•ˆ</p><h4 id="Java-æ•°ç»„"><a href="#Java-æ•°ç»„" class="headerlink" title="Java æ•°ç»„"></a>Java æ•°ç»„</h4><p>ä¸ Java ä¸åŒï¼ŒKotlin ä¸­çš„æ•°ç»„æ˜¯ä¸å‹å˜çš„ã€‚è¿™æ„å‘³ç€ Kotlin ä¸å…è®¸æˆ‘ä»¬æŠŠä¸€ä¸ª <code>Array&lt;String&gt;</code> èµ‹å€¼ç»™ä¸€ä¸ª <code>Array&lt;Any&gt;</code>ï¼Œ ä»è€Œé¿å…äº†å¯èƒ½çš„è¿è¡Œæ—¶æ•…éšœã€‚Kotlin ä¹Ÿç¦æ­¢æˆ‘ä»¬æŠŠä¸€ä¸ªå­ç±»çš„æ•°ç»„å½“åšè¶…ç±»çš„æ•°ç»„ä¼ é€’ç»™ Kotlin çš„æ–¹æ³•ï¼Œ ä½†æ˜¯å¯¹äº Java æ–¹æ³•ï¼Œè¿™æ˜¯å…è®¸çš„ï¼ˆé€šè¿‡ <code>Array&lt;(out) String&gt;!</code> è¿™ç§å½¢å¼çš„<a href="https://www.kotlincn.net/docs/reference/java-interop.html#ç©ºå®‰å…¨å’Œå¹³å°ç±»å‹" target="_blank" rel="external">å¹³å°ç±»å‹</a>ï¼‰ã€‚</p><p>Java å¹³å°ä¸Šï¼Œæ•°ç»„ä¼šä½¿ç”¨åŸç”Ÿæ•°æ®ç±»å‹ä»¥é¿å…è£…ç®±/æ‹†ç®±æ“ä½œçš„å¼€é”€ã€‚ ç”±äº Kotlin éšè—äº†è¿™äº›å®ç°ç»†èŠ‚ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªå˜é€šæ–¹æ³•æ¥ä¸ Java ä»£ç è¿›è¡Œäº¤äº’ã€‚ å¯¹äºæ¯ç§åŸç”Ÿç±»å‹çš„æ•°ç»„éƒ½æœ‰ä¸€ä¸ªç‰¹åŒ–çš„ç±»ï¼ˆ<code>IntArray</code>ã€ <code>DoubleArray</code>ã€ <code>CharArray</code> ç­‰ç­‰ï¼‰æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚ å®ƒä»¬ä¸ <code>Array</code> ç±»æ— å…³ï¼Œå¹¶ä¸”ä¼šç¼–è¯‘æˆ Java åŸç”Ÿç±»å‹æ•°ç»„ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªæ¥å— int æ•°ç»„ç´¢å¼•çš„ Java æ–¹æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaArrayExample</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> void removeIndices(int[] indices) &#123;</div><div class="line">        <span class="comment">// åœ¨æ­¤ç¼–ç â€¦â€¦</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨ Kotlin ä¸­ä½ å¯ä»¥è¿™æ ·ä¼ é€’ä¸€ä¸ªåŸç”Ÿç±»å‹çš„æ•°ç»„ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> javaObj = JavaArrayExample()</div><div class="line"><span class="keyword">val</span> array = intArrayOf(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">javaObj.removeIndices(array)  <span class="comment">// å°† int[] ä¼ ç»™æ–¹æ³•</span></div></pre></td></tr></table></figure><p>å½“ç¼–è¯‘ä¸º JVM å­—èŠ‚ä»£ç æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¼˜åŒ–å¯¹æ•°ç»„çš„è®¿é—®ï¼Œè¿™æ ·å°±ä¸ä¼šå¼•å…¥ä»»ä½•å¼€é”€ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> array = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">array[x] = array[x] * <span class="number">2</span> <span class="comment">// ä¸ä¼šå®é™…ç”Ÿæˆå¯¹ get() å’Œ set() çš„è°ƒç”¨</span></div><div class="line"><span class="keyword">for</span> (x <span class="keyword">in</span> array) &#123; <span class="comment">// ä¸ä¼šåˆ›å»ºè¿­ä»£å™¨</span></div><div class="line">    print(x)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å³ä½¿å½“æˆ‘ä»¬ä½¿ç”¨ç´¢å¼•å®šä½æ—¶ï¼Œä¹Ÿä¸ä¼šå¼•å…¥ä»»ä½•å¼€é”€</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> array.indices) &#123;<span class="comment">// ä¸ä¼šåˆ›å»ºè¿­ä»£å™¨</span></div><div class="line">    array[i] += <span class="number">2</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æœ€åï¼Œ<em>in</em>-æ£€æµ‹ä¹Ÿæ²¡æœ‰é¢å¤–å¼€é”€</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (i <span class="keyword">in</span> array.indices) &#123; <span class="comment">// åŒ (i &gt;= 0 &amp;&amp; i &lt; array.size)</span></div><div class="line">    print(array[i])</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Java-å¯å˜å‚æ•°"><a href="#Java-å¯å˜å‚æ•°" class="headerlink" title="Java å¯å˜å‚æ•°"></a>Java å¯å˜å‚æ•°</h4><p>Java ç±»æœ‰æ—¶å£°æ˜ä¸€ä¸ªå…·æœ‰å¯å˜æ•°é‡å‚æ•°ï¼ˆvarargsï¼‰çš„æ–¹æ³•æ¥ä½¿ç”¨ç´¢å¼•ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaArrayExample</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> void removeIndicesVarArg(int... indices) &#123;</div><div class="line">        <span class="comment">// åœ¨æ­¤ç¼–ç â€¦â€¦</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ <code>*</code> æ¥ä¼ é€’ <code>IntArray</code>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> javaObj = JavaArrayExample()</div><div class="line"><span class="keyword">val</span> array = intArrayOf(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">javaObj.removeIndicesVarArg(*array)</div></pre></td></tr></table></figure><p>ç›®å‰æ— æ³•ä¼ é€’ <strong>null</strong> ç»™ä¸€ä¸ªå£°æ˜ä¸ºå¯å˜å‚æ•°çš„æ–¹æ³•ã€‚</p><h4 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="æ“ä½œç¬¦"></a>æ“ä½œç¬¦</h4><p>ç”±äº Java æ— æ³•æ ‡è®°ç”¨äºè¿ç®—ç¬¦è¯­æ³•çš„æ–¹æ³•ï¼ŒKotlin å…è®¸å…·æœ‰æ­£ç¡®åç§°å’Œç­¾åçš„ä»»ä½• Java æ–¹æ³•ä½œä¸ºè¿ç®—ç¬¦é‡è½½å’Œå…¶ä»–çº¦å®šï¼ˆ<code>invoke()</code> ç­‰ï¼‰ä½¿ç”¨ã€‚ ä¸å…è®¸ä½¿ç”¨ä¸­ç¼€è°ƒç”¨è¯­æ³•è°ƒç”¨ Java æ–¹æ³•ã€‚</p><h4 id="å—æ£€å¼‚å¸¸"><a href="#å—æ£€å¼‚å¸¸" class="headerlink" title="å—æ£€å¼‚å¸¸"></a>å—æ£€å¼‚å¸¸</h4><p>åœ¨ Kotlin ä¸­ï¼Œæ‰€æœ‰å¼‚å¸¸éƒ½æ˜¯éå—æ£€çš„ï¼Œè¿™æ„å‘³ç€ç¼–è¯‘å™¨ä¸ä¼šå¼ºè¿«ä½ æ•è·å…¶ä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚ å› æ­¤ï¼Œå½“ä½ è°ƒç”¨ä¸€ä¸ªå£°æ˜å—æ£€å¼‚å¸¸çš„ Java æ–¹æ³•æ—¶ï¼ŒKotlin ä¸ä¼šå¼ºè¿«ä½ åšä»»ä½•äº‹æƒ…ï¼š</p><h4 id="å¯¹è±¡æ–¹æ³•"><a href="#å¯¹è±¡æ–¹æ³•" class="headerlink" title="å¯¹è±¡æ–¹æ³•"></a>å¯¹è±¡æ–¹æ³•</h4><p>å½“ Java ç±»å‹å¯¼å…¥åˆ° Kotlin ä¸­æ—¶ï¼Œç±»å‹ <code>java.lang.Object</code> çš„æ‰€æœ‰å¼•ç”¨éƒ½æˆäº† <code>Any</code>ã€‚ è€Œå› ä¸º <code>Any</code> ä¸æ˜¯å¹³å°æŒ‡å®šçš„ï¼Œå®ƒåªå£°æ˜äº† <code>toString()</code>ã€<code>hashCode()</code> å’Œ <code>equals()</code> ä½œä¸ºå…¶æˆå‘˜ï¼Œ æ‰€ä»¥ä¸ºäº†èƒ½ç”¨åˆ° <code>java.lang.Object</code> çš„å…¶ä»–æˆå‘˜ï¼ŒKotlin è¦ç”¨åˆ°<a href="#æ‰©å±•å‡½æ•°">æ‰©å±•å‡½æ•°</a>ã€‚</p><h5 id="wait-notify"><a href="#wait-notify" class="headerlink" title="wait()/notify()"></a>wait()/notify()</h5><p><a href="http://www.oracle.com/technetwork/java/effectivejava-136174.html" target="_blank" rel="external">Effective Java</a> ç¬¬ 69 æ¡å–„æ„åœ°å»ºè®®ä¼˜å…ˆä½¿ç”¨å¹¶å‘å·¥å…·ï¼ˆconcurrency utilitiesï¼‰è€Œä¸æ˜¯ <code>wait()</code> å’Œ <code>notify()</code>ã€‚ å› æ­¤ï¼Œç±»å‹ <code>Any</code> çš„å¼•ç”¨ä¸æä¾›è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ å¦‚æœä½ çœŸçš„éœ€è¦è°ƒç”¨å®ƒä»¬çš„è¯ï¼Œä½ å¯ä»¥å°†å…¶è½¬æ¢ä¸º <code>java.lang.Object</code>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(foo <span class="keyword">as</span> java.lang.Object).wait()</div></pre></td></tr></table></figure><h5 id="getClass"><a href="#getClass" class="headerlink" title="getClass()"></a>getClass()</h5><p>è¦å–å¾—å¯¹è±¡çš„ Java ç±»ï¼Œè¯·åœ¨<a href="https://www.kotlincn.net/docs/reference/reflection.html#ç±»å¼•ç”¨" target="_blank" rel="external">ç±»å¼•ç”¨</a>ä¸Šä½¿ç”¨ <code>java</code> æ‰©å±•å±æ€§ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> fooClass = foo::<span class="class"><span class="keyword">class</span>.<span class="title">java</span></span></div></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨äº†è‡ª Kotlin 1.1 èµ·æ”¯æŒçš„<a href="https://www.kotlincn.net/docs/reference/reflection.html#ç»‘å®šçš„ç±»å¼•ç”¨è‡ª-11-èµ·" target="_blank" rel="external">ç»‘å®šçš„ç±»å¼•ç”¨</a>ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>javaClass</code> æ‰©å±•å±æ€§ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> fooClass = foo.javaClass</div></pre></td></tr></table></figure><h5 id="clone"><a href="#clone" class="headerlink" title="clone()"></a>clone()</h5><p>è¦è¦†ç›– <code>clone()</code>ï¼Œéœ€è¦ç»§æ‰¿ <code>kotlin.Cloneable</code>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> : <span class="type">Cloneable &#123;</span></span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">clone</span><span class="params">()</span></span>: Any &#123; â€¦â€¦ &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸è¦å¿˜è®° <a href="http://www.oracle.com/technetwork/java/effectivejava-136174.html" target="_blank" rel="external">Effective Java</a> çš„ç¬¬ 11 æ¡: <em>è°¨æ…åœ°æ”¹å†™clone</em>ã€‚</p><h5 id="finalize"><a href="#finalize" class="headerlink" title="finalize()"></a>finalize()</h5><p>è¦è¦†ç›– <code>finalize()</code>ï¼Œæ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯ç®€å•åœ°å£°æ˜å®ƒï¼Œè€Œä¸éœ€è¦ <em>override</em> å…³é”®å­—ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="title">finalize</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="comment">// ç»ˆæ­¢åŒ–é€»è¾‘</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ ¹æ® Java çš„è§„åˆ™ï¼Œ<code>finalize()</code> ä¸èƒ½æ˜¯ <em>private</em> çš„ã€‚</p><p>#### </p><h4 id="è®¿é—®é™æ€æˆå‘˜"><a href="#è®¿é—®é™æ€æˆå‘˜" class="headerlink" title="è®¿é—®é™æ€æˆå‘˜"></a>è®¿é—®é™æ€æˆå‘˜</h4><p>Java ç±»çš„é™æ€æˆå‘˜ä¼šå½¢æˆè¯¥ç±»çš„â€œä¼´ç”Ÿå¯¹è±¡â€ã€‚æˆ‘ä»¬æ— æ³•å°†è¿™æ ·çš„â€œä¼´ç”Ÿå¯¹è±¡â€ä½œä¸ºå€¼æ¥ä¼ é€’ï¼Œ ä½†å¯ä»¥æ˜¾å¼è®¿é—®å…¶æˆå‘˜ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> character = Character</div><div class="line"><span class="keyword">if</span> (Character.isLetter(<span class="string">'A'</span>)) &#123;</div><div class="line">  <span class="comment">// â€¦â€¦</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Java-åå°„"><a href="#Java-åå°„" class="headerlink" title="Java åå°„"></a>Java åå°„</h4><p>Java åå°„é€‚ç”¨äº Kotlin ç±»ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>instance::class.java</code>,<code>ClassName::class.java</code> æˆ–è€… <code>instance.javaClass</code> é€šè¿‡ <code>java.lang.Class</code> æ¥è¿›å…¥ Java åå°„ã€‚</p><p>å…¶ä»–æ”¯æŒçš„æƒ…å†µåŒ…æ‹¬ä¸ºä¸€ä¸ª Kotlin å±æ€§è·å–ä¸€ä¸ª Java çš„ getter/setter æ–¹æ³•æˆ–è€…å¹•åå­—æ®µã€ä¸ºä¸€ä¸ª Java å­—æ®µè·å–ä¸€ä¸ª <code>KProperty</code>ã€ä¸ºä¸€ä¸ª <code>KFunction</code> è·å–ä¸€ä¸ª Java æ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°ï¼Œåä¹‹äº¦ç„¶ã€‚</p><h4 id="SAM-è½¬æ¢"><a href="#SAM-è½¬æ¢" class="headerlink" title="SAM è½¬æ¢"></a>SAM è½¬æ¢</h4><p>å°±åƒ Java 8 ä¸€æ ·ï¼ŒKotlin æ”¯æŒ SAM è½¬æ¢ã€‚è¿™æ„å‘³ç€ Kotlin å‡½æ•°å­—é¢å€¼å¯ä»¥è¢«è‡ªåŠ¨çš„è½¬æ¢æˆåªæœ‰ä¸€ä¸ªéé»˜è®¤æ–¹æ³•çš„ Java æ¥å£çš„å®ç°ï¼Œåªè¦è¿™ä¸ªæ–¹æ³•çš„å‚æ•°ç±»å‹èƒ½å¤Ÿä¸è¿™ä¸ª Kotlin å‡½æ•°çš„å‚æ•°ç±»å‹ç›¸åŒ¹é…ã€‚</p><p>ä½ å¯ä»¥è¿™æ ·åˆ›å»º SAM æ¥å£çš„å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">val runnable = Runnable &#123; println(&quot;This runs in a runnable&quot;) &#125;</div></pre></td></tr></table></figure><p>â€¦â€¦ä»¥åŠåœ¨æ–¹æ³•è°ƒç”¨ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">val executor = ThreadPoolExecutor()</div><div class="line">// Java ç­¾åï¼švoid execute(Runnable command)</div><div class="line">executor.execute &#123; println(&quot;This runs in a thread pool&quot;) &#125;</div></pre></td></tr></table></figure><p>å¦‚æœ Java ç±»æœ‰å¤šä¸ªæ¥å—å‡½æ•°å¼æ¥å£çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä½¿ç”¨å°† lambda è¡¨è¾¾å¼è½¬æ¢ä¸ºç‰¹å®šçš„ SAM ç±»å‹çš„é€‚é…å™¨å‡½æ•°æ¥é€‰æ‹©éœ€è¦è°ƒç”¨çš„æ–¹æ³•ã€‚è¿™äº›é€‚é…å™¨å‡½æ•°ä¹Ÿä¼šæŒ‰éœ€ç”±ç¼–è¯‘å™¨ç”Ÿæˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">executor.execute(Runnable &#123; println(&quot;This runs in a thread pool&quot;) &#125;)</div></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼ŒSAM è½¬æ¢åªé€‚ç”¨äºæ¥å£ï¼Œè€Œä¸é€‚ç”¨äºæŠ½è±¡ç±»ï¼Œå³ä½¿è¿™äº›æŠ½è±¡ç±»ä¹Ÿåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ã€‚</p><p>è¿˜è¦æ³¨æ„ï¼Œæ­¤åŠŸèƒ½åªé€‚ç”¨äº Java äº’æ“ä½œï¼›å› ä¸º Kotlin å…·æœ‰åˆé€‚çš„å‡½æ•°ç±»å‹ï¼Œæ‰€ä»¥ä¸éœ€è¦å°†å‡½æ•°è‡ªåŠ¨è½¬æ¢ä¸º Kotlin æ¥å£çš„å®ç°ï¼Œå› æ­¤ä¸å—æ”¯æŒã€‚</p><h3 id="Javaä¸­è°ƒç”¨-Kotlin"><a href="#Javaä¸­è°ƒç”¨-Kotlin" class="headerlink" title="Javaä¸­è°ƒç”¨ Kotlin"></a>Javaä¸­è°ƒç”¨ Kotlin</h3><p>Java å¯ä»¥è½»æ¾è°ƒç”¨ Kotlin ä»£ç ã€‚</p><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p>Kotlin å±æ€§ä¼šç¼–è¯‘æˆä»¥ä¸‹ Java å…ƒç´ ï¼š</p><ul><li>ä¸€ä¸ª getter æ–¹æ³•ï¼Œåç§°é€šè¿‡åŠ å‰ç¼€ <code>get</code> ç®—å‡ºï¼›</li><li>ä¸€ä¸ª setter æ–¹æ³•ï¼Œåç§°é€šè¿‡åŠ å‰ç¼€ <code>set</code> ç®—å‡ºï¼ˆåªé€‚ç”¨äº <code>var</code> å±æ€§ï¼‰ï¼›</li><li>ä¸€ä¸ªç§æœ‰å­—æ®µï¼Œä¸å±æ€§åç§°ç›¸åŒï¼ˆä»…é€‚ç”¨äºå…·æœ‰å¹•åå­—æ®µçš„å±æ€§ï¼‰ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œ<code>var firstName: String</code> ç¼–è¯‘æˆä»¥ä¸‹ Java å£°æ˜ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">private String firstName;</div><div class="line"></div><div class="line">public String getFirstName() &#123;</div><div class="line">    return firstName;</div><div class="line">&#125;</div><div class="line"></div><div class="line">public void setFirstName(String firstName) &#123;</div><div class="line">    this.firstName = firstName;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¦‚æœå±æ€§çš„åç§°ä»¥ <code>is</code> å¼€å¤´ï¼Œåˆ™ä½¿ç”¨ä¸åŒçš„åç§°æ˜ å°„è§„åˆ™ï¼šgetter çš„åç§°ä¸å±æ€§åç§°ç›¸åŒï¼Œå¹¶ä¸” setter çš„åç§°æ˜¯é€šè¿‡å°† <code>is</code> æ›¿æ¢ä¸º <code>set</code> è·å¾—ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºå±æ€§ <code>isOpen</code>ï¼Œå…¶ getter ä¼šç§°åš <code>isOpen()</code>ï¼Œè€Œå…¶ setter ä¼šç§°åš <code>setOpen()</code>ã€‚ è¿™ä¸€è§„åˆ™é€‚ç”¨äºä»»ä½•ç±»å‹çš„å±æ€§ï¼Œå¹¶ä¸ä»…é™äº <code>Boolean</code>ã€‚</p><h4 id="åŒ…çº§å‡½æ•°"><a href="#åŒ…çº§å‡½æ•°" class="headerlink" title="åŒ…çº§å‡½æ•°"></a>åŒ…çº§å‡½æ•°</h4><p>åœ¨ <code>org.foo.bar</code> åŒ…å†…çš„ <code>example.kt</code> æ–‡ä»¶ä¸­å£°æ˜çš„æ‰€æœ‰çš„å‡½æ•°å’Œå±æ€§ï¼ŒåŒ…æ‹¬æ‰©å±•å‡½æ•°ï¼Œ éƒ½ç¼–è¯‘æˆä¸€ä¸ªåä¸º <code>org.foo.bar.ExampleKt</code> çš„ Java ç±»çš„é™æ€æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// example.kt</div><div class="line">package demo</div><div class="line"></div><div class="line">class Foo</div><div class="line"></div><div class="line">fun bar() &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">new demo.Foo();</div><div class="line">demo.ExampleKt.bar();</div></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ <code>@JvmName</code> æ³¨è§£ä¿®æ”¹ç”Ÿæˆçš„ Java ç±»çš„ç±»åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">@file:JvmName(&quot;DemoUtils&quot;)</div><div class="line"></div><div class="line">package demo</div><div class="line"></div><div class="line">class Foo</div><div class="line"></div><div class="line">fun bar() &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">new demo.Foo();</div><div class="line">demo.DemoUtils.bar();</div></pre></td></tr></table></figure><p>å¦‚æœå¤šä¸ªæ–‡ä»¶ä¸­ç”Ÿæˆäº†ç›¸åŒçš„ Java ç±»åï¼ˆåŒ…åç›¸åŒå¹¶ä¸”ç±»åç›¸åŒæˆ–è€…æœ‰ç›¸åŒçš„ <code>@JvmName</code> æ³¨è§£ï¼‰é€šå¸¸æ˜¯é”™è¯¯çš„ã€‚ç„¶è€Œï¼Œç¼–è¯‘å™¨èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªå•ä¸€çš„ Java å¤–è§‚ç±»ï¼Œå®ƒå…·æœ‰æŒ‡å®šçš„åç§°ä¸”åŒ…å«æ¥è‡ªæ‰€æœ‰æ–‡ä»¶ä¸­å…·æœ‰è¯¥åç§°çš„æ‰€æœ‰å£°æ˜ã€‚ è¦å¯ç”¨ç”Ÿæˆè¿™æ ·çš„å¤–è§‚ï¼Œè¯·åœ¨æ‰€æœ‰ç›¸å…³æ–‡ä»¶ä¸­ä½¿ç”¨ @JvmMultifileClass æ³¨è§£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// oldutils.kt</div><div class="line">@file:JvmName(&quot;Utils&quot;)</div><div class="line">@file:JvmMultifileClass</div><div class="line"></div><div class="line">package demo</div><div class="line"></div><div class="line">fun foo() &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// newutils.kt</div><div class="line">@file:JvmName(&quot;Utils&quot;)</div><div class="line">@file:JvmMultifileClass</div><div class="line"></div><div class="line">package demo</div><div class="line"></div><div class="line">fun bar() &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">demo.Utils.foo();</div><div class="line">demo.Utils.bar();</div></pre></td></tr></table></figure><h4 id="å®ä¾‹å­—æ®µ"><a href="#å®ä¾‹å­—æ®µ" class="headerlink" title="å®ä¾‹å­—æ®µ"></a>å®ä¾‹å­—æ®µ</h4><p>å¦‚æœéœ€è¦åœ¨ Java ä¸­å°† Kotlin å±æ€§ä½œä¸ºå­—æ®µæš´éœ²ï¼Œé‚£å°±éœ€è¦ä½¿ç”¨ <code>@JvmField</code> æ³¨è§£å¯¹å…¶æ ‡æ³¨ã€‚ è¯¥å­—æ®µå°†å…·æœ‰ä¸åº•å±‚å±æ€§ç›¸åŒçš„å¯è§æ€§ã€‚å¦‚æœä¸€ä¸ªå±æ€§æœ‰å¹•åå­—æ®µï¼ˆbacking fieldï¼‰ã€éç§æœ‰ã€æ²¡æœ‰ <code>open</code> /<code>override</code> æˆ–è€… <code>const</code>ä¿®é¥°ç¬¦å¹¶ä¸”ä¸æ˜¯è¢«å§”æ‰˜çš„å±æ€§ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨ <code>@JvmField</code> æ³¨è§£è¯¥å±æ€§ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class C(id: String) &#123;</div><div class="line">    @JvmField val ID = id</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">class JavaClient &#123;</div><div class="line">    public String getID(C c) &#123;</div><div class="line">        return c.ID;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><a href="https://www.kotlincn.net/docs/reference/properties.html#å»¶è¿Ÿåˆå§‹åŒ–å±æ€§" target="_blank" rel="external">å»¶è¿Ÿåˆå§‹åŒ–çš„</a>å±æ€§ï¼ˆåœ¨Javaä¸­ï¼‰ä¹Ÿä¼šæš´éœ²ä¸ºå­—æ®µã€‚ è¯¥å­—æ®µçš„å¯è§æ€§ä¸ <code>lateinit</code> å±æ€§çš„ setter ç›¸åŒã€‚</p><h4 id="é™æ€å­—æ®µ"><a href="#é™æ€å­—æ®µ" class="headerlink" title="é™æ€å­—æ®µ"></a>é™æ€å­—æ®µ</h4><p>åœ¨å‘½åå¯¹è±¡æˆ–ä¼´ç”Ÿå¯¹è±¡ä¸­å£°æ˜çš„ Kotlin å±æ€§ä¼šåœ¨è¯¥å‘½åå¯¹è±¡æˆ–åŒ…å«ä¼´ç”Ÿå¯¹è±¡çš„ç±»ä¸­å…·æœ‰é™æ€å¹•åå­—æ®µã€‚</p><p>é€šå¸¸è¿™äº›å­—æ®µæ˜¯ç§æœ‰çš„ï¼Œä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€æš´éœ²å‡ºæ¥ï¼š</p><ul><li><code>@JvmField</code> æ³¨è§£ï¼›</li><li><code>lateinit</code> ä¿®é¥°ç¬¦ï¼›</li><li><code>const</code> ä¿®é¥°ç¬¦ã€‚</li></ul><p>ä½¿ç”¨ <code>@JvmField</code> æ ‡æ³¨è¿™æ ·çš„å±æ€§ä½¿å…¶æˆä¸ºä¸å±æ€§æœ¬èº«å…·æœ‰ç›¸åŒå¯è§æ€§çš„é™æ€å­—æ®µã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class Key(val value: Int) &#123;</div><div class="line">    companion object &#123;</div><div class="line">        @JvmField</div><div class="line">        val COMPARATOR: Comparator&lt;Key&gt; = compareBy&lt;Key&gt; &#123; it.value &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">Key.COMPARATOR.compare(key1, key2);</div><div class="line">// Key ç±»ä¸­çš„ public static final å­—æ®µ</div></pre></td></tr></table></figure><p>åœ¨å‘½åå¯¹è±¡æˆ–è€…ä¼´ç”Ÿå¯¹è±¡ä¸­çš„ä¸€ä¸ª<a href="https://www.kotlincn.net/docs/reference/properties.html#å»¶è¿Ÿåˆå§‹åŒ–å±æ€§" target="_blank" rel="external">å»¶è¿Ÿåˆå§‹åŒ–çš„</a>å±æ€§å…·æœ‰ä¸å±æ€§ setter ç›¸åŒå¯è§æ€§çš„é™æ€å¹•åå­—æ®µã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">object Singleton &#123;</div><div class="line">    lateinit var provider: Provider</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">Singleton.provider = new Provider();</div><div class="line">// åœ¨ Singleton ç±»ä¸­çš„ public static é-final å­—æ®µ</div></pre></td></tr></table></figure><p>ç”¨ <code>const</code> æ ‡æ³¨çš„ï¼ˆåœ¨ç±»ä¸­ä»¥åŠåœ¨é¡¶å±‚çš„ï¼‰å±æ€§åœ¨ Java ä¸­ä¼šæˆä¸ºé™æ€å­—æ®µï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// æ–‡ä»¶ example.kt</div><div class="line"></div><div class="line">object Obj &#123;</div><div class="line">    const val CONST = 1</div><div class="line">&#125;</div><div class="line"></div><div class="line">class C &#123;</div><div class="line">    companion object &#123;</div><div class="line">        const val VERSION = 9</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const val MAX = 239</div></pre></td></tr></table></figure><p>åœ¨ Java ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">int c = Obj.CONST;</div><div class="line">int d = ExampleKt.MAX;</div><div class="line">int v = C.VERSION;</div></pre></td></tr></table></figure><h4 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h4><p>å¦‚ä¸Šæ‰€è¿°ï¼ŒKotlin å°†åŒ…çº§å‡½æ•°è¡¨ç¤ºä¸ºé™æ€æ–¹æ³•ã€‚ Kotlin è¿˜å¯ä»¥ä¸ºå‘½åå¯¹è±¡æˆ–ä¼´ç”Ÿå¯¹è±¡ä¸­å®šä¹‰çš„å‡½æ•°ç”Ÿæˆé™æ€æ–¹æ³•ï¼Œå¦‚æœä½ å°†è¿™äº›å‡½æ•°æ ‡æ³¨ä¸º <code>@JvmStatic</code> çš„è¯ã€‚ å¦‚æœä½ ä½¿ç”¨è¯¥æ³¨è§£ï¼Œç¼–è¯‘å™¨æ—¢ä¼šåœ¨ç›¸åº”å¯¹è±¡çš„ç±»ä¸­ç”Ÿæˆé™æ€æ–¹æ³•ï¼Œä¹Ÿä¼šåœ¨å¯¹è±¡è‡ªèº«ä¸­ç”Ÿæˆå®ä¾‹æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class C &#123;</div><div class="line">    companion object &#123;</div><div class="line">        @JvmStatic fun foo() &#123;&#125;</div><div class="line">        fun bar() &#123;&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œ<code>foo()</code> åœ¨ Java ä¸­æ˜¯é™æ€çš„ï¼Œè€Œ <code>bar()</code> ä¸æ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">C.foo(); // æ²¡é—®é¢˜</div><div class="line">C.bar(); // é”™è¯¯ï¼šä¸æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•</div><div class="line">C.Companion.foo(); // ä¿ç•™å®ä¾‹æ–¹æ³•</div><div class="line">C.Companion.bar(); // å”¯ä¸€çš„å·¥ä½œæ–¹å¼</div></pre></td></tr></table></figure><p>å¯¹äºå‘½åå¯¹è±¡ä¹ŸåŒæ ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">object Obj &#123;</div><div class="line">    @JvmStatic fun foo() &#123;&#125;</div><div class="line">    fun bar() &#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨ Java ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Obj.foo(); // æ²¡é—®é¢˜</div><div class="line">Obj.bar(); // é”™è¯¯</div><div class="line">Obj.INSTANCE.bar(); // æ²¡é—®é¢˜ï¼Œé€šè¿‡å•ä¾‹å®ä¾‹è°ƒç”¨</div><div class="line">Obj.INSTANCE.foo(); // ä¹Ÿæ²¡é—®é¢˜</div></pre></td></tr></table></figure><p><code>@JvmStatic</code>ã€€æ³¨è§£ä¹Ÿå¯ä»¥åº”ç”¨äºå¯¹è±¡æˆ–ä¼´ç”Ÿå¯¹è±¡çš„å±æ€§ï¼Œ ä½¿å…¶ getter å’Œ setter æ–¹æ³•åœ¨è¯¥å¯¹è±¡æˆ–åŒ…å«è¯¥ä¼´ç”Ÿå¯¹è±¡çš„ç±»ä¸­æ˜¯é™æ€æˆå‘˜ã€‚</p><h4 id="å¯è§æ€§"><a href="#å¯è§æ€§" class="headerlink" title="å¯è§æ€§"></a>å¯è§æ€§</h4><p>Kotlin çš„å¯è§æ€§ä»¥ä¸‹åˆ—æ–¹å¼æ˜ å°„åˆ° Javaï¼š</p><ul><li><code>private</code> æˆå‘˜ç¼–è¯‘æˆ <code>private</code> æˆå‘˜ï¼›</li><li><code>private</code> çš„é¡¶å±‚å£°æ˜ç¼–è¯‘æˆåŒ…çº§å±€éƒ¨å£°æ˜ï¼›</li><li><code>protected</code> ä¿æŒ <code>protected</code>ï¼ˆæ³¨æ„ Java å…è®¸è®¿é—®åŒä¸€ä¸ªåŒ…ä¸­å…¶ä»–ç±»çš„å—ä¿æŠ¤æˆå‘˜ï¼Œ è€Œ Kotlin ä¸èƒ½ï¼Œæ‰€ä»¥ Java ç±»ä¼šè®¿é—®æ›´å¹¿æ³›çš„ä»£ç ï¼‰ï¼›</li><li><code>internal</code> å£°æ˜ä¼šæˆä¸º Java ä¸­çš„ <code>public</code>ã€‚<code>internal</code> ç±»çš„æˆå‘˜ä¼šé€šè¿‡åå­—ä¿®é¥°ï¼Œä½¿å…¶æ›´éš¾ä»¥åœ¨ Java ä¸­æ„å¤–ä½¿ç”¨åˆ°ï¼Œå¹¶ä¸”æ ¹æ® Kotlin è§„åˆ™ä½¿å…¶å…è®¸é‡è½½ç›¸åŒç­¾åçš„æˆå‘˜è€Œäº’ä¸å¯è§ï¼›</li><li><code>public</code> ä¿æŒ <code>public</code>ã€‚</li></ul><h4 id="KClass"><a href="#KClass" class="headerlink" title="KClass"></a>KClass</h4><p>æœ‰æ—¶ä½ éœ€è¦è°ƒç”¨æœ‰ <code>KClass</code> ç±»å‹å‚æ•°çš„ Kotlin æ–¹æ³•ã€‚ å› ä¸ºæ²¡æœ‰ä» <code>Class</code> åˆ° <code>KClass</code> çš„è‡ªåŠ¨è½¬æ¢ï¼Œæ‰€ä»¥ä½ å¿…é¡»é€šè¿‡è°ƒç”¨ <code>Class&lt;T&gt;.kotlin</code> æ‰©å±•å±æ€§çš„ç­‰ä»·å½¢å¼æ¥æ‰‹åŠ¨è¿›è¡Œè½¬æ¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kotlin.jvm.JvmClassMappingKt.getKotlinClass(MainView.class)</div></pre></td></tr></table></figure><h4 id="ç”¨-JvmName-è§£å†³ç­¾åå†²çª"><a href="#ç”¨-JvmName-è§£å†³ç­¾åå†²çª" class="headerlink" title="ç”¨ @JvmName è§£å†³ç­¾åå†²çª"></a>ç”¨ @JvmName è§£å†³ç­¾åå†²çª</h4><p>æœ‰æ—¶æˆ‘ä»¬æƒ³è®©ä¸€ä¸ª Kotlin ä¸­çš„å‘½åå‡½æ•°åœ¨å­—èŠ‚ç ä¸­æœ‰å¦å¤–ä¸€ä¸ª JVM åç§°ã€‚ æœ€çªå‡ºçš„ä¾‹å­æ˜¯ç”±äº<em>ç±»å‹æ“¦é™¤</em>å¼•å‘çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fun List&lt;String&gt;.filterValid(): List&lt;String&gt;</div><div class="line">fun List&lt;Int&gt;.filterValid(): List&lt;Int&gt;</div></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªå‡½æ•°ä¸èƒ½åŒæ—¶å®šä¹‰ï¼Œå› ä¸ºå®ƒä»¬çš„ JVM ç­¾åæ˜¯ä¸€æ ·çš„ï¼š<code>filterValid(Ljava/util/List;)Ljava/util/List;</code>ã€‚ å¦‚æœæˆ‘ä»¬çœŸçš„å¸Œæœ›å®ƒä»¬åœ¨ Kotlin ä¸­ç”¨ç›¸åŒåç§°ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ <code>@JvmName</code> å»æ ‡æ³¨å…¶ä¸­çš„ä¸€ä¸ªï¼ˆæˆ–ä¸¤ä¸ªï¼‰ï¼Œå¹¶æŒ‡å®šä¸åŒçš„åç§°ä½œä¸ºå‚æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fun List&lt;String&gt;.filterValid(): List&lt;String&gt;</div><div class="line"></div><div class="line">@JvmName(&quot;filterValidInt&quot;)</div><div class="line">fun List&lt;Int&gt;.filterValid(): List&lt;Int&gt;</div></pre></td></tr></table></figure><p>åœ¨ Kotlin ä¸­å®ƒä»¬å¯ä»¥ç”¨ç›¸åŒçš„åç§° <code>filterValid</code> æ¥è®¿é—®ï¼Œè€Œåœ¨ Java ä¸­ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ <code>filterValid</code> å’Œ <code>filterValidInt</code>ã€‚</p><p>åŒæ ·çš„æŠ€å·§ä¹Ÿé€‚ç”¨äºå±æ€§ <code>x</code> å’Œå‡½æ•° <code>getX()</code> å…±å­˜ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">val x: Int</div><div class="line">    @JvmName(&quot;getX_prop&quot;)</div><div class="line">    get() = 15</div><div class="line"></div><div class="line">fun getX() = 10</div></pre></td></tr></table></figure><h4 id="ç”Ÿæˆé‡è½½"><a href="#ç”Ÿæˆé‡è½½" class="headerlink" title="ç”Ÿæˆé‡è½½"></a>ç”Ÿæˆé‡è½½</h4><p>é€šå¸¸ï¼Œå¦‚æœä½ å†™ä¸€ä¸ªæœ‰é»˜è®¤å‚æ•°å€¼çš„ Kotlin å‡½æ•°ï¼Œåœ¨ Java ä¸­åªä¼šæœ‰ä¸€ä¸ªæ‰€æœ‰å‚æ•°éƒ½å­˜åœ¨çš„å®Œæ•´å‚æ•°ç­¾åçš„æ–¹æ³•å¯è§ï¼Œå¦‚æœå¸Œæœ›å‘ Java è°ƒç”¨è€…æš´éœ²å¤šä¸ªé‡è½½ï¼Œå¯ä»¥ä½¿ç”¨ <code>@JvmOverloads</code> æ³¨è§£ã€‚</p><p>è¯¥æ³¨è§£ä¹Ÿé€‚ç”¨äºæ„é€ å‡½æ•°ã€é™æ€æ–¹æ³•ç­‰ã€‚å®ƒä¸èƒ½ç”¨äºæŠ½è±¡æ–¹æ³•ï¼ŒåŒ…æ‹¬åœ¨æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">class Foo @JvmOverloads constructor(x: Int, y: Double = 0.0) &#123;</div><div class="line">    @JvmOverloads fun f(a: String, b: Int = 0, c: String = &quot;abc&quot;) &#123;</div><div class="line">        â€¦â€¦</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯¹äºæ¯ä¸€ä¸ªæœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªé¢å¤–çš„é‡è½½ï¼Œè¿™ä¸ªé‡è½½ä¼šæŠŠè¿™ä¸ªå‚æ•°å’Œå®ƒå³è¾¹çš„æ‰€æœ‰å‚æ•°éƒ½ç§»é™¤æ‰ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œä¼šç”Ÿæˆä»¥ä¸‹ä»£ç  ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// æ„é€ å‡½æ•°ï¼š</div><div class="line">Foo(int x, double y)</div><div class="line">Foo(int x)</div><div class="line"></div><div class="line">// æ–¹æ³•</div><div class="line">void f(String a, int b, String c) &#123; &#125;</div><div class="line">void f(String a, int b) &#123; &#125;</div><div class="line">void f(String a) &#123; &#125;</div></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œå¦‚<a href="https://www.kotlincn.net/docs/reference/classes.html#æ¬¡æ„é€ å‡½æ•°" target="_blank" rel="external">æ¬¡æ„é€ å‡½æ•°</a>ä¸­æ‰€è¿°ï¼Œå¦‚æœä¸€ä¸ªç±»çš„æ‰€æœ‰æ„é€ å‡½æ•°å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼Œé‚£ä¹ˆä¼šä¸ºå…¶ç”Ÿæˆä¸€ä¸ªå…¬æœ‰çš„æ— å‚æ„é€ å‡½æ•°ã€‚è¿™å°±ç®—æ²¡æœ‰ <code>@JvmOverloads</code> æ³¨è§£ä¹Ÿæœ‰æ•ˆã€‚</p><h4 id="å—æ£€å¼‚å¸¸-1"><a href="#å—æ£€å¼‚å¸¸-1" class="headerlink" title="å—æ£€å¼‚å¸¸"></a>å—æ£€å¼‚å¸¸</h4><p>å¦‚ä¸Šæ‰€è¿°ï¼ŒKotlin æ²¡æœ‰å—æ£€å¼‚å¸¸ã€‚ æ‰€ä»¥ï¼Œé€šå¸¸ Kotlin å‡½æ•°çš„ Java ç­¾åä¸ä¼šå£°æ˜æŠ›å‡ºå¼‚å¸¸ã€‚ äºæ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„ Kotlin å‡½æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// example.kt</div><div class="line">package demo</div><div class="line"></div><div class="line">fun foo() &#123;</div><div class="line">    throw IOException()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æƒ³è¦åœ¨ Java ä¸­è°ƒç”¨å®ƒå¹¶æ•æ‰è¿™ä¸ªå¼‚å¸¸ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// Java</div><div class="line">try &#123;</div><div class="line">  demo.Example.foo();</div><div class="line">&#125;</div><div class="line">catch (IOException e) &#123; // é”™è¯¯ï¼šfoo() æœªåœ¨ throws åˆ—è¡¨ä¸­å£°æ˜ IOException</div><div class="line">  // â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å› ä¸º <code>foo()</code> æ²¡æœ‰å£°æ˜ <code>IOException</code>ï¼Œæˆ‘ä»¬ä» Java ç¼–è¯‘å™¨å¾—åˆ°äº†ä¸€ä¸ªæŠ¥é”™æ¶ˆæ¯ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¦åœ¨ Kotlin ä¸­ä½¿ç”¨ <code>@Throws</code> æ³¨è§£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@Throws(IOException::class)</div><div class="line">fun foo() &#123;</div><div class="line">    throw IOException()</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="ç©ºå®‰å…¨æ€§"><a href="#ç©ºå®‰å…¨æ€§" class="headerlink" title="ç©ºå®‰å…¨æ€§"></a>ç©ºå®‰å…¨æ€§</h4><p>å½“ä» Java ä¸­è°ƒç”¨ Kotlin å‡½æ•°æ—¶ï¼Œæ²¡äººé˜»æ­¢æˆ‘ä»¬å°† <em>null</em> ä½œä¸ºéç©ºå‚æ•°ä¼ é€’ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Kotlin ç»™æ‰€æœ‰æœŸæœ›éç©ºå‚æ•°çš„å…¬æœ‰å‡½æ•°ç”Ÿæˆè¿è¡Œæ—¶æ£€æµ‹ã€‚ è¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨ Java ä»£ç é‡Œç«‹å³å¾—åˆ° <code>NullPointerException</code>ã€‚</p><h4 id="å‹å˜çš„æ³›å‹"><a href="#å‹å˜çš„æ³›å‹" class="headerlink" title="å‹å˜çš„æ³›å‹"></a>å‹å˜çš„æ³›å‹</h4><p>å½“ Kotlin çš„ç±»ä½¿ç”¨äº†<a href="https://www.kotlincn.net/docs/reference/generics.html#å£°æ˜å¤„å‹å˜" target="_blank" rel="external">å£°æ˜å¤„å‹å˜</a>ï¼Œæœ‰ä¸¤ç§é€‰æ‹©å¯ä»¥ä» Java ä»£ç ä¸­çœ‹åˆ°å®ƒä»¬çš„ç”¨æ³•ã€‚è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ç±»å’Œä¸¤ä¸ªä½¿ç”¨å®ƒçš„å‡½æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class Box&lt;out T&gt;(val value: T)</div><div class="line"></div><div class="line">interface Base</div><div class="line">class Derived : Base</div><div class="line"></div><div class="line">fun boxDerived(value: Derived): Box&lt;Derived&gt; = Box(value)</div><div class="line">fun unboxBase(box: Box&lt;Base&gt;): Base = box.value</div></pre></td></tr></table></figure><p>ä¸€ç§çœ‹ä¼¼ç†æ‰€å½“ç„¶åœ°å°†è¿™ä¿©å‡½æ•°è½¬æ¢æˆ Java ä»£ç çš„æ–¹å¼å¯èƒ½ä¼šæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Box&lt;Derived&gt; boxDerived(Derived value) &#123; â€¦â€¦ &#125;</div><div class="line">Base unboxBase(Box&lt;Base&gt; box) &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><p>é—®é¢˜æ˜¯ï¼Œåœ¨ Kotlin ä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ <code>unboxBase(boxDerived(&quot;s&quot;))</code>ï¼Œä½†æ˜¯åœ¨ Java ä¸­æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºåœ¨ Java ä¸­ç±» <code>Box</code> åœ¨å…¶æ³›å‹å‚æ•° <code>T</code> ä¸Šæ˜¯<em>ä¸å‹å˜çš„</em>ï¼Œäºæ˜¯ <code>Box&lt;Derived&gt;</code> å¹¶ä¸æ˜¯ <code>Box&lt;Base&gt;</code> çš„å­ç±»ã€‚ è¦ä½¿å…¶åœ¨ Java ä¸­å·¥ä½œï¼Œæˆ‘ä»¬æŒ‰ä»¥ä¸‹è¿™æ ·å®šä¹‰ <code>unboxBase</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Base unboxBase(Box&lt;? extends Base&gt; box) &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Java çš„<em>é€šé…ç¬¦ç±»å‹</em>ï¼ˆ<code>? extends Base</code>ï¼‰æ¥é€šè¿‡ä½¿ç”¨å¤„å‹å˜æ¥æ¨¡æ‹Ÿå£°æ˜å¤„å‹å˜ï¼Œå› ä¸ºåœ¨ Java ä¸­åªèƒ½è¿™æ ·ã€‚</p><p>å½“å®ƒ<em>ä½œä¸ºå‚æ•°</em>å‡ºç°æ—¶ï¼Œä¸ºäº†è®© Kotlin çš„ API åœ¨ Java ä¸­å·¥ä½œï¼Œå¯¹äºåå˜å®šä¹‰çš„ <code>Box</code> æˆ‘ä»¬ç”Ÿæˆ <code>Box&lt;Super&gt;</code> ä½œä¸º <code>Box&lt;? extends Super&gt;</code> ï¼ˆæˆ–è€…å¯¹äºé€†å˜å®šä¹‰çš„ <code>Foo</code> ç”Ÿæˆ <code>Foo&lt;? super Bar&gt;</code>ï¼‰ã€‚å½“å®ƒæ˜¯ä¸€ä¸ªè¿”å›å€¼æ—¶ï¼Œ æˆ‘ä»¬ä¸ç”Ÿæˆé€šé…ç¬¦ï¼Œå› ä¸ºå¦åˆ™ Java å®¢æˆ·ç«¯å°†å¿…é¡»å¤„ç†å®ƒä»¬ï¼ˆå¹¶ä¸”å®ƒè¿åå¸¸ç”¨ Java ç¼–ç é£æ ¼ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç¤ºä¾‹ä¸­çš„å¯¹åº”å‡½æ•°å®é™…ä¸Šç¿»è¯‘å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// ä½œä¸ºè¿”å›ç±»å‹â€”â€”æ²¡æœ‰é€šé…ç¬¦</div><div class="line">Box&lt;Derived&gt; boxDerived(Derived value) &#123; â€¦â€¦ &#125;</div><div class="line"> </div><div class="line">// ä½œä¸ºå‚æ•°â€”â€”æœ‰é€šé…ç¬¦</div><div class="line">Base unboxBase(Box&lt;? extends Base&gt; box) &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå½“å‚æ•°ç±»å‹æ˜¯ final æ—¶ï¼Œç”Ÿæˆé€šé…ç¬¦é€šå¸¸æ²¡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥æ— è®ºåœ¨ä»€ä¹ˆåœ°æ–¹ <code>Box&lt;String&gt;</code> å§‹ç»ˆè½¬æ¢ä¸º <code>Box&lt;String&gt;</code>ã€‚</p><p>å¦‚æœæˆ‘ä»¬åœ¨é»˜è®¤ä¸ç”Ÿæˆé€šé…ç¬¦çš„åœ°æ–¹éœ€è¦é€šé…ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@JvmWildcard</code> æ³¨è§£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fun boxDerived(value: Derived): Box&lt;@JvmWildcard Derived&gt; = Box(value)</div><div class="line">// å°†è¢«è½¬æ¢æˆ</div><div class="line">// Box&lt;? extends Derived&gt; boxDerived(Derived value) &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦é»˜è®¤çš„é€šé…ç¬¦è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>@JvmSuppressWildcards</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fun unboxBase(box: Box&lt;@JvmSuppressWildcards Base&gt;): Base = box.value</div><div class="line">// ä¼šç¿»è¯‘æˆ</div><div class="line">// Base unboxBase(Box&lt;Base&gt; box) &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><p>æ³¨æ„ï¼š<code>@JvmSuppressWildcards</code> ä¸ä»…å¯ç”¨äºå•ä¸ªç±»å‹å‚æ•°ï¼Œè¿˜å¯ç”¨äºæ•´ä¸ªå£°æ˜ï¼ˆå¦‚å‡½æ•°æˆ–ç±»ï¼‰ï¼Œä»è€ŒæŠ‘åˆ¶å…¶ä¸­çš„æ‰€æœ‰é€šé…ç¬¦ã€‚</p><h4 id="Nothing-ç±»å‹ç¿»è¯‘"><a href="#Nothing-ç±»å‹ç¿»è¯‘" class="headerlink" title="Nothing ç±»å‹ç¿»è¯‘"></a>Nothing ç±»å‹ç¿»è¯‘</h4><p>ç±»å‹ <a href="https://www.kotlincn.net/docs/reference/exceptions.html#nothing-ç±»å‹" target="_blank" rel="external"><code>Nothing</code></a> æ˜¯ç‰¹æ®Šçš„ï¼Œå› ä¸ºå®ƒåœ¨ Java ä¸­æ²¡æœ‰è‡ªç„¶çš„å¯¹åº”ã€‚ç¡®å®ï¼Œæ¯ä¸ª Java å¼•ç”¨ç±»å‹ï¼ŒåŒ…æ‹¬<code>java.lang.Void</code> éƒ½å¯ä»¥æ¥å— <code>null</code> å€¼ï¼Œä½†æ˜¯ Nothing ä¸è¡Œã€‚å› æ­¤ï¼Œè¿™ç§ç±»å‹ä¸èƒ½åœ¨ Java ä¸–ç•Œä¸­å‡†ç¡®è¡¨ç¤ºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ä½¿ç”¨ <code>Nothing</code> å‚æ•°çš„åœ°æ–¹ Kotlin ç”Ÿæˆä¸€ä¸ªåŸå§‹ç±»å‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fun emptyList(): List&lt;Nothing&gt; = listOf()</div><div class="line">// ä¼šç¿»è¯‘æˆ</div><div class="line">// List emptyList() &#123; â€¦â€¦ &#125;</div></pre></td></tr></table></figure><h4 id="åœ¨-Kotlin-ä¸­ä½¿ç”¨-JNI"><a href="#åœ¨-Kotlin-ä¸­ä½¿ç”¨-JNI" class="headerlink" title="åœ¨ Kotlin ä¸­ä½¿ç”¨ JNI"></a>åœ¨ Kotlin ä¸­ä½¿ç”¨ JNI</h4><p>è¦å£°æ˜ä¸€ä¸ªåœ¨æœ¬åœ°ï¼ˆC æˆ– C++ï¼‰ä»£ç ä¸­å®ç°çš„å‡½æ•°ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>external</code> ä¿®é¥°ç¬¦æ¥æ ‡è®°å®ƒï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">external <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">(x: <span class="type">Int</span>)</span></span>: <span class="built_in">Double</span></div></pre></td></tr></table></figure><p>å…¶ä½™çš„è¿‡ç¨‹ä¸ Java ä¸­çš„å·¥ä½œæ–¹å¼å®Œå…¨ç›¸åŒã€‚</p><h2 id="Kotlin-é«˜çº§ç¼–ç¨‹"><a href="#Kotlin-é«˜çº§ç¼–ç¨‹" class="headerlink" title="Kotlin é«˜çº§ç¼–ç¨‹"></a>Kotlin é«˜çº§ç¼–ç¨‹</h2><h3 id="é¢†åŸŸç‰¹å®šè¯­è¨€-DSL"><a href="#é¢†åŸŸç‰¹å®šè¯­è¨€-DSL" class="headerlink" title="é¢†åŸŸç‰¹å®šè¯­è¨€ DSL"></a>é¢†åŸŸç‰¹å®šè¯­è¨€ DSL</h3><p>åŸŸç‰¹å®šè¯­è¨€ï¼ˆDSLï¼‰çš„åŸºæœ¬æ€æƒ³æ˜¯é’ˆå¯¹ç‰¹å®šç±»å‹çš„é—®é¢˜çš„è®¡ç®—æœºè¯­è¨€ï¼Œè€Œä¸æ˜¯é¢å‘ä»»ä½•ç±»å‹çš„è½¯ä»¶é—®é¢˜çš„é€šç”¨è¯­è¨€ã€‚</p><h4 id="ç±»å‹å®‰å…¨çš„æ„å»ºå™¨"><a href="#ç±»å‹å®‰å…¨çš„æ„å»ºå™¨" class="headerlink" title="ç±»å‹å®‰å…¨çš„æ„å»ºå™¨"></a>ç±»å‹å®‰å…¨çš„æ„å»ºå™¨</h4><p><a href="http://www.groovy-lang.org/dsls.html#_nodebuilder" target="_blank" rel="external">æ„å»ºå™¨ï¼ˆbuilderï¼‰</a>çš„æ¦‚å¿µåœ¨ <em>Groovy</em> ç¤¾åŒºä¸­éå¸¸çƒ­é—¨ã€‚ æ„å»ºå™¨å…è®¸ä»¥åŠå£°æ˜ï¼ˆsemi-declarativeï¼‰çš„æ–¹å¼å®šä¹‰æ•°æ®ã€‚æ„å»ºå™¨å¾ˆé€‚åˆç”¨æ¥<a href="http://www.groovy-lang.org/processing-xml.html#_creating_xml" target="_blank" rel="external">ç”Ÿæˆ XML</a>ã€ <a href="http://www.groovy-lang.org/swing.html" target="_blank" rel="external">å¸ƒå±€ UI ç»„ä»¶</a>ã€ <a href="http://www.artima.com/weblogs/viewpost.jsp?thread=296081" target="_blank" rel="external">æè¿° 3D åœºæ™¯</a>ä»¥åŠå…¶ä»–æ›´å¤šåŠŸèƒ½â€¦â€¦</p><p>Kotlin å…è®¸<em>æ£€æŸ¥ç±»å‹</em>çš„æ„å»ºå™¨ï¼Œæ¯” Groovy è‡ªèº«çš„åŠ¨æ€ç±»å‹å®ç°æ›´å…·å¸å¼•åŠ›ã€‚</p><p>HTML DSL kotlin å®˜æ–¹ç¤ºä¾‹:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> result =</div><div class="line">            html &#123;</div><div class="line">                head &#123;</div><div class="line">                    title &#123; +<span class="string">"XML encoding with Kotlin"</span> &#125;</div><div class="line">                &#125;</div><div class="line">                body &#123;</div><div class="line">                    h1 &#123; +<span class="string">"XML encoding with Kotlin"</span> &#125;</div><div class="line">                    p &#123; +<span class="string">"this format can be used as an alternative markup to XML"</span> &#125;</div><div class="line"></div><div class="line">                    <span class="comment">// an element with attributes and text content</span></div><div class="line">                    a(href = <span class="string">"http://jetbrains.com/kotlin"</span>) &#123; +<span class="string">"Kotlin"</span> &#125;</div><div class="line"></div><div class="line">                    <span class="comment">// mixed content</span></div><div class="line">                    p &#123;</div><div class="line">                        +<span class="string">"This is some"</span></div><div class="line">                        b &#123; +<span class="string">"mixed"</span> &#125;</div><div class="line">                        +<span class="string">"text. For more see the"</span></div><div class="line">                        a(href = <span class="string">"http://jetbrains.com/kotlin"</span>) &#123; +<span class="string">"Kotlin"</span> &#125;</div><div class="line">                        +<span class="string">"project"</span></div><div class="line">                    &#125;</div><div class="line">                    p &#123; +<span class="string">"some text"</span> &#125;</div><div class="line"></div><div class="line">                    <span class="comment">// content generated from command-line arguments</span></div><div class="line">                    p &#123;</div><div class="line">                        +<span class="string">"Command line arguments were:"</span></div><div class="line">                        ul &#123;</div><div class="line">                            <span class="keyword">for</span> (arg <span class="keyword">in</span> args)</div><div class="line">                                li &#123; +arg &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">    println(result)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Element</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">render</span><span class="params">(builder: <span class="type">StringBuilder</span>, indent: <span class="type">String</span>)</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextElement</span></span>(<span class="keyword">val</span> text: String) : Element &#123;</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">render</span><span class="params">(builder: <span class="type">StringBuilder</span>, indent: <span class="type">String</span>)</span></span> &#123;</div><div class="line">        builder.append(<span class="string">"<span class="subst">$indent</span><span class="subst">$text</span>\n"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@DslMarker</span></div><div class="line"><span class="keyword">annotation</span> <span class="class"><span class="keyword">class</span> <span class="title">HtmlTagMarker</span></span></div><div class="line"></div><div class="line"><span class="meta">@HtmlTagMarker</span></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Tag</span></span>(<span class="keyword">val</span> name: String) : Element &#123;</div><div class="line">    <span class="keyword">val</span> children = arrayListOf&lt;Element&gt;()</div><div class="line">    <span class="keyword">val</span> attributes = hashMapOf&lt;String, String&gt;()</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : Element&gt;</span> <span class="title">initTag</span><span class="params">(tag: <span class="type">T</span>, init: <span class="type">T</span>.()</span></span> -&gt; <span class="built_in">Unit</span>): T &#123;</div><div class="line">        tag.init()</div><div class="line">        children.add(tag)</div><div class="line">        <span class="keyword">return</span> tag</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">render</span><span class="params">(builder: <span class="type">StringBuilder</span>, indent: <span class="type">String</span>)</span></span> &#123;</div><div class="line">        builder.append(<span class="string">"<span class="subst">$indent</span>&lt;<span class="subst">$name</span><span class="subst">$&#123;renderAttributes()&#125;</span>&gt;\n"</span>)</div><div class="line">        <span class="keyword">for</span> (c <span class="keyword">in</span> children) &#123;</div><div class="line">            c.render(builder, indent + <span class="string">"  "</span>)</div><div class="line">        &#125;</div><div class="line">        builder.append(<span class="string">"<span class="subst">$indent</span>&lt;/<span class="subst">$name</span>&gt;\n"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">renderAttributes</span><span class="params">()</span></span>: String? &#123;</div><div class="line">        <span class="keyword">val</span> builder = StringBuilder()</div><div class="line">        <span class="keyword">for</span> (a <span class="keyword">in</span> attributes.keys) &#123;</div><div class="line">            builder.append(<span class="string">" <span class="subst">$a</span>=\"<span class="subst">$&#123;attributes[a]&#125;</span>\""</span>)</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> builder.toString()</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">toString</span><span class="params">()</span></span>: String &#123;</div><div class="line">        <span class="keyword">val</span> builder = StringBuilder()</div><div class="line">        render(builder, <span class="string">""</span>)</div><div class="line">        <span class="keyword">return</span> builder.toString()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TagWithText</span></span>(name: String) : Tag(name) &#123;</div><div class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> String.<span class="title">unaryPlus</span><span class="params">()</span></span> &#123;</div><div class="line">        children.add(TextElement(<span class="keyword">this</span>))</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTML</span></span>() : TagWithText(<span class="string">"html"</span>) &#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">head</span><span class="params">(init: <span class="type">Head</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(Head(), init)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">body</span><span class="params">(init: <span class="type">Body</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(Body(), init)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Head</span></span>() : TagWithText(<span class="string">"head"</span>) &#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">title</span><span class="params">(init: <span class="type">Title</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(Title(), init)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Title</span></span>() : TagWithText(<span class="string">"title"</span>)</div><div class="line"></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BodyTag</span></span>(name: String) : TagWithText(name) &#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">b</span><span class="params">(init: <span class="type">B</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(B(), init)</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">p</span><span class="params">(init: <span class="type">P</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(P(), init)</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">h1</span><span class="params">(init: <span class="type">H1</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(H1(), init)</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">ul</span><span class="params">(init: <span class="type">UL</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(UL(), init)</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">a</span><span class="params">(href: <span class="type">String</span>, init: <span class="type">A</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) &#123;</div><div class="line">        <span class="keyword">val</span> a = initTag(A(), init)</div><div class="line">        a.href = href</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Body</span></span>() : BodyTag(<span class="string">"body"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UL</span></span>() : BodyTag(<span class="string">"ul"</span>) &#123;</div><div class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">li</span><span class="params">(init: <span class="type">LI</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) = initTag(LI(), init)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>() : BodyTag(<span class="string">"b"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LI</span></span>() : BodyTag(<span class="string">"li"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">P</span></span>() : BodyTag(<span class="string">"p"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">H1</span></span>() : BodyTag(<span class="string">"h1"</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>() : BodyTag(<span class="string">"a"</span>) &#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> href: String</div><div class="line">        <span class="keyword">get</span>() = attributes[<span class="string">"href"</span>]!!</div><div class="line">        <span class="keyword">set</span>(value) &#123;</div><div class="line">            attributes[<span class="string">"href"</span>] = value</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">html</span><span class="params">(init: <span class="type">HTML</span>.()</span></span> -&gt; <span class="built_in">Unit</span>): HTML &#123;</div><div class="line">    <span class="keyword">val</span> html = HTML()</div><div class="line">    html.init()</div><div class="line">    <span class="keyword">return</span> html</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸Šé¢å®ç° HTML æ ‡ç­¾,å®é™…ä¸Šæ˜¯è°ƒç”¨ä¸€ä¸ª lambdaå‡½æ•°ï¼Œç”¨ä¸€ä¸ªæ ‡ç­¾æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹zuoä½œä¸ºå‚æ•°,ä½¿åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨è¯¥å®ä¾‹çš„æˆå‘˜ã€‚</p><h4 id="å‡ ä¸ªå‰å®³çš„-DSL-é¡¹ç›®"><a href="#å‡ ä¸ªå‰å®³çš„-DSL-é¡¹ç›®" class="headerlink" title="å‡ ä¸ªå‰å®³çš„ DSL é¡¹ç›®"></a>å‡ ä¸ªå‰å®³çš„ DSL é¡¹ç›®</h4><ul><li><a href="https://github.com/Kotlin/anko" target="_blank" rel="external">Anko</a> ç”¨äº Android çš„ï¼Œç”¨äºæè¿° UI ã€‚</li><li><a href="https://github.com/cqjjjzr/Gensokyo" target="_blank" rel="external">Gensokyo</a> ç”¨äº  Swing  çš„ï¼Œç”¨äºæè¿° UI </li><li><a href="https://github.com/kotlintest/kotlintest" target="_blank" rel="external">KotlinTest</a> Kotlinæµ‹è¯•æ¡†æ¶åŸºäºä¼˜ç§€çš„Scalatest</li></ul><h3 id="åç¨‹-Coroutine"><a href="#åç¨‹-Coroutine" class="headerlink" title="åç¨‹ Coroutine"></a>åç¨‹ Coroutine</h3><p>åœ¨ Kotlin 1.1 ä¸­åç¨‹æ˜¯å®éªŒæ€§çš„ã€‚å¦å¤–kotlin ä¸ºäº†å‡å°‘ç¨‹åºä½“ç§¯,æ ¹æ®éœ€è¦ä½¿ç”¨åç¨‹,ä½ è¦åŠ å…¥<code>kotlinx-coroutines-core</code> åº“.</p><p>ä¸€äº› API å¯åŠ¨é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œï¼ˆä¾‹å¦‚ç½‘ç»œ IOã€æ–‡ä»¶ IOã€CPU æˆ– GPU å¯†é›†å‹ä»»åŠ¡ç­‰ï¼‰ï¼Œå¹¶è¦æ±‚è°ƒç”¨è€…é˜»å¡ç›´åˆ°å®ƒä»¬å®Œæˆã€‚åç¨‹æä¾›äº†ä¸€ç§é¿å…é˜»å¡çº¿ç¨‹å¹¶ç”¨æ›´å»‰ä»·ã€æ›´å¯æ§çš„æ“ä½œæ›¿ä»£çº¿ç¨‹é˜»å¡çš„æ–¹æ³•ï¼šåç¨‹<em>æŒ‚èµ·</em>ã€‚</p><p>åç¨‹é€šè¿‡å°†å¤æ‚æ€§æ”¾å…¥åº“æ¥ç®€åŒ–å¼‚æ­¥ç¼–ç¨‹ã€‚ç¨‹åºçš„é€»è¾‘å¯ä»¥åœ¨åç¨‹ä¸­<em>é¡ºåº</em>åœ°è¡¨è¾¾ï¼Œè€Œåº•å±‚åº“ä¼šä¸ºæˆ‘ä»¬è§£å†³å…¶å¼‚æ­¥æ€§ã€‚è¯¥åº“å¯ä»¥å°†ç”¨æˆ·ä»£ç çš„ç›¸å…³éƒ¨åˆ†åŒ…è£…ä¸ºå›è°ƒã€è®¢é˜…ç›¸å…³äº‹ä»¶ã€åœ¨ä¸åŒçº¿ç¨‹ï¼ˆç”šè‡³ä¸åŒæœºå™¨ï¼ï¼‰ä¸Šè°ƒåº¦æ‰§è¡Œï¼Œè€Œä»£ç åˆ™ä¿æŒå¦‚åŒé¡ºåºæ‰§è¡Œä¸€æ ·ç®€å•ã€‚</p><p>è®¸å¤šåœ¨å…¶ä»–è¯­è¨€ä¸­å¯ç”¨çš„å¼‚æ­¥æœºåˆ¶å¯ä»¥ä½¿ç”¨ Kotlin åç¨‹å®ç°ä¸ºåº“ã€‚è¿™åŒ…æ‹¬æºäº C# å’Œ ECMAScript çš„ <a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md#composing-suspending-functions" target="_blank" rel="external"><code>async</code>/<code>await</code></a>ã€æºäº Go çš„ <a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md#channels" target="_blank" rel="external">ç®¡é“</a> å’Œ <a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md#select-expression" target="_blank" rel="external"><code>select</code></a> ä»¥åŠæºäº C# å’Œ Python <a href="https://www.kotlincn.net/docs/reference/coroutines.html#kotlincoroutines-ä¸­çš„ç”Ÿæˆå™¨-api" target="_blank" rel="external">ç”Ÿæˆå™¨/<code>yield</code></a>ã€‚å…³äºæä¾›è¿™äº›ç»“æ„çš„åº“è¯·å‚è§å…¶<a href="https://www.kotlincn.net/docs/reference/coroutines.html#æ ‡å‡†-api" target="_blank" rel="external">ä¸‹æ–‡</a>æè¿°ã€‚</p><h4 id="é˜»å¡-vs-æŒ‚èµ·"><a href="#é˜»å¡-vs-æŒ‚èµ·" class="headerlink" title="é˜»å¡ vs æŒ‚èµ·"></a>é˜»å¡ vs æŒ‚èµ·</h4><p>åŸºæœ¬ä¸Šï¼Œåç¨‹è®¡ç®—å¯ä»¥<em>è¢«æŒ‚èµ·</em>è€Œæ— éœ€<em>é˜»å¡çº¿ç¨‹</em>ã€‚çº¿ç¨‹é˜»å¡çš„ä»£ä»·é€šå¸¸æ˜¯æ˜‚è´µçš„ï¼Œå°¤å…¶åœ¨é«˜è´Ÿè½½æ—¶ï¼Œå› ä¸ºåªæœ‰ç›¸å¯¹å°‘é‡çº¿ç¨‹å®é™…å¯ç”¨ï¼Œå› æ­¤é˜»å¡å…¶ä¸­ä¸€ä¸ªä¼šå¯¼è‡´ä¸€äº›é‡è¦çš„ä»»åŠ¡è¢«å»¶è¿Ÿã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œåç¨‹æŒ‚èµ·å‡ ä¹æ˜¯æ— ä»£ä»·çš„ã€‚ä¸éœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢æˆ–è€… OS çš„ä»»ä½•å…¶ä»–å¹²é¢„ã€‚æœ€é‡è¦çš„æ˜¯ï¼ŒæŒ‚èµ·å¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šç”±ç”¨æˆ·åº“æ§åˆ¶ï¼šä½œä¸ºåº“çš„ä½œè€…ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šæŒ‚èµ·æ—¶å‘ç”Ÿä»€ä¹ˆå¹¶æ ¹æ®éœ€æ±‚ä¼˜åŒ–/è®°æ—¥å¿—/æˆªè·ã€‚</p><p>å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œåç¨‹ä¸èƒ½åœ¨éšæœºçš„æŒ‡ä»¤ä¸­æŒ‚èµ·ï¼Œè€Œåªèƒ½åœ¨æ‰€è°“çš„<em>æŒ‚èµ·ç‚¹</em>æŒ‚èµ·ï¼Œè¿™ä¼šè°ƒç”¨ç‰¹åˆ«æ ‡è®°çš„å‡½æ•°ã€‚</p><h4 id="æŒ‚èµ·å‡½æ•°"><a href="#æŒ‚èµ·å‡½æ•°" class="headerlink" title="æŒ‚èµ·å‡½æ•°"></a>æŒ‚èµ·å‡½æ•°</h4><p>å½“æˆ‘ä»¬è°ƒç”¨æ ‡è®°æœ‰ç‰¹æ®Šä¿®é¥°ç¬¦ <code>suspend</code> çš„å‡½æ•°æ—¶ï¼Œä¼šå‘ç”ŸæŒ‚èµ·ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">suspend <span class="function"><span class="keyword">fun</span> <span class="title">doSomething</span><span class="params">(foo: <span class="type">Foo</span>)</span></span>: Bar &#123;</div><div class="line">    â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™æ ·çš„å‡½æ•°ç§°ä¸º<em>æŒ‚èµ·å‡½æ•°</em>ï¼Œå› ä¸ºè°ƒç”¨å®ƒä»¬å¯èƒ½æŒ‚èµ·åç¨‹ï¼ˆå¦‚æœç›¸å…³è°ƒç”¨çš„ç»“æœå·²ç»å¯ç”¨ï¼Œåº“å¯ä»¥å†³å®šç»§ç»­è¿›è¡Œè€Œä¸æŒ‚èµ·ï¼‰ã€‚æŒ‚èµ·å‡½æ•°èƒ½å¤Ÿä»¥ä¸æ™®é€šå‡½æ•°ç›¸åŒçš„æ–¹å¼è·å–å‚æ•°å’Œè¿”å›å€¼ï¼Œä½†å®ƒä»¬åªèƒ½ä»åç¨‹å’Œå…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ã€‚äº‹å®ä¸Šï¼Œè¦å¯åŠ¨åç¨‹ï¼Œå¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå®ƒé€šå¸¸æ˜¯åŒ¿åçš„ï¼ˆå³å®ƒæ˜¯ä¸€ä¸ªæŒ‚èµ· lambda è¡¨è¾¾å¼ï¼‰ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç®€åŒ–çš„ <code>async()</code> å‡½æ•°ï¼ˆæºè‡ª <a href="https://www.kotlincn.net/docs/reference/coroutines.html#kotlincoroutines-ä¸­çš„ç”Ÿæˆå™¨-api" target="_blank" rel="external"><code>kotlinx.coroutines</code></a> åº“ï¼‰ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">async</span><span class="params">(block: <span class="type">suspend</span> ()</span></span> -&gt; T)</div></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>async()</code> æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼ˆä¸æ˜¯æŒ‚èµ·å‡½æ•°ï¼‰ï¼Œä½†æ˜¯å®ƒçš„ <code>block</code> å‚æ•°å…·æœ‰ä¸€ä¸ªå¸¦ <code>suspend</code> ä¿®é¥°ç¬¦çš„å‡½æ•°ç±»å‹ï¼š <code>suspend () -&gt; T</code>ã€‚æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬å°†ä¸€ä¸ª lambda è¡¨è¾¾å¼ä¼ ç»™ <code>async()</code> æ—¶ï¼Œå®ƒä¼šæ˜¯<em>æŒ‚èµ· lambda è¡¨è¾¾å¼</em>ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥ä»ä¸­è°ƒç”¨æŒ‚èµ·å‡½æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">async &#123;</div><div class="line">    doSomething(foo)</div><div class="line">    â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç»§ç»­è¯¥ç±»æ¯”ï¼Œ<code>await()</code> å¯ä»¥æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼ˆå› æ­¤ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ª <code>async {}</code> å—ä¸­è°ƒç”¨ï¼‰ï¼Œè¯¥å‡½æ•°æŒ‚èµ·ä¸€ä¸ªåç¨‹ï¼Œç›´åˆ°ä¸€äº›è®¡ç®—å®Œæˆå¹¶è¿”å›å…¶ç»“æœï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">async &#123;</div><div class="line">    â€¦â€¦</div><div class="line">    <span class="keyword">val</span> result = computation.await()</div><div class="line">    â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ›´å¤šå…³äº <code>async/await</code> å‡½æ•°å®é™…åœ¨ <code>kotlinx.coroutines</code> ä¸­å¦‚ä½•å·¥ä½œçš„ä¿¡æ¯å¯ä»¥åœ¨<a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md#composing-suspending-functions" target="_blank" rel="external">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><p>è¯·æ³¨æ„ï¼ŒæŒ‚èµ·å‡½æ•° <code>await()</code> å’Œ <code>doSomething()</code> ä¸èƒ½åœ¨åƒ <code>main()</code> è¿™æ ·çš„æ™®é€šå‡½æ•°ä¸­è°ƒç”¨ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    doSomething() <span class="comment">// é”™è¯¯ï¼šæŒ‚èµ·å‡½æ•°ä»éåç¨‹ä¸Šä¸‹æ–‡è°ƒç”¨</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿˜è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‚èµ·å‡½æ•°å¯ä»¥æ˜¯è™šæ‹Ÿçš„ï¼Œå½“è¦†ç›–å®ƒä»¬æ—¶ï¼Œå¿…é¡»æŒ‡å®š <code>suspend</code> ä¿®é¥°ç¬¦ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Base</span> </span>&#123;</div><div class="line">    suspend <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>: <span class="type">Base &#123;</span></span></div><div class="line">    <span class="keyword">override</span> suspend <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span> &#123; â€¦â€¦ &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="RestrictsSuspension-æ³¨è§£"><a href="#RestrictsSuspension-æ³¨è§£" class="headerlink" title="@RestrictsSuspension æ³¨è§£"></a>@RestrictsSuspension æ³¨è§£</h4><p>æ‰©å±•å‡½æ•°ï¼ˆå’Œ lambda è¡¨è¾¾å¼ï¼‰ä¹Ÿå¯ä»¥æ ‡è®°ä¸º <code>suspend</code>ï¼Œå°±åƒæ™®é€šçš„ä¸€æ ·ã€‚è¿™å…è®¸åˆ›å»º <a href="https://www.kotlincn.net/docs/reference/type-safe-builders.html" target="_blank" rel="external">DSL</a> åŠå…¶ä»–ç”¨æˆ·å¯æ‰©å±•çš„ APIã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåº“ä½œè€…éœ€è¦é˜»æ­¢ç”¨æˆ·æ·»åŠ <em>æ–°æ–¹å¼</em>æ¥æŒ‚èµ·åç¨‹ã€‚</p><p>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/-restricts-suspension/index.html" target="_blank" rel="external"><code>@RestrictsSuspension</code></a> æ³¨è§£ã€‚å½“æ¥æ”¶è€…ç±»/æ¥å£ <code>R</code> ç”¨å®ƒæ ‡æ³¨æ—¶ï¼Œæ‰€æœ‰æŒ‚èµ·æ‰©å±•éƒ½éœ€è¦å§”æ‰˜ç»™ <code>R</code> çš„æˆå‘˜æˆ–å…¶å®ƒå§”æ‰˜ç»™å®ƒçš„æ‰©å±•ã€‚ç”±äºæ‰©å±•ä¸èƒ½æ— é™ç›¸äº’å§”æ‰˜ï¼ˆç¨‹åºä¸ä¼šç»ˆæ­¢ï¼‰ï¼Œè¿™ä¿è¯æ‰€æœ‰æŒ‚èµ·éƒ½é€šè¿‡è°ƒç”¨ <code>R</code> çš„æˆå‘˜å‘ç”Ÿï¼Œåº“çš„ä½œè€…å°±å¯ä»¥å®Œå…¨æ§åˆ¶äº†ã€‚</p><p>è¿™åœ¨<em>å°‘æ•°</em>æƒ…å†µæ˜¯éœ€è¦çš„ï¼Œå½“æ¯æ¬¡æŒ‚èµ·åœ¨åº“ä¸­ä»¥ç‰¹æ®Šæ–¹å¼å¤„ç†æ—¶ã€‚ä¾‹å¦‚ï¼Œå½“é€šè¿‡ <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/build-sequence.html" target="_blank" rel="external"><code>buildSequence()</code></a> å‡½æ•°å®ç°<a href="https://www.kotlincn.net/docs/reference/coroutines.html#kotlincoroutines-ä¸­çš„ç”Ÿæˆå™¨-api" target="_blank" rel="external">ä¸‹æ–‡</a>æ‰€è¿°çš„ç”Ÿæˆå™¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿åœ¨åç¨‹ä¸­çš„ä»»ä½•æŒ‚èµ·è°ƒç”¨æœ€ç»ˆè°ƒç”¨ <code>yield()</code> æˆ– <code>yieldAll()</code> è€Œä¸æ˜¯ä»»ä½•å…¶ä»–å‡½æ•°ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/-sequence-builder/index.html" target="_blank" rel="external"><code>SequenceBuilder</code></a> ç”¨ <code>@RestrictsSuspension</code> æ³¨è§£ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RestrictsSuspension</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">SequenceBuilder</span>&lt;<span class="type">in T</span>&gt; </span>&#123;</div><div class="line">    â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å‚è§å…¶ <a href="https://github.com/JetBrains/kotlin/blob/master/libraries/stdlib/src/kotlin/coroutines/experimental/SequenceBuilder.kt" target="_blank" rel="external">Github ä¸Š</a> çš„æºä»£ç ã€‚</p><h4 id="åç¨‹çš„å†…éƒ¨æœºåˆ¶"><a href="#åç¨‹çš„å†…éƒ¨æœºåˆ¶" class="headerlink" title="åç¨‹çš„å†…éƒ¨æœºåˆ¶"></a>åç¨‹çš„å†…éƒ¨æœºåˆ¶</h4><p>æˆ‘ä»¬ä¸æ˜¯åœ¨è¿™é‡Œç»™å‡ºä¸€ä¸ªå…³äºåç¨‹å¦‚ä½•å·¥ä½œçš„å®Œæ•´è§£é‡Šï¼Œç„¶è€Œç²—ç•¥åœ°è®¤è¯†å‘ç”Ÿäº†ä»€ä¹ˆæ˜¯ç›¸å½“é‡è¦çš„ã€‚</p><p>åç¨‹å®Œå…¨é€šè¿‡ç¼–è¯‘æŠ€æœ¯å®ç°ï¼ˆä¸éœ€è¦æ¥è‡ª VM æˆ– OS ç«¯çš„æ”¯æŒï¼‰ï¼ŒæŒ‚èµ·é€šè¿‡ä»£ç æ¥ç”Ÿæ•ˆã€‚åŸºæœ¬ä¸Šï¼Œæ¯ä¸ªæŒ‚èµ·å‡½æ•°ï¼ˆä¼˜åŒ–å¯èƒ½é€‚ç”¨ï¼Œä½†æˆ‘ä»¬ä¸åœ¨è¿™é‡Œè®¨è®ºï¼‰éƒ½è½¬æ¢ä¸ºçŠ¶æ€æœºï¼Œå…¶ä¸­çš„çŠ¶æ€å¯¹åº”äºæŒ‚èµ·è°ƒç”¨ã€‚åˆšå¥½åœ¨æŒ‚èµ·å‰ï¼Œä¸‹ä¸€çŠ¶æ€ä¸ç›¸å…³å±€éƒ¨å˜é‡ç­‰ä¸€èµ·å­˜å‚¨åœ¨ç¼–è¯‘å™¨ç”Ÿæˆçš„ç±»çš„å­—æ®µä¸­ã€‚åœ¨æ¢å¤è¯¥åç¨‹æ—¶ï¼Œæ¢å¤å±€éƒ¨å˜é‡å¹¶ä¸”çŠ¶æ€æœºä»åˆšå¥½æŒ‚èµ·ä¹‹åçš„çŠ¶æ€è¿›è¡Œã€‚</p><p>æŒ‚èµ·çš„åç¨‹å¯ä»¥ä½œä¸ºä¿æŒå…¶æŒ‚èµ·çŠ¶æ€ä¸å±€éƒ¨å˜é‡çš„å¯¹è±¡æ¥å­˜å‚¨å’Œä¼ é€’ã€‚è¿™ç§å¯¹è±¡çš„ç±»å‹æ˜¯ <code>Continuation</code>ï¼Œè€Œè¿™é‡Œæè¿°çš„æ•´ä¸ªä»£ç è½¬æ¢å¯¹åº”äºç»å…¸çš„<a href="https://en.wikipedia.org/wiki/Continuation-passing_style" target="_blank" rel="external">å»¶ç»­æ€§ä¼ é€’é£æ ¼ï¼ˆContinuation-passing styleï¼‰</a>ã€‚å› æ­¤ï¼ŒæŒ‚èµ·å‡½æ•°æœ‰ä¸€ä¸ª <code>Continuation</code> ç±»å‹çš„é¢å¤–å‚æ•°ä½œä¸ºé«˜çº§é€‰é¡¹ã€‚</p><p>å…³äºåç¨‹å·¥ä½œåŸç†çš„æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨<a href="https://github.com/Kotlin/kotlin-coroutines/blob/master/kotlin-coroutines-informal.md" target="_blank" rel="external">è¿™ä¸ªè®¾è®¡æ–‡æ¡£</a>ä¸­æ‰¾åˆ°ã€‚åœ¨å…¶ä»–è¯­è¨€ï¼ˆå¦‚ C# æˆ–è€… ECMAScript 2016ï¼‰ä¸­çš„ async/await çš„ç±»ä¼¼æè¿°ä¸æ­¤ç›¸å…³ï¼Œè™½ç„¶å®ƒä»¬å®ç°çš„è¯­è¨€åŠŸèƒ½å¯èƒ½ä¸åƒ Kotlin åç¨‹è¿™æ ·é€šç”¨ã€‚</p><h4 id="åç¨‹çš„å®éªŒæ€§çŠ¶æ€"><a href="#åç¨‹çš„å®éªŒæ€§çŠ¶æ€" class="headerlink" title="åç¨‹çš„å®éªŒæ€§çŠ¶æ€"></a>åç¨‹çš„å®éªŒæ€§çŠ¶æ€</h4><p>åç¨‹çš„è®¾è®¡æ˜¯<a href="https://www.kotlincn.net/docs/reference/compatibility.html#å®éªŒæ€§çš„åŠŸèƒ½" target="_blank" rel="external">å®éªŒæ€§çš„</a>ï¼Œè¿™æ„å‘³ç€å®ƒå¯èƒ½åœ¨å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­æ›´æ”¹ã€‚å½“åœ¨ Kotlin 1.1 ä¸­ç¼–è¯‘åç¨‹æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šï¼š<em>â€œåç¨‹â€åŠŸèƒ½æ˜¯å®éªŒæ€§çš„</em>ã€‚è¦ç§»å‡ºè¯¥è­¦å‘Šï¼Œä½ éœ€è¦æŒ‡å®š <a href="https://www.kotlincn.net/docs/diagnostics/experimental-coroutines.html" target="_blank" rel="external">opt-in æ ‡å¿—</a>ã€‚</p><p>ç”±äºå…¶å®éªŒæ€§çŠ¶æ€ï¼Œæ ‡å‡†åº“ä¸­åç¨‹ç›¸å…³çš„ API æ”¾åœ¨ <code>kotlin.coroutines.experimental</code> åŒ…ä¸‹ã€‚å½“è®¾è®¡å®Œæˆå¹¶ä¸”å®éªŒæ€§çŠ¶æ€è§£é™¤æ—¶ï¼Œæœ€ç»ˆçš„ API ä¼šç§»åŠ¨åˆ° <code>kotlin.coroutines</code>ï¼Œå¹¶ä¸”å®éªŒåŒ…ä¼šè¢«ä¿ç•™ï¼ˆå¯èƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„æ„ä»¶ä¸­ï¼‰ä»¥å®ç°å‘åå…¼å®¹ã€‚</p><p><strong>é‡è¦æ³¨æ„äº‹é¡¹</strong>ï¼šæˆ‘ä»¬å»ºè®®åº“ä½œè€…éµå¾ªç›¸åŒæƒ¯ä¾‹ï¼šç»™æš´éœ²åŸºäºåç¨‹ API çš„åŒ…æ·»åŠ â€œexperimentalâ€åç¼€ï¼ˆå¦‚ <code>com.example.experimental</code>ï¼‰ï¼Œä»¥ä½¿ä½ çš„åº“ä¿æŒäºŒè¿›åˆ¶å…¼å®¹ã€‚å½“æœ€ç»ˆ API å‘å¸ƒæ—¶ï¼Œè¯·æŒ‰ç…§ä¸‹åˆ—æ­¥éª¤æ“ä½œï¼š</p><ul><li>å°†æ‰€æœ‰ API å¤åˆ¶åˆ° <code>com.example</code>ï¼ˆæ²¡æœ‰ experimental åç¼€ï¼‰ï¼Œ</li><li>ä¿æŒå®éªŒåŒ…çš„å‘åå…¼å®¹æ€§ã€‚</li></ul><p>è¿™å°†æœ€å°åŒ–ä½ çš„ç”¨æˆ·çš„è¿ç§»é—®é¢˜ã€‚</p><h4 id="æ ‡å‡†-API"><a href="#æ ‡å‡†-API" class="headerlink" title="æ ‡å‡† API"></a>æ ‡å‡† API</h4><p>åç¨‹æœ‰ä¸‰ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†ï¼š</p><ul><li>è¯­è¨€æ”¯æŒï¼ˆå³å¦‚ä¸Šæ‰€è¿°çš„æŒ‚èµ·åŠŸèƒ½ï¼‰ï¼Œ</li><li>Kotlin æ ‡å‡†åº“ä¸­çš„åº•å±‚æ ¸å¿ƒ APIï¼Œ</li><li>å¯ä»¥ç›´æ¥åœ¨ç”¨æˆ·ä»£ç ä¸­ä½¿ç”¨çš„é«˜çº§ APIã€‚</li></ul><h4 id="åº•å±‚-APIï¼škotlin-coroutines"><a href="#åº•å±‚-APIï¼škotlin-coroutines" class="headerlink" title="åº•å±‚ APIï¼škotlin.coroutines"></a>åº•å±‚ APIï¼škotlin.coroutines</h4><p>åº•å±‚ API ç›¸å¯¹è¾ƒå°ï¼Œå¹¶ä¸”é™¤äº†åˆ›å»ºæ›´é«˜çº§çš„åº“ä¹‹å¤–ï¼Œä¸åº”è¯¥ä½¿ç”¨å®ƒã€‚ å®ƒç”±ä¸¤ä¸ªä¸»è¦åŒ…ç»„æˆï¼š</p><ul><li><code>kotlin.coroutines.experimental</code>å¸¦æœ‰ä¸»è¦ç±»å‹ä¸ä¸‹è¿°åŸè¯­<ul><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/create-coroutine.html" target="_blank" rel="external"><code>createCoroutine()</code></a></li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/start-coroutine.html" target="_blank" rel="external"><code>startCoroutine()</code></a></li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/suspend-coroutine.html" target="_blank" rel="external"><code>suspendCoroutine()</code></a></li></ul></li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental.intrinsics/index.html" target="_blank" rel="external"><code>kotlin.coroutines.experimental.intrinsics</code></a> å¸¦æœ‰ç”šè‡³æ›´åº•å±‚çš„å†…åœ¨å‡½æ•°å¦‚ <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental.intrinsics/suspend-coroutine-or-return.html" target="_blank" rel="external"><code>suspendCoroutineOrReturn</code></a></li></ul><p>å…³äºè¿™äº› API ç”¨æ³•çš„æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨<a href="https://github.com/Kotlin/kotlin-coroutines/blob/master/kotlin-coroutines-informal.md" target="_blank" rel="external">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><h4 id="kotlin-coroutines-ä¸­çš„ç”Ÿæˆå™¨-API"><a href="#kotlin-coroutines-ä¸­çš„ç”Ÿæˆå™¨-API" class="headerlink" title="kotlin.coroutines ä¸­çš„ç”Ÿæˆå™¨ API"></a>kotlin.coroutines ä¸­çš„ç”Ÿæˆå™¨ API</h4><p><code>kotlin.coroutines.experimental</code> ä¸­ä»…æœ‰çš„â€œåº”ç”¨ç¨‹åºçº§â€å‡½æ•°æ˜¯</p><ul><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/build-sequence.html" target="_blank" rel="external"><code>buildSequence()</code></a></li><li><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/build-iterator.html" target="_blank" rel="external"><code>buildIterator()</code></a></li></ul><p>è¿™äº›åŒ…å«åœ¨ <code>kotlin-stdlib</code> ä¸­å› ä¸ºä»–ä»¬ä¸åºåˆ—ç›¸å…³ã€‚è¿™äº›å‡½æ•°ï¼ˆæˆ‘ä»¬å¯ä»¥ä»…é™äºè¿™é‡Œçš„ <code>buildSequence()</code>ï¼‰å®ç°äº† <em>ç”Ÿæˆå™¨</em> ï¼Œå³æä¾›ä¸€ç§å»‰ä»·æ„å»ºæƒ°æ€§åºåˆ—çš„æ–¹æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> fibonacciSeq = buildSequence &#123;</div><div class="line">    <span class="keyword">var</span> a = <span class="number">0</span></div><div class="line">    <span class="keyword">var</span> b = <span class="number">1</span></div><div class="line"></div><div class="line">    yield(<span class="number">1</span>)</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">        yield(a + b)</div><div class="line"></div><div class="line">        <span class="keyword">val</span> tmp = a + b</div><div class="line">        a = b</div><div class="line">        b = tmp</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™é€šè¿‡åˆ›å»ºä¸€ä¸ªåç¨‹ç”Ÿæˆä¸€ä¸ªæƒ°æ€§çš„ã€æ½œåœ¨æ— é™çš„æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œè¯¥åç¨‹é€šè¿‡è°ƒç”¨ <code>yield()</code> å‡½æ•°æ¥äº§ç”Ÿè¿ç»­çš„æ–æ³¢çº³å¥‘æ•°ã€‚å½“åœ¨è¿™æ ·çš„åºåˆ—çš„è¿­ä»£å™¨ä¸Šè¿­ä»£æ¯ä¸€æ­¥ï¼Œéƒ½ä¼šæ‰§è¡Œç”Ÿæˆä¸‹ä¸€ä¸ªæ•°çš„åç¨‹çš„å¦ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¯¥åºåˆ—ä¸­å–å‡ºä»»ä½•æœ‰é™çš„æ•°å­—åˆ—è¡¨ï¼Œä¾‹å¦‚ <code>fibonacciSeq.take(8).toList()</code> ç»“æœæ˜¯ <code>[1, 1, 2, 3, 5, 8, 13, 21]</code>ã€‚åç¨‹è¶³å¤Ÿå»‰ä»·ä½¿è¿™å¾ˆå®ç”¨ã€‚</p><p>ä¸ºäº†æ¼”ç¤ºè¿™æ ·ä¸€ä¸ªåºåˆ—çš„çœŸæ­£æƒ°æ€§ï¼Œè®©æˆ‘ä»¬åœ¨è°ƒç”¨ <code>buildSequence()</code> å†…éƒ¨è¾“å‡ºä¸€äº›è°ƒè¯•ä¿¡æ¯ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> lazySeq = buildSequence &#123;</div><div class="line">    print(<span class="string">"START "</span>)</div><div class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.5</span>) &#123;</div><div class="line">        yield(i)</div><div class="line">        print(<span class="string">"STEP "</span>)</div><div class="line">    &#125;</div><div class="line">    print(<span class="string">"END"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è¾“å‡ºåºåˆ—çš„å‰ä¸‰ä¸ªå…ƒç´ </span></div><div class="line">lazySeq.take(<span class="number">3</span>).forEach &#123; print(<span class="string">"<span class="subst">$it</span> "</span>) &#125;</div></pre></td></tr></table></figure><p>è¿è¡Œä¸Šé¢çš„ä»£ç çœ‹ï¼Œæ˜¯ä¸æ˜¯æˆ‘ä»¬è¾“å‡ºå‰ä¸‰ä¸ªå…ƒç´ çš„æ•°å­—ä¸ç”Ÿæˆå¾ªç¯çš„ <code>STEP</code> æœ‰äº¤å‰ã€‚è¿™æ„å‘³ç€è®¡ç®—ç¡®å®æ˜¯æƒ°æ€§çš„ã€‚è¦è¾“å‡º <code>1</code>ï¼Œæˆ‘ä»¬åªæ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ª <code>yield(i)</code>ï¼Œå¹¶ä¸”è¿‡ç¨‹ä¸­ä¼šè¾“å‡º <code>START</code>ã€‚ç„¶åï¼Œè¾“å‡º <code>2</code>ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­ä¸‹ä¸€ä¸ª <code>yield(i)</code>ï¼Œå¹¶ä¼šè¾“å‡º <code>STEP</code>ã€‚<code>3</code> ä¹Ÿä¸€æ ·ã€‚æ°¸è¿œä¸ä¼šè¾“å‡ºå†ä¸‹ä¸€ä¸ª <code>STEP</code>ï¼ˆä»¥åŠ<code>END</code>ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬å†ä¹Ÿæ²¡æœ‰è¯·æ±‚åºåˆ—çš„åç»­å…ƒç´ ã€‚</p><p>ä¸ºäº†ä¸€æ¬¡äº§ç”Ÿå€¼çš„é›†åˆï¼ˆæˆ–åºåˆ—ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>yieldAll()</code> å‡½æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> lazySeq = buildSequence &#123;</div><div class="line">    yield(<span class="number">0</span>)</div><div class="line">    yieldAll(<span class="number">1.</span><span class="number">.10</span>) </div><div class="line">&#125;</div><div class="line"></div><div class="line">lazySeq.forEach &#123; print(<span class="string">"<span class="subst">$it</span> "</span>) &#125;</div></pre></td></tr></table></figure><p><code>buildIterator()</code> çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äº <code>buildSequence()</code>ï¼Œä½†è¿”å›ä¸€ä¸ªæƒ°æ€§è¿­ä»£å™¨ã€‚</p><p>å¯ä»¥é€šè¿‡ä¸º <code>SequenceBuilder</code> ç±»å†™æŒ‚èµ·æ‰©å±•ï¼ˆå¸¦æœ‰<a href="https://www.kotlincn.net/docs/reference/coroutines.html#restrictssuspension-æ³¨è§£" target="_blank" rel="external">ä¸Šæ–‡</a>æè¿°çš„ <code>@RestrictsSuspension</code> æ³¨è§£ï¼‰æ¥ä¸º <code>buildSequence()</code> æ·»åŠ è‡ªå®šä¹‰ç”Ÿäº§é€»è¾‘ï¼ˆcustom yielding logicï¼‰ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">suspend <span class="function"><span class="keyword">fun</span> SequenceBuilder<span class="type">&lt;Int&gt;</span>.<span class="title">yieldIfOdd</span><span class="params">(x: <span class="type">Int</span>)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> (x % <span class="number">2</span> != <span class="number">0</span>) yield(x)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">val</span> lazySeq = buildSequence &#123;</div><div class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) yieldIfOdd(i)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="å…¶ä»–é«˜çº§-APIï¼škotlinx-coroutines"><a href="#å…¶ä»–é«˜çº§-APIï¼škotlinx-coroutines" class="headerlink" title="å…¶ä»–é«˜çº§ APIï¼škotlinx.coroutines"></a>å…¶ä»–é«˜çº§ APIï¼škotlinx.coroutines</h4><p>åªæœ‰ä¸åç¨‹ç›¸å…³çš„æ ¸å¿ƒ API å¯ä»¥ä» Kotlin æ ‡å‡†åº“è·å¾—ã€‚è¿™ä¸»è¦åŒ…æ‹¬æ‰€æœ‰åŸºäºåç¨‹çš„åº“å¯èƒ½ä½¿ç”¨çš„æ ¸å¿ƒåŸè¯­å’Œæ¥å£ã€‚</p><p>å¤§å¤šæ•°åŸºäºåç¨‹çš„åº”ç”¨ç¨‹åºçº§APIéƒ½ä½œä¸ºå•ç‹¬çš„åº“å‘å¸ƒï¼š<a href="https://github.com/Kotlin/kotlinx.coroutines" target="_blank" rel="external"><code>kotlinx.coroutines</code></a>ã€‚è¿™ä¸ªåº“è¦†ç›–äº†</p><ul><li>ä½¿ç”¨<code>kotlinx-coroutines-core</code>çš„å¹³å°æ— å…³å¼‚æ­¥ç¼–ç¨‹</li></ul><ul><li>æ­¤æ¨¡å—åŒ…æ‹¬æ”¯æŒ <code>select</code> å’Œå…¶ä»–ä¾¿åˆ©åŸè¯­çš„ç±»ä¼¼ Go çš„ç®¡é“</li><li>è¿™ä¸ªåº“çš„ç»¼åˆæŒ‡å—<a href="https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md" target="_blank" rel="external">åœ¨è¿™é‡Œ</a>ã€‚</li></ul><ul><li><p>åŸºäº JDK 8 ä¸­çš„ <code>CompletableFuture</code> çš„ APIï¼š<code>kotlinx-coroutines-jdk8</code></p></li><li><p>åŸºäº JDK 7 åŠæ›´é«˜ç‰ˆæœ¬ API çš„éé˜»å¡ IOï¼ˆNIOï¼‰ï¼š<code>kotlinx-coroutines-nio</code></p></li><li><p>æ”¯æŒ Swing (<code>kotlinx-coroutines-swing</code>) å’Œ JavaFx (<code>kotlinx-coroutines-javafx</code>)</p></li><li><p>æ”¯æŒ RxJavaï¼š<code>kotlinx-coroutines-rx</code></p></li></ul><p>è¿™äº›åº“æ—¢ä½œä¸ºä½¿é€šç”¨ä»»åŠ¡æ˜“ç”¨çš„ä¾¿åˆ©çš„ APIï¼Œä¹Ÿä½œä¸ºå¦‚ä½•æ„å»ºåŸºäºåç¨‹çš„åº“çš„ç«¯åˆ°ç«¯ç¤ºä¾‹ã€‚</p><h2 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><h3 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h3><p>ä¸å¤§å¤šæ•°è¯­è¨€ä¸åŒï¼ŒKotlin åŒºåˆ†å¯å˜é›†åˆå’Œä¸å¯å˜é›†åˆï¼ˆlistsã€setsã€maps ç­‰ï¼‰ã€‚ç²¾ç¡®æ§åˆ¶ä»€ä¹ˆæ—¶å€™é›†åˆå¯ç¼–è¾‘æœ‰åŠ©äºæ¶ˆé™¤ bug å’Œè®¾è®¡è‰¯å¥½çš„ APIã€‚</p><p>é¢„å…ˆäº†è§£ä¸€ä¸ªå¯å˜é›†åˆçš„åªè¯» <em>è§†å›¾</em> å’Œä¸€ä¸ªçœŸæ­£çš„ä¸å¯å˜é›†åˆä¹‹é—´çš„åŒºåˆ«æ˜¯å¾ˆé‡è¦çš„ã€‚å®ƒä»¬éƒ½å®¹æ˜“åˆ›å»ºï¼Œä½†ç±»å‹ç³»ç»Ÿä¸èƒ½è¡¨è¾¾å®ƒä»¬çš„å·®åˆ«ï¼Œæ‰€ä»¥ç”±ä½ æ¥è·Ÿè¸ªï¼ˆæ˜¯å¦ç›¸å…³ï¼‰ã€‚</p><p>Kotlin çš„ <code>List&lt;out T&gt;</code> ç±»å‹æ˜¯ä¸€ä¸ªæä¾›åªè¯»æ“ä½œå¦‚ <code>size</code>ã€<code>get</code>ç­‰çš„æ¥å£ã€‚å’Œ Java ç±»ä¼¼ï¼Œå®ƒç»§æ‰¿è‡ª <code>Collection&lt;T&gt;</code> è¿›è€Œç»§æ‰¿è‡ª <code>Iterable&lt;T&gt;</code>ã€‚æ”¹å˜ list çš„æ–¹æ³•æ˜¯ç”± <code>MutableList&lt;T&gt;</code> åŠ å…¥çš„ã€‚è¿™ä¸€æ¨¡å¼åŒæ ·é€‚ç”¨äº <code>Set&lt;out T&gt;/MutableSet&lt;T&gt;</code> åŠ <code>Map&lt;K, out V&gt;/MutableMap&lt;K, V&gt;</code>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ list åŠ set ç±»å‹çš„åŸºæœ¬ç”¨æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> numbers: MutableList&lt;<span class="built_in">Int</span>&gt; = mutableListOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="keyword">val</span> readOnlyView: List&lt;<span class="built_in">Int</span>&gt; = numbers</div><div class="line">println(numbers)        <span class="comment">// è¾“å‡º "[1, 2, 3]"</span></div><div class="line">numbers.add(<span class="number">4</span>)</div><div class="line">println(readOnlyView)   <span class="comment">// è¾“å‡º "[1, 2, 3, 4]"</span></div><div class="line">readOnlyView.clear()    <span class="comment">// -&gt; ä¸èƒ½ç¼–è¯‘</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> strings = hashSetOf(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"c"</span>)</div><div class="line">assert(strings.size == <span class="number">3</span>)</div></pre></td></tr></table></figure><p>Kotlin æ²¡æœ‰ä¸“é—¨çš„è¯­æ³•ç»“æ„åˆ›å»º list æˆ– setã€‚ è¦ç”¨æ ‡å‡†åº“çš„æ–¹æ³•ï¼Œå¦‚ <code>listOf()</code>ã€ <code>mutableListOf()</code>ã€ <code>setOf()</code>ã€ <code>mutableSetOf()</code>ã€‚ åœ¨éæ€§èƒ½å…³é”®ä»£ç ä¸­åˆ›å»º map å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„<a href="https://www.kotlincn.net/docs/reference/idioms.html#åªè¯»-map" target="_blank" rel="external">æƒ¯ç”¨æ³•</a>æ¥å®Œæˆï¼š<code>mapOf(a to b, c to d)</code>ã€‚</p><p>æ³¨æ„ä¸Šé¢çš„ <code>readOnlyView</code> å˜é‡ï¼ˆè¯‘è€…æ³¨ï¼šä¸å¯¹åº”å¯å˜é›†åˆå˜é‡ <code>numbers</code>ï¼‰æŒ‡å‘ç›¸åŒçš„åº•å±‚ list å¹¶ä¼šéšä¹‹æ”¹å˜ã€‚ å¦‚æœä¸€ä¸ª list åªå­˜åœ¨åªè¯»å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è¯¥é›†åˆå®Œå…¨ä¸å¯å˜ã€‚åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„é›†åˆçš„ä¸€ä¸ªç®€å•æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> items = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div></pre></td></tr></table></figure><p>ç›®å‰ <code>listOf</code> æ–¹æ³•æ˜¯ä½¿ç”¨ array list å®ç°çš„ï¼Œä½†æ˜¯æœªæ¥å¯ä»¥åˆ©ç”¨å®ƒä»¬çŸ¥é“è‡ªå·±ä¸èƒ½å˜çš„äº‹å®ï¼Œè¿”å›æ›´èŠ‚çº¦å†…å­˜çš„å®Œå…¨ä¸å¯å˜çš„é›†åˆç±»å‹ã€‚</p><p>æ³¨æ„è¿™äº›ç±»å‹æ˜¯<a href="#å‹å˜">åå˜çš„</a>ã€‚è¿™æ„å‘³ç€ï¼Œä½ å¯ä»¥æŠŠä¸€ä¸ª <code>List&lt;Rectangle&gt;</code> èµ‹å€¼ç»™ <code>List&lt;Shape&gt;</code> å‡å®š Rectangle ç»§æ‰¿è‡ª Shapeã€‚å¯¹äºå¯å˜é›†åˆç±»å‹è¿™æ˜¯ä¸å…è®¸çš„ï¼Œå› ä¸ºè¿™å°†å¯¼è‡´è¿è¡Œæ—¶æ•…éšœã€‚</p><p>æœ‰æ—¶ä½ æƒ³ç»™è°ƒç”¨è€…è¿”å›ä¸€ä¸ªé›†åˆåœ¨æŸä¸ªç‰¹å®šæ—¶é—´çš„ä¸€ä¸ªå¿«ç…§, ä¸€ä¸ªä¿è¯ä¸ä¼šå˜çš„ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">val</span> _items = mutableListOf&lt;String&gt;()</div><div class="line">    <span class="keyword">val</span> items: List&lt;String&gt; <span class="keyword">get</span>() = _items.toList()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™ä¸ª <code>toList</code> æ‰©å±•æ–¹æ³•åªæ˜¯å¤åˆ¶åˆ—è¡¨é¡¹ï¼Œå› æ­¤è¿”å›çš„ list ä¿è¯æ°¸è¿œä¸ä¼šæ”¹å˜ã€‚</p><p>List å’Œ set æœ‰å¾ˆå¤šæœ‰ç”¨çš„æ‰©å±•æ–¹æ³•å€¼å¾—ç†Ÿæ‚‰ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> items = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">items.first() == <span class="number">1</span></div><div class="line">items.last() == <span class="number">4</span></div><div class="line">items.filter &#123; it % <span class="number">2</span> == <span class="number">0</span> &#125;   <span class="comment">// è¿”å› [2, 4]</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> rwList = mutableListOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">rwList.requireNoNulls()        <span class="comment">// è¿”å› [1, 2, 3]</span></div><div class="line"><span class="keyword">if</span> (rwList.none &#123; it &gt; <span class="number">6</span> &#125;) println(<span class="string">"No items above 6"</span>)  <span class="comment">// è¾“å‡ºâ€œNo items above 6â€</span></div><div class="line"><span class="keyword">val</span> item = rwList.firstOrNull()</div></pre></td></tr></table></figure><p>â€¦â€¦ ä»¥åŠæ‰€æœ‰ä½ æ‰€æœŸæœ›çš„å®ç”¨å·¥å…·ï¼Œä¾‹å¦‚ sortã€zipã€foldã€reduce ç­‰ç­‰ã€‚</p><p>Map éµå¾ªåŒæ ·æ¨¡å¼ã€‚å®ƒä»¬å¯ä»¥å®¹æ˜“åœ°å®ä¾‹åŒ–å’Œè®¿é—®ï¼Œåƒè¿™æ ·ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> readWriteMap = hashMapOf(<span class="string">"foo"</span> to <span class="number">1</span>, <span class="string">"bar"</span> to <span class="number">2</span>)</div><div class="line">println(readWriteMap[<span class="string">"foo"</span>])  <span class="comment">// è¾“å‡ºâ€œ1â€</span></div><div class="line"><span class="keyword">val</span> snapshot: Map&lt;String, <span class="built_in">Int</span>&gt; = HashMap(readWriteMap)</div></pre></td></tr></table></figure><h3 id="ç±»å‹å®‰å…¨å’Œæ™ºèƒ½è½¬æ¢"><a href="#ç±»å‹å®‰å…¨å’Œæ™ºèƒ½è½¬æ¢" class="headerlink" title="ç±»å‹å®‰å…¨å’Œæ™ºèƒ½è½¬æ¢"></a>ç±»å‹å®‰å…¨å’Œæ™ºèƒ½è½¬æ¢</h3><h4 id="ç©ºå®‰å…¨"><a href="#ç©ºå®‰å…¨" class="headerlink" title="ç©ºå®‰å…¨"></a>ç©ºå®‰å…¨</h4><p>Kotlin çš„ç±»å‹ç³»ç»Ÿ</p><ul><li>å¯ç©ºç±»å‹</li><li>éç©ºç±»å‹</li></ul><p>å®ƒæ¶ˆé™¤äº†å¾ˆå¤šç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚: Javaï¼‰æ¥è‡ªäºä»£ç ç©ºå¼•ç”¨,è€Œå¯¼è‡´çš„ <code>NullPointerException</code> æˆ–ç®€ç§° <code>NPE</code> ã€‚</p><p>NOTE: Kotlin å‘ç”Ÿ NPE åŸå› å¯èƒ½å¦‚ä¸‹:</p><ul><li>æ˜¾å¼è°ƒç”¨ <code>throw NullPointerException()</code></li><li>ä½¿ç”¨äº†ä¸‹æ–‡æè¿°çš„ <code>!!</code> æ“ä½œç¬¦ </li><li>å¤–éƒ¨ Java ä»£ç å¯¼è‡´çš„</li></ul><p>åœ¨ä¸Šé¢ <a href="#å˜é‡">å˜é‡</a>  ä¸­, Kotlin é»˜è®¤å£°æ˜å˜é‡æ—¶æ˜¯éç©ºç±»å‹çš„,è¦ä½¿è¯¥å˜é‡æ¥æ”¶ <code>null</code> å€¼ï¼Œéœ€ä½¿ç”¨ <code>ï¼Ÿ</code> æ“ä½œç¬¦ , ä¾‹å­å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var aNullNothing = null</div><div class="line">var bNullUnable: Int = null //ä¸èƒ½ä¸ºç©º</div><div class="line">var cNullUnable = 1 //ä¸èƒ½ä¸ºç©º</div><div class="line">var cNullable: Int? = null //èƒ½ä¸ºç©º</div><div class="line">var dNullable: Any? = 1 //èƒ½ä¸ºç©º </div><div class="line"></div><div class="line">fun fun0(): Unit &#123;</div><div class="line">    aNullNothing = 1 //Nothing error</div><div class="line">    cNullUnable = null</div><div class="line">    cNullable = 1</div><div class="line">    dNullable = null //å¯ä»¥ null</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å½“å£°æ˜å¯ç©ºç±»å‹å˜é‡æ—¶,å®ƒæ˜¯ä¸å®‰å…¨çš„,è®¿é—®æ–¹æ³•æˆ–å±æ€§æ—¶éœ€è¦ä½œå¤„ç†:</p><ul><li>åœ¨æ¡ä»¶ä¸­æ£€æŸ¥ null ,ä½†ä»…é€‚ç”¨äº <code>val</code> ä¸”ä¸å¯è¦†ç›–ï¼ˆå³ä¸èƒ½ç”¨ open ä¿®é¥°ï¼‰æˆ–è€… <code>get</code> çš„ä¸å¯å˜çš„å˜é‡ã€‚</li><li>å®‰å…¨çš„è°ƒç”¨ <code>?.</code> , è‹¥ä¸ºnull åˆ™è·³è¿‡,å¦åˆ™æ¥ç€è°ƒç”¨</li><li>!! æ“ä½œç¬¦ ,ä¼šè¿”å›ä¸€ä¸ªéç©ºçš„å€¼,å¦åˆ™æŠ›å‡ºä¸€ä¸ª <code>NPE</code> å¼‚å¸¸ </li></ul><p>æ¡ä»¶ä¸­æ£€æŸ¥ nul ä¾‹å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">open class TestCheckNull &#123;</div><div class="line">    val cReadNullable: Int? = 1</div><div class="line">    val cGetReadNullable: Int? get() = 1</div><div class="line">    open val cOverrideReadNullable: Int? = 1</div><div class="line"></div><div class="line">    fun fun0(): Unit &#123;</div><div class="line">        if (cReadNullable != null) &#123;</div><div class="line">            cReadNullable.dec() //tips replace safe access expression</div><div class="line">        &#125;</div><div class="line">        if (cGetReadNullable != null) &#123;</div><div class="line">            cGetReadNullable.dec()</div><div class="line">        &#125;</div><div class="line">        if (cOverrideReadNullable != null) &#123;</div><div class="line">            cOverrideReadNullable.dec()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å®‰å…¨è°ƒç”¨å’Œ!! æ“ä½œç¬¦å¯¹æ¯”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cNullUnable.dec() //ä¿è¯ä¸ä¼šå¯¼è‡´ NPE</div><div class="line">val hc = dNullable?.hashCode() //dNullable == null return null, hc is null</div><div class="line">val dec = cNullable?.dec() // cNullable !=null return cNullable.dec(),dec is &quot;0&quot;</div><div class="line">cNullable!!.dec() // cNullable !=null execute dec()</div><div class="line">dNullable!!.toString() // dNullable == null throws NPE</div><div class="line">var aNotNullObject = cNullable!!</div></pre></td></tr></table></figure><h4 id="ç±»å‹æ£€æµ‹å’Œå®‰å…¨çš„ç±»å‹è½¬æ¢"><a href="#ç±»å‹æ£€æµ‹å’Œå®‰å…¨çš„ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹æ£€æµ‹å’Œå®‰å…¨çš„ç±»å‹è½¬æ¢"></a>ç±»å‹æ£€æµ‹å’Œå®‰å…¨çš„ç±»å‹è½¬æ¢</h4><ul><li><code>is</code> <code>!is</code> è¿ç®—ç¬¦æ£€æµ‹ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æŸç±»å‹çš„ä¸€ä¸ªå®ä¾‹ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œä¸éœ€è¦åœ¨ Kotlin ä¸­ä½¿ç”¨æ˜¾å¼è½¬æ¢æ“ä½œç¬¦ï¼Œå› ä¸ºç¼–è¯‘å™¨è·Ÿè¸ªä¸å¯å˜å€¼çš„ <code>is</code>-æ£€æŸ¥ï¼Œå¹¶åœ¨éœ€è¦æ—¶è‡ªåŠ¨æ’å…¥ï¼ˆ<strong>å®‰å…¨</strong>çš„ï¼‰è½¬æ¢:</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">val obj: Any = &quot;&quot;</div><div class="line">if (obj is String) &#123;</div><div class="line">    print(obj.length)</div><div class="line">&#125;</div><div class="line">if (obj !is String) &#123; // ä¸ !(obj is String) ç›¸åŒ</div><div class="line">    print(&quot;Not a String&quot;)</div><div class="line">&#125; else if (obj is String) &#123;</div><div class="line">    print(obj.length)</div><div class="line">&#125; else &#123;</div><div class="line">    print(obj.length)</div><div class="line">&#125;</div><div class="line">when(obj)&#123;</div><div class="line">    is String -&gt; obj.length</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li><code>as</code> <code>as?</code> è¿ç®—ç¬¦èƒ½æŠŠå¯¹è±¡è½¬æ¢ä¸ºç›®æ ‡ç±»å‹ï¼Œå¸¸è§„ç±»å‹è½¬æ¢å¯èƒ½ä¼šå¯¼è‡´ <code>ClassCastException</code>ã€‚ä½¿ç”¨å®‰å…¨çš„ç±»å‹è½¬æ¢ç¬¦ <code>as?</code>ï¼Œå¦‚æœå°è¯•è½¬æ¢ä¸æˆåŠŸåˆ™è¿”å› <em>null</em>ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">val father = Father()</div><div class="line">val son = Son()</div><div class="line">println(father is Son)</div><div class="line">println(son is Father)</div><div class="line"></div><div class="line">val fatherSon: Father = Son()</div><div class="line">println(fatherSon is Son)</div><div class="line">println(fatherSon is Father)</div><div class="line"></div><div class="line">val sonFatherSon: Son = fatherSon as Son</div><div class="line">println(sonFatherSon != null)</div><div class="line"></div><div class="line">val newFather: Son? = father as? Son</div><div class="line">val newFather1 = father as? Son  //newFather1 start define val newFather : Son?</div><div class="line">val newFather2 = father as Son // newFather1 start define val newFather : Son</div><div class="line">println(newFather == null)</div></pre></td></tr></table></figure><p>NOTE: Kotlin ç±»å‹æ£€æµ‹ååˆ†æ™ºèƒ½, æƒ³äº†è§£è¯·æ›´å¤šå‚è€ƒ <a href="https://kotlinlang.org/docs/reference/typecasts.html#type-checks-and-casts-is-and-as" target="_blank" rel="external">Type Checks and Casts</a></p><h3 id="æ“ä½œç¬¦é‡è½½"><a href="#æ“ä½œç¬¦é‡è½½" class="headerlink" title="æ“ä½œç¬¦é‡è½½"></a>æ“ä½œç¬¦é‡è½½</h3><p>Kotlin å…è®¸æˆ‘ä»¬ä¸ºè‡ªå·±çš„ç±»å‹æä¾›é¢„å®šä¹‰çš„ä¸€ç»„æ“ä½œç¬¦çš„å®ç°ã€‚è¿™äº›æ“ä½œç¬¦å…·æœ‰å›ºå®šçš„ç¬¦å·è¡¨ç¤ºï¼ˆå¦‚ <code>+</code> æˆ– <code>*</code>ï¼‰å’Œå›ºå®šçš„<a href="https://www.kotlincn.net/docs/reference/grammar.html#precedence" target="_blank" rel="external">ä¼˜å…ˆçº§</a>ã€‚ä¸ºå®ç°è¿™æ ·çš„æ“ä½œç¬¦ï¼Œæˆ‘ä»¬ä¸ºç›¸åº”çš„ç±»å‹ï¼ˆå³äºŒå…ƒæ“ä½œç¬¦å·¦ä¾§çš„ç±»å‹å’Œä¸€å…ƒæ“ä½œç¬¦çš„å‚æ•°ç±»å‹ï¼‰æä¾›äº†ä¸€ä¸ªå›ºå®šåå­—çš„<a href="l#æˆå‘˜å‡½æ•°">æˆå‘˜å‡½æ•°</a>æˆ–<a href="#æ‰©å±•å‡½æ•°">æ‰©å±•å‡½æ•°</a>ã€‚<br>é‡è½½æ“ä½œç¬¦çš„å‡½æ•°éœ€è¦ç”¨ <code>operator</code> ä¿®é¥°ç¬¦æ ‡è®°ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬æè¿°ä¸ºä¸åŒæ“ä½œç¬¦è§„èŒƒæ“ä½œç¬¦é‡è½½çš„çº¦å®šã€‚</p><h4 id="ä¸€å…ƒå‰ç¼€æ“ä½œç¬¦"><a href="#ä¸€å…ƒå‰ç¼€æ“ä½œç¬¦" class="headerlink" title="ä¸€å…ƒå‰ç¼€æ“ä½œç¬¦"></a>ä¸€å…ƒå‰ç¼€æ“ä½œç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>+a</td><td>a.unaryPlus()</td></tr><tr><td>-a</td><td>a.unaryMinus()</td></tr><tr><td>!a</td><td>a.not()</td></tr></tbody></table><p>è¿™ä¸ªè¡¨æ˜¯è¯´ï¼Œå½“ç¼–è¯‘å™¨å¤„ç†ä¾‹å¦‚è¡¨è¾¾å¼ <code>+a</code> æ—¶ï¼Œå®ƒæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>ç¡®å®š <code>a</code> çš„ç±»å‹ï¼Œä»¤å…¶ä¸º <code>T</code>ã€‚</li><li>ä¸ºæ¥æ”¶è€… <code>T</code> æŸ¥æ‰¾ä¸€ä¸ªå¸¦æœ‰ <code>operator</code> ä¿®é¥°ç¬¦çš„æ— å‚å‡½æ•° <code>unaryPlusï¼ˆï¼‰</code>ï¼Œå³æˆå‘˜å‡½æ•°æˆ–æ‰©å±•å‡½æ•°ã€‚</li><li>å¦‚æœå‡½æ•°ä¸å­˜åœ¨æˆ–ä¸æ˜ç¡®ï¼Œåˆ™å¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</li><li>å¦‚æœå‡½æ•°å­˜åœ¨ä¸”å…¶è¿”å›ç±»å‹ä¸º <code>R</code>ï¼Œé‚£å°±è¡¨è¾¾å¼ <code>+a</code> å…·æœ‰ç±»å‹ <code>R</code>ã€‚</li></ul><p><em>æ³¨æ„</em> è¿™äº›æ“ä½œä»¥åŠæ‰€æœ‰å…¶ä»–æ“ä½œéƒ½é’ˆå¯¹<a href="#åŸºæœ¬æ•°æ®ç±»å‹">åŸºæœ¬ç±»å‹</a>åšäº†ä¼˜åŒ–ï¼Œä¸ä¼šä¸ºå®ƒä»¬å¼•å…¥å‡½æ•°è°ƒç”¨çš„å¼€é”€ã€‚</p><p>ä»¥ä¸‹æ˜¯å¦‚ä½•é‡è½½ä¸€å…ƒå‡è¿ç®—ç¬¦çš„ç¤ºä¾‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Point</span></span>(<span class="keyword">val</span> x: <span class="built_in">Int</span>, <span class="keyword">val</span> y: <span class="built_in">Int</span>)</div><div class="line"></div><div class="line"><span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> Point.<span class="title">unaryMinus</span><span class="params">()</span></span> = Point(-x, -y)</div><div class="line"></div><div class="line"><span class="keyword">val</span> point = Point(<span class="number">10</span>, <span class="number">20</span>)</div><div class="line">println(-point)  <span class="comment">// è¾“å‡ºâ€œ(-10, -20)â€</span></div></pre></td></tr></table></figure><h4 id="é€’å¢ä¸é€’å‡"><a href="#é€’å¢ä¸é€’å‡" class="headerlink" title="é€’å¢ä¸é€’å‡"></a>é€’å¢ä¸é€’å‡</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a++</td><td>a.inc() + è§ä¸‹æ–‡</td></tr><tr><td>aâ€“</td><td>a.dec() + è§ä¸‹æ–‡</td></tr></tbody></table><p><code>inc()</code> å’Œ <code>dec()</code> å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå€¼ï¼Œå®ƒç”¨äºèµ‹å€¼ç»™ä½¿ç”¨<code>++</code> æˆ– <code>--</code> æ“ä½œçš„å˜é‡ã€‚å®ƒä»¬ä¸åº”è¯¥æ”¹å˜åœ¨å…¶ä¸Šè°ƒç”¨ <code>inc()</code> æˆ– <code>dec()</code> çš„å¯¹è±¡ã€‚</p><p>ç¼–è¯‘å™¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤æ¥è§£æ<em>åç¼€</em>å½¢å¼çš„æ“ä½œç¬¦ï¼Œä¾‹å¦‚ <code>a++</code>ï¼š</p><ul><li>ç¡®å®š <code>a</code> çš„ç±»å‹ï¼Œä»¤å…¶ä¸º <code>T</code>ã€‚</li><li>æŸ¥æ‰¾ä¸€ä¸ªé€‚ç”¨äºç±»å‹ä¸º <code>T</code> çš„æ¥æ”¶è€…çš„ã€å¸¦æœ‰ <code>operator</code> ä¿®é¥°ç¬¦çš„æ— å‚æ•°å‡½æ•° <code>inc()</code>ã€‚</li><li>æ£€æŸ¥å‡½æ•°çš„è¿”å›ç±»å‹æ˜¯ <code>T</code> çš„å­ç±»å‹ã€‚</li></ul><p>è®¡ç®—è¡¨è¾¾å¼çš„æ­¥éª¤æ˜¯ï¼š</p><ul><li>æŠŠ <code>a</code> çš„åˆå§‹å€¼å­˜å‚¨åˆ°ä¸´æ—¶å­˜å‚¨ <code>a0</code> ä¸­ï¼Œ</li><li>æŠŠ <code>a.inc()</code> ç»“æœèµ‹å€¼ç»™ <code>a</code>ï¼Œ</li><li>æŠŠ <code>a0</code> ä½œä¸ºè¡¨è¾¾å¼çš„ç»“æœè¿”å›ã€‚</li></ul><p>å¯¹äº <code>a--</code>ï¼Œæ­¥éª¤æ˜¯å®Œå…¨ç±»ä¼¼çš„ã€‚</p><p>å¯¹äº<em>å‰ç¼€</em>å½¢å¼ <code>++a</code> å’Œ <code>--a</code> ä»¥ç›¸åŒæ–¹å¼è§£æï¼Œå…¶æ­¥éª¤æ˜¯ï¼š</p><ul><li>æŠŠ <code>a.inc()</code> ç»“æœèµ‹å€¼ç»™ <code>a</code>ï¼Œ</li><li>æŠŠ <code>a</code> çš„æ–°å€¼ä½œä¸ºè¡¨è¾¾å¼ç»“æœè¿”å›ã€‚</li></ul><h4 id="äºŒå…ƒæ“ä½œç®—æœ¯è¿ç®—ç¬¦"><a href="#äºŒå…ƒæ“ä½œç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="äºŒå…ƒæ“ä½œç®—æœ¯è¿ç®—ç¬¦"></a>äºŒå…ƒæ“ä½œç®—æœ¯è¿ç®—ç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a + b</td><td>a.plus(b)</td></tr><tr><td>a - b</td><td>a.minus(b)</td></tr><tr><td>a * b</td><td>a.times(b)</td></tr><tr><td>a / b</td><td>a.div(b)</td></tr><tr><td>a % b</td><td>a.rem(b)ã€ a.mod(b) ï¼ˆå·²å¼ƒç”¨ï¼‰</td></tr><tr><td>a..b</td><td>a.rangeTo(b)</td></tr></tbody></table><p>å¯¹äºæ­¤è¡¨ä¸­çš„æ“ä½œï¼Œç¼–è¯‘å™¨åªæ˜¯è§£ææˆ<em>ç¿»è¯‘ä¸º</em>åˆ—ä¸­çš„è¡¨è¾¾å¼ã€‚</p><p>è¯·æ³¨æ„ï¼Œè‡ª Kotlin 1.1 èµ·æ”¯æŒ <code>rem</code> è¿ç®—ç¬¦ã€‚Kotlin 1.0 ä½¿ç”¨ <code>mod</code> è¿ç®—ç¬¦ï¼Œå®ƒåœ¨<br>Kotlin 1.1 ä¸­è¢«å¼ƒç”¨ã€‚</p><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä»ç»™å®šå€¼èµ·å§‹çš„ Counter ç±»çš„ç¤ºä¾‹ï¼Œå®ƒå¯ä»¥ä½¿ç”¨é‡è½½çš„ <code>+</code> è¿ç®—ç¬¦æ¥å¢åŠ è®¡æ•°ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Counter</span></span>(<span class="keyword">val</span> dayIndex: <span class="built_in">Int</span>) &#123;</div><div class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">plus</span><span class="params">(increment: <span class="type">Int</span>)</span></span>: Counter &#123;</div><div class="line">        <span class="keyword">return</span> Counter(dayIndex + increment)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Inæ“ä½œç¬¦"><a href="#Inæ“ä½œç¬¦" class="headerlink" title="Inæ“ä½œç¬¦"></a>Inæ“ä½œç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a in b</td><td>b.contains(a)</td></tr><tr><td>a !in b</td><td>!b.contains(a)</td></tr></tbody></table><p>å¯¹äº <code>in</code> å’Œ <code>!in</code>ï¼Œè¿‡ç¨‹æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å‚æ•°çš„é¡ºåºæ˜¯ç›¸åçš„ã€‚</p><h4 id="ç´¢å¼•è®¿é—®æ“ä½œç¬¦"><a href="#ç´¢å¼•è®¿é—®æ“ä½œç¬¦" class="headerlink" title="ç´¢å¼•è®¿é—®æ“ä½œç¬¦"></a>ç´¢å¼•è®¿é—®æ“ä½œç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a[i]</td><td>a.get(i)</td></tr><tr><td>a[i, j]</td><td>a.get(i, j)</td></tr><tr><td>a[i_1, â€¦â€¦,  i_n]</td><td>a.get(i_1, â€¦â€¦,  i_n)</td></tr><tr><td>a[i] = b</td><td>a.set(i, b)</td></tr><tr><td>a[i, j] = b</td><td>a.set(i, j, b)</td></tr><tr><td>a[i_1, â€¦â€¦,  i_n] = b</td><td>a.set(i_1, â€¦â€¦, i_n, b)</td></tr></tbody></table><p>æ–¹æ‹¬å·è½¬æ¢ä¸ºè°ƒç”¨å¸¦æœ‰é€‚å½“æ•°é‡å‚æ•°çš„ <code>get</code> å’Œ <code>set</code>ã€‚</p><h4 id="è°ƒç”¨æ“ä½œç¬¦"><a href="#è°ƒç”¨æ“ä½œç¬¦" class="headerlink" title="è°ƒç”¨æ“ä½œç¬¦"></a>è°ƒç”¨æ“ä½œç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a()</td><td>a.invoke()</td></tr><tr><td>a(i)</td><td>a.invoke(i)</td></tr><tr><td>a(i, j)</td><td>a.invoke(i, j)</td></tr><tr><td>a(i_1, â€¦â€¦,  i_n)</td><td>a.invoke(i_1, â€¦â€¦,  i_n)</td></tr></tbody></table><p>åœ†æ‹¬å·è½¬æ¢ä¸ºè°ƒç”¨å¸¦æœ‰é€‚å½“æ•°é‡å‚æ•°çš„ <code>invoke</code>ã€‚</p><h4 id="å¹¿ä¹‰èµ‹å€¼"><a href="#å¹¿ä¹‰èµ‹å€¼" class="headerlink" title="å¹¿ä¹‰èµ‹å€¼"></a>å¹¿ä¹‰èµ‹å€¼</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a += b</td><td>a.plusAssign(b)</td></tr><tr><td>a -= b</td><td>a.minusAssign(b)</td></tr><tr><td>a *= b</td><td>a.timesAssign(b)</td></tr><tr><td>a /= b</td><td>a.divAssign(b)</td></tr><tr><td>a %= b</td><td>a.remAssign(b), a.modAssign(b)ï¼ˆå·²å¼ƒç”¨ï¼‰</td></tr></tbody></table><p>å¯¹äºèµ‹å€¼æ“ä½œï¼Œä¾‹å¦‚ <code>a += b</code>ï¼Œç¼–è¯‘å™¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>å¦‚æœå³åˆ—çš„å‡½æ•°å¯ç”¨<ul><li>å¦‚æœç›¸åº”çš„äºŒå…ƒå‡½æ•°ï¼ˆå³ <code>plusAssign()</code> å¯¹åº”äº <code>plus()</code>ï¼‰ä¹Ÿå¯ç”¨ï¼Œé‚£ä¹ˆæŠ¥å‘Šé”™è¯¯ï¼ˆæ¨¡ç³Šï¼‰ã€‚</li><li>ç¡®ä¿å…¶è¿”å›ç±»å‹æ˜¯ <code>Unit</code>ï¼Œå¦åˆ™æŠ¥å‘Šé”™è¯¯ã€‚</li><li>ç”Ÿæˆ <code>a.plusAssign(b)</code> çš„ä»£ç </li></ul></li><li>å¦åˆ™è¯•ç€ç”Ÿæˆ <code>a = a + b</code> çš„ä»£ç ï¼ˆè¿™é‡ŒåŒ…å«ç±»å‹æ£€æŸ¥ï¼š<code>a + b</code> çš„ç±»å‹å¿…é¡»æ˜¯ <code>a</code> çš„å­ç±»å‹ï¼‰ã€‚</li></ul><p><em>æ³¨æ„</em>ï¼šèµ‹å€¼åœ¨ Kotlin ä¸­<em>ä¸æ˜¯</em>è¡¨è¾¾å¼ã€‚</p><h4 id="ç›¸ç­‰ä¸ä¸ç­‰æ“ä½œç¬¦"><a href="#ç›¸ç­‰ä¸ä¸ç­‰æ“ä½œç¬¦" class="headerlink" title="ç›¸ç­‰ä¸ä¸ç­‰æ“ä½œç¬¦"></a>ç›¸ç­‰ä¸ä¸ç­‰æ“ä½œç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a == b</td><td>a?.equals(b) ?: (b === null)</td></tr><tr><td>a != b</td><td>!(a?.equals(b) ?: (b === <code>null</code>))</td></tr></tbody></table><p><em>æ³¨æ„</em>ï¼š<code>===</code> å’Œ <code>!==</code>ï¼ˆåŒä¸€æ€§æ£€æŸ¥ï¼‰ä¸å¯é‡è½½ï¼Œå› æ­¤ä¸å­˜åœ¨å¯¹ä»–ä»¬çš„çº¦å®š</p><p>è¿™ä¸ª <code>==</code> æ“ä½œç¬¦æœ‰äº›ç‰¹æ®Šï¼šå®ƒè¢«ç¿»è¯‘æˆä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼ï¼Œç”¨äºç­›é€‰ <code>null</code> å€¼ã€‚<br><code>null == null</code>  æ€»æ˜¯ trueï¼Œå¯¹äºéç©ºçš„ <code>x</code>ï¼Œ<code>x == null</code> æ€»æ˜¯ false è€Œä¸ä¼šè°ƒç”¨ <code>x.equals()</code>ã€‚</p><h4 id="æ¯”è¾ƒæ“ä½œç¬¦"><a href="#æ¯”è¾ƒæ“ä½œç¬¦" class="headerlink" title="æ¯”è¾ƒæ“ä½œç¬¦"></a>æ¯”è¾ƒæ“ä½œç¬¦</h4><table><thead><tr><th>è¡¨è¾¾å¼</th><th>ç¿»è¯‘ä¸º</th></tr></thead><tbody><tr><td>a &gt; b</td><td>a.compareTo(b) &gt; 0</td></tr><tr><td>a &lt; b</td><td>a.compareTo(b) &lt; 0</td></tr><tr><td>a &gt;= b</td><td>a.compareTo(b) &gt;= 0</td></tr><tr><td>a &lt;= b</td><td>a.compareTo(b) &lt;= 0</td></tr></tbody></table><p>æ‰€æœ‰çš„æ¯”è¾ƒéƒ½è½¬æ¢ä¸ºå¯¹ <code>compareTo</code> çš„è°ƒç”¨ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦è¿”å› <code>Int</code> å€¼</p><h4 id="å±æ€§å§”æ‰˜æ“ä½œç¬¦"><a href="#å±æ€§å§”æ‰˜æ“ä½œç¬¦" class="headerlink" title="å±æ€§å§”æ‰˜æ“ä½œç¬¦"></a>å±æ€§å§”æ‰˜æ“ä½œç¬¦</h4><p><code>provideDelegate</code>ã€ <code>getValue</code> ä»¥åŠ <code>setValue</code> æ“ä½œç¬¦å‡½æ•°å·²åœ¨<a href="#å§”æ‰˜å±æ€§">å§”æ‰˜å±æ€§</a>ä¸­æè¿°ã€‚</p><h4 id="å‘½åå‡½æ•°çš„ä¸­ç¼€è°ƒç”¨"><a href="#å‘½åå‡½æ•°çš„ä¸­ç¼€è°ƒç”¨" class="headerlink" title="å‘½åå‡½æ•°çš„ä¸­ç¼€è°ƒç”¨"></a>å‘½åå‡½æ•°çš„ä¸­ç¼€è°ƒç”¨</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<a href="#ä¸­ç¼€è¡¨ç¤ºæ³•">ä¸­ç¼€å‡½æ•°çš„è°ƒç”¨</a> æ¥æ¨¡æ‹Ÿè‡ªå®šä¹‰ä¸­ç¼€æ“ä½œç¬¦ã€‚</p><h3 id="ç±»å‹ç›¸ç­‰æ€§"><a href="#ç±»å‹ç›¸ç­‰æ€§" class="headerlink" title="ç±»å‹ç›¸ç­‰æ€§"></a>ç±»å‹ç›¸ç­‰æ€§</h3><p>Kotlin ä¸­æœ‰ä¸¤ç§ç±»å‹çš„ç›¸ç­‰æ€§ï¼š</p><ul><li>å¼•ç”¨ç›¸ç­‰ï¼ˆä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡ï¼‰</li></ul><ul><li>ç»“æ„ç›¸ç­‰ï¼ˆç”¨ equals() æ£€æŸ¥ï¼‰</li></ul><h4 id="å¼•ç”¨ç›¸ç­‰"><a href="#å¼•ç”¨ç›¸ç­‰" class="headerlink" title="å¼•ç”¨ç›¸ç­‰"></a>å¼•ç”¨ç›¸ç­‰</h4><p>å¼•ç”¨ç›¸ç­‰ç”± <code>===</code>ï¼ˆä»¥åŠå…¶å¦å®šå½¢å¼ <code>!==</code>ï¼‰æ“ä½œåˆ¤æ–­ã€‚<code>a === b</code> å½“ä¸”ä»…å½“ a å’Œ b æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ—¶æ±‚å€¼ä¸º trueã€‚</p><h4 id="ç»“æ„ç›¸ç­‰"><a href="#ç»“æ„ç›¸ç­‰" class="headerlink" title="ç»“æ„ç›¸ç­‰"></a>ç»“æ„ç›¸ç­‰</h4><p>ç»“æ„ç›¸ç­‰ç”± <code>==</code>ï¼ˆä»¥åŠå…¶å¦å®šå½¢å¼ <code>!=</code>ï¼‰æ“ä½œåˆ¤æ–­ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œåƒ <code>a == b</code> è¿™æ ·çš„è¡¨è¾¾å¼ä¼šç¿»è¯‘æˆ</p><p><code>a?.equals(b) ?: (b === null)</code></p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœ <code>a</code> ä¸æ˜¯ <code>null</code> åˆ™è°ƒç”¨ <code>equals(Any?)</code> å‡½æ•°ï¼Œå¦åˆ™ï¼ˆå³ <code>a</code> æ˜¯ <code>null</code>ï¼‰æ£€æŸ¥ <code>b</code> æ˜¯å¦ä¸ <code>null</code> å¼•ç”¨ç›¸ç­‰ã€‚</p><p>è¯·æ³¨æ„ï¼Œå½“ä¸ <code>null</code> æ˜¾å¼æ¯”è¾ƒæ—¶å®Œå…¨æ²¡å¿…è¦ä¼˜åŒ–ä½ çš„ä»£ç ï¼š<code>a == null</code> ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸º <code>a=== null</code>ã€‚åŒç±»å‹æ‰æœ‰å¯æ¯”æ€§ã€‚</p><h3 id="Thisè¡¨è¾¾å¼"><a href="#Thisè¡¨è¾¾å¼" class="headerlink" title="Thisè¡¨è¾¾å¼"></a>Thisè¡¨è¾¾å¼</h3><p>ä¸ºäº†è¡¨ç¤ºå½“å‰çš„ <em>æ¥æ”¶è€…</em> æˆ‘ä»¬ä½¿ç”¨ <em>this</em> è¡¨è¾¾å¼ï¼š</p><ul><li>åœ¨<a href="https://www.kotlincn.net/docs/reference/classes.html#ç»§æ‰¿" target="_blank" rel="external">ç±»</a>çš„æˆå‘˜ä¸­ï¼Œ<em>this</em> æŒ‡çš„æ˜¯è¯¥ç±»çš„å½“å‰å¯¹è±¡</li><li>åœ¨<a href="https://www.kotlincn.net/docs/reference/extensions.html" target="_blank" rel="external">æ‰©å±•å‡½æ•°</a>æˆ–è€…<a href="https://www.kotlincn.net/docs/reference/lambdas.html#å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼" target="_blank" rel="external">å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼</a>ä¸­ï¼Œ <em>this</em> è¡¨ç¤ºåœ¨ç‚¹å·¦ä¾§ä¼ é€’çš„ <em>æ¥æ”¶è€…</em> å‚æ•°ã€‚</li></ul><p>å¦‚æœ <em>this</em> æ²¡æœ‰é™å®šç¬¦ï¼Œå®ƒæŒ‡çš„æ˜¯æœ€å†…å±‚çš„åŒ…å«å®ƒçš„ä½œç”¨åŸŸã€‚è¦å¼•ç”¨å…¶ä»–ä½œç”¨åŸŸä¸­çš„ <em>this</em>ï¼Œè¯·ä½¿ç”¨ <em>æ ‡ç­¾é™å®šç¬¦</em>ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> kotlinThisExpression = KotlinThisExpression()</div><div class="line">    println(kotlinThisExpression.leftReference() === kotlinThisExpression)</div><div class="line">    kotlinThisExpression.InnerKotlinThisExpression().test()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinThisExpression</span> </span>&#123;</div><div class="line">    <span class="keyword">val</span> thisClassObject <span class="keyword">get</span>() = <span class="keyword">this</span></div><div class="line"></div><div class="line">    inner <span class="class"><span class="keyword">class</span> <span class="title">KotlinThisExpression</span> </span>&#123;</div><div class="line">        <span class="comment">//val thisClassObject get() = this@KotlinThisExpression //ä¸æ˜ç¡®label</span></div><div class="line">        <span class="keyword">val</span> thisClassObject <span class="keyword">get</span>() = <span class="keyword">this</span> <span class="comment">//å†…éƒ¨ç±»åç›¸åŒ,ä¸èƒ½ç”¨é™å®šçš„ this</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    inner <span class="class"><span class="keyword">class</span> <span class="title">InnerKotlinThisExpression</span> </span>&#123; <span class="comment">// éšå¼æ ‡ç­¾ @InnerKotlinThisExpression</span></div><div class="line">        <span class="function"><span class="keyword">fun</span> InnerKotlinThisExpression.<span class="title">fuck</span><span class="params">()</span></span> &#123; <span class="comment">// éšå¼æ ‡ç­¾ @fuck</span></div><div class="line">            <span class="keyword">val</span> a = <span class="keyword">this</span><span class="symbol">@KotlinThisExpression</span> <span class="comment">// KotlinThisExpression çš„ this</span></div><div class="line">            <span class="keyword">val</span> b = <span class="keyword">this</span><span class="symbol">@InnerKotlinThisExpression</span> <span class="comment">// InnerKotlinThisExpression çš„ this</span></div><div class="line"></div><div class="line">            <span class="keyword">val</span> c = <span class="keyword">this</span> <span class="comment">// fuck() çš„æ¥æ”¶è€…ï¼Œä¸€ä¸ª InnerKotlinThisExpression</span></div><div class="line">            <span class="keyword">val</span> d = <span class="keyword">this</span><span class="symbol">@fuck</span> <span class="comment">// fuck() çš„æ¥æ”¶è€…ï¼Œä¸€ä¸ª InnerKotlinThisExpression</span></div><div class="line"></div><div class="line">            <span class="keyword">val</span> label = <span class="symbol">label@</span> <span class="function"><span class="keyword">fun</span> String.<span class="params">()</span></span> &#123;</div><div class="line">                println(<span class="keyword">this</span>)<span class="comment">// label çš„æ¥æ”¶è€…</span></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="string">"label"</span>.label()</div><div class="line">            <span class="keyword">val</span> lambda = &#123; -&gt;</div><div class="line">                <span class="comment">// fuck() çš„æ¥æ”¶è€…ï¼Œå› ä¸ºå®ƒåŒ…å«çš„ lambda è¡¨è¾¾å¼</span></div><div class="line">                <span class="comment">// æ²¡æœ‰ä»»ä½•æ¥æ”¶è€…</span></div><div class="line">                println(<span class="keyword">this</span>)</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            lambda()</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">            fuck()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> KotlinThisExpression.<span class="title">leftReference</span><span class="params">()</span></span> = <span class="keyword">this</span>.thisClassObject <span class="comment">//this è¡¨ç¤ºåœ¨ç‚¹å·¦ä¾§ä¼ é€’çš„ æ¥æ”¶è€… å‚æ•°ã€‚</span></div></pre></td></tr></table></figure><h3 id="Nothing-ç±»å‹"><a href="#Nothing-ç±»å‹" class="headerlink" title="Nothing ç±»å‹"></a>Nothing ç±»å‹</h3><p>å¦‚æœç”¨ <code>null</code> æ¥åˆå§‹åŒ–ä¸€ä¸ªè¦æ¨æ–­ç±»å‹çš„å€¼ï¼Œè€Œåˆæ²¡æœ‰å…¶ä»–ä¿¡æ¯å¯ç”¨äºç¡®å®šæ›´å…·ä½“çš„ç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ¨æ–­å‡º <code>Nothing?</code> ç±»å‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> nothingInt<span class="comment">/*: Nothing?*/</span> = <span class="literal">null</span></div><div class="line"><span class="keyword">val</span> list:List&lt;<span class="built_in">Nothing</span>?&gt; = listOf(<span class="literal">null</span>)</div></pre></td></tr></table></figure><p>å¦å¤–Kotlin ä¸­ <code>throw</code> æ˜¯è¡¨è¾¾å¼, è¡¨è¾¾å¼çš„ç±»å‹æ˜¯ç‰¹æ®Šç±»å‹ <code>Nothing</code>ã€‚ è¯¥ç±»å‹æ²¡æœ‰å€¼ï¼Œè€Œæ˜¯ç”¨äºæ ‡è®°æ°¸è¿œä¸èƒ½è¾¾åˆ°çš„ä»£ç ä½ç½®ã€‚<code>Nothing</code> å¯ä»¥ç”¨æ¥æ ‡è®°ä¸€ä¸ªæ°¸è¿œä¸ä¼šè¿”å›çš„å‡½æ•°, ä¹Ÿå¯ä»¥ä½œä¸º Elvis è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> nothingInt<span class="comment">/*: Nothing?*/</span> = <span class="literal">null</span></div><div class="line"><span class="keyword">val</span> list: List&lt;<span class="built_in">Nothing</span>?&gt; = listOf(<span class="literal">null</span>)</div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">fail</span><span class="params">(message: <span class="type">String</span>)</span></span>: <span class="built_in">Nothing</span> &#123;</div><div class="line">    <span class="keyword">throw</span> IllegalArgumentException(message)</div><div class="line">&#125;</div><div class="line">fail(<span class="string">"fail"</span>)</div><div class="line"><span class="comment">//ä½œä¸º Elvis è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ† </span></div><div class="line"><span class="keyword">var</span> exception = <span class="literal">null</span> ?: <span class="keyword">throw</span> RuntimeException(<span class="string">"throw"</span>)</div></pre></td></tr></table></figure><h3 id="è§£æ„å£°æ˜"><a href="#è§£æ„å£°æ˜" class="headerlink" title="è§£æ„å£°æ˜"></a>è§£æ„å£°æ˜</h3><p>è§£æ„å£°æ˜æ˜¯åˆ›å»ºå¤šä¸ªå˜é‡ä¸å¯¹è±¡<code>componentN</code> å‡½æ•°å¯¹åº”èµ·æ¥ã€‚ä¾‹å¦‚åœ¨ä¸Šé¢çš„æ•°æ®ç±»ä¸­</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> (name, age) = KotlinDataClass.User(<span class="string">"Lisa"</span>, <span class="number">18</span>)</div></pre></td></tr></table></figure><p>NOTE: <code>componentN()</code> å‡½æ•°éœ€è¦ç”¨ <code>operator</code> å…³é”®å­—æ ‡è®°ï¼Œä»¥å…è®¸åœ¨è§£æ„å£°æ˜ä¸­ä½¿ç”¨å®ƒä»¬ã€‚å®ƒå¯ä»¥ç”¨<em>for</em>-å¾ªç¯ã€</p><p><em>map</em>-æ˜ å°„, ä»¥åŠ lambda è¡¨è¾¾å¼ä¸­ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> (name, age) = KotlinDeconstruction.Person(<span class="string">"jack"</span>, <span class="number">32</span>)</div><div class="line">    println(<span class="string">"<span class="subst">$name</span> <span class="subst">$age</span>"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">val</span> request = KotlinDeconstruction.request()</div><div class="line">    <span class="keyword">val</span> (rs, code) = request</div><div class="line">    println(<span class="string">"result = <span class="subst">$rs</span> , code = <span class="subst">$code</span>"</span>)</div><div class="line">    <span class="comment">//ä¸‹åˆ’çº¿ç”¨äºæœªä½¿ç”¨çš„å˜é‡</span></div><div class="line">    <span class="keyword">val</span> (_, responseCode) = request</div><div class="line">    println(responseCode)</div><div class="line">    println(request.component1())</div><div class="line">    println(request.component2())</div><div class="line"></div><div class="line">    <span class="comment">//è§£æ„å£°æ˜å’ŒMap</span></div><div class="line">    <span class="keyword">val</span> map = mutableMapOf&lt;String, String&gt;()</div><div class="line">    <span class="keyword">for</span> (it <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) &#123;</div><div class="line">        map.put(it.toString(), it.toString())</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> ((k, v) <span class="keyword">in</span> map) &#123;</div><div class="line">        println(<span class="string">"map key = <span class="subst">$k</span>, value = <span class="subst">$v</span>"</span>)</div><div class="line">    &#125;</div><div class="line">    map.mapValues &#123; entry -&gt; println(<span class="string">"key = <span class="subst">$&#123;entry.key&#125;</span>, value = <span class="subst">$&#123;entry.value&#125;</span>!"</span>) &#125;</div><div class="line">    map.mapValues &#123; (key, value) -&gt; println(<span class="string">"key = <span class="subst">$key</span>, value = <span class="subst">$value</span>!"</span>) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">KotlinDeconstruction</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> age: <span class="built_in">Int</span>) &#123;</div><div class="line">        <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">component1</span><span class="params">()</span></span>: Any = name</div><div class="line">        <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">component2</span><span class="params">()</span></span>: Any = age</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Response</span></span>(<span class="keyword">val</span> result: String, <span class="keyword">val</span> code: <span class="built_in">Int</span>)</div><div class="line"></div><div class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</div><div class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">request</span><span class="params">()</span></span>: Response &#123;</div><div class="line">            <span class="comment">//request network</span></div><div class="line">            <span class="keyword">return</span> Response(<span class="string">"ok"</span>, <span class="number">200</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è§£æ„å£°æ˜çš„å¥½å¤„, å¦‚request å‡½æ•°æ—¶è¦è¿”å›ä¸¤ä¸ªä¸œè¥¿æ—¶,ç”¨å®ƒçˆ½çˆ†äº†ã€‚å› ä¸ºç¼–è¯‘å™¨å§‹ç»ˆä¼šåˆ›å»ºå¤šä¸ªå˜é‡æ¥æ”¶,æ•ˆç‡å¹¶ä¸æ¯”ä¹‹å‰ç”¨å¯¹è±¡çš„é«˜ã€‚ä½†å®é™…ä¸Šå¹¶ä¸éœ€è¦è§£æä¸€ä¸ªå¯¹è±¡é‡Œçš„å¤§é‡å˜é‡,å¦åˆ™é€šè¿‡å¯¹è±¡ <code>.</code>å±æ€§è·å–å€¼ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> (name, age) = person <span class="comment">//ç¼–è¯‘å™¨ä¼šç”Ÿæˆå¦‚ä¸‹ä¸¤å¥ä»£ç </span></div><div class="line"><span class="keyword">val</span> name = person.component1()</div><div class="line"><span class="keyword">val</span> age = person.component2()</div></pre></td></tr></table></figure><h3 id="ç›¸ç­‰æ€§"><a href="#ç›¸ç­‰æ€§" class="headerlink" title="ç›¸ç­‰æ€§"></a>ç›¸ç­‰æ€§</h3><p>Kotlin ä¸­æœ‰ä¸¤ç§ç±»å‹çš„ç›¸ç­‰æ€§ï¼š</p><ul><li>å¼•ç”¨ç›¸ç­‰ï¼ˆä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡ï¼‰</li><li>ç»“æ„ç›¸ç­‰ï¼ˆç”¨ <code>equals()</code> æ£€æŸ¥ï¼‰</li></ul><h4 id="å¼•ç”¨ç›¸ç­‰-1"><a href="#å¼•ç”¨ç›¸ç­‰-1" class="headerlink" title="å¼•ç”¨ç›¸ç­‰"></a>å¼•ç”¨ç›¸ç­‰</h4><p>å¼•ç”¨ç›¸ç­‰ç”± <code>===</code>ï¼ˆä»¥åŠå…¶å¦å®šå½¢å¼ <code>!==</code>ï¼‰æ“ä½œåˆ¤æ–­ã€‚<code>a === b</code> å½“ä¸”ä»…å½“ <code>a</code> å’Œ <code>b</code> æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ—¶æ±‚å€¼ä¸º trueã€‚</p><h4 id="ç»“æ„ç›¸ç­‰-1"><a href="#ç»“æ„ç›¸ç­‰-1" class="headerlink" title="ç»“æ„ç›¸ç­‰"></a>ç»“æ„ç›¸ç­‰</h4><p>ç»“æ„ç›¸ç­‰ç”± <code>==</code>ï¼ˆä»¥åŠå…¶å¦å®šå½¢å¼ <code>!=</code>ï¼‰æ“ä½œåˆ¤æ–­ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œåƒ <code>a == b</code> è¿™æ ·çš„è¡¨è¾¾å¼ä¼šç¿»è¯‘æˆ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a?.equals(b) ?: (b === <span class="literal">null</span>)</div></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœ <code>a</code> ä¸æ˜¯ <code>null</code> åˆ™è°ƒç”¨ <code>equals(Any?)</code> å‡½æ•°ï¼Œå¦åˆ™ï¼ˆå³ <code>a</code> æ˜¯ <code>null</code>ï¼‰æ£€æŸ¥ b æ˜¯å¦ä¸ <code>null</code> å¼•ç”¨ç›¸ç­‰ã€‚</p><p>è¯·æ³¨æ„ï¼Œå½“ä¸ <code>null</code> æ˜¾å¼æ¯”è¾ƒæ—¶å®Œå…¨æ²¡å¿…è¦ä¼˜åŒ–ä½ çš„ä»£ç ï¼š<code>a == null</code> ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸º <code>a=== null</code>ã€‚</p><h4 id="æµ®ç‚¹æ•°ç›¸ç­‰æ€§"><a href="#æµ®ç‚¹æ•°ç›¸ç­‰æ€§" class="headerlink" title="æµ®ç‚¹æ•°ç›¸ç­‰æ€§"></a>æµ®ç‚¹æ•°ç›¸ç­‰æ€§</h4><p>å½“ç›¸ç­‰æ€§æ£€æµ‹çš„ä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯é™æ€å·²çŸ¥çš„ï¼ˆå¯ç©ºæˆ–éç©ºçš„ï¼‰<code>Float</code> æˆ– <code>Double</code> ç±»å‹æ—¶ï¼Œè¯¥æ£€æµ‹éµå¾ª IEEE 754 æµ®ç‚¹æ•°è¿ç®—æ ‡å‡†ã€‚</p><p>å¦åˆ™ä¼šä½¿ç”¨ä¸ç¬¦åˆè¯¥æ ‡å‡†çš„ç»“æ„ç›¸ç­‰æ€§æ£€æµ‹ï¼Œè¿™ä¼šå¯¼è‡´ <code>NaN</code> ç­‰äºå…¶è‡ªèº«ï¼Œè€Œ <code>-0.0</code> ä¸ç­‰äº <code>0.0</code>ã€‚</p><h3 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h3><h4 id="å¼‚å¸¸ç±»"><a href="#å¼‚å¸¸ç±»" class="headerlink" title="å¼‚å¸¸ç±»"></a>å¼‚å¸¸ç±»</h4><p>Kotlin ä¸­æ‰€æœ‰å¼‚å¸¸ç±»éƒ½æ˜¯ <code>Throwable</code> ç±»çš„å­å­™ç±»ã€‚ æ¯ä¸ªå¼‚å¸¸éƒ½æœ‰æ¶ˆæ¯ã€å †æ ˆå›æº¯ä¿¡æ¯å’Œå¯é€‰çš„åŸå› ã€‚</p><p>ä½¿ç”¨ <em>throw</em>-è¡¨è¾¾å¼æ¥æŠ›å‡ºå¼‚å¸¸ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">throw</span> MyException(<span class="string">"Hi There!"</span>)</div></pre></td></tr></table></figure><p>ä½¿ç”¨ <em>try</em>-è¡¨è¾¾å¼æ¥æ•è·å¼‚å¸¸ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    <span class="comment">// ä¸€äº›ä»£ç </span></div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> (e: SomeException) &#123;</div><div class="line">    <span class="comment">// å¤„ç†ç¨‹åº</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">finally</span> &#123;</div><div class="line">    <span class="comment">// å¯é€‰çš„ finally å—</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯ä»¥æœ‰é›¶åˆ°å¤šä¸ª <em>catch</em> å—ã€‚<em>finally</em> å—å¯ä»¥çœç•¥ã€‚ ä½†æ˜¯ <em>catch</em> å’Œ <em>finally</em> å—è‡³å°‘åº”è¯¥å­˜åœ¨ä¸€ä¸ªã€‚</p><h4 id="Try-æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼"><a href="#Try-æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼" class="headerlink" title="Try æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼"></a>Try æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼</h4><p><em>try</em> æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå³å®ƒå¯ä»¥æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> a: <span class="built_in">Int</span>? = <span class="keyword">try</span> &#123; parseInt(input) &#125; <span class="keyword">catch</span> (e: NumberFormatException) &#123; <span class="literal">null</span> &#125;</div></pre></td></tr></table></figure><p><em>try</em>-è¡¨è¾¾å¼çš„è¿”å›å€¼æ˜¯ <em>try</em> å—ä¸­çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼æˆ–è€…æ˜¯ï¼ˆæ‰€æœ‰ï¼‰<em>catch</em> å—ä¸­çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼ã€‚ <em>finally</em> å—ä¸­çš„å†…å®¹ä¸ä¼šå½±å“è¡¨è¾¾å¼çš„ç»“æœã€‚</p><h4 id="å—æ£€çš„å¼‚å¸¸"><a href="#å—æ£€çš„å¼‚å¸¸" class="headerlink" title="å—æ£€çš„å¼‚å¸¸"></a>å—æ£€çš„å¼‚å¸¸</h4><p>Kotlin æ²¡æœ‰å—æ£€çš„å¼‚å¸¸ã€‚è¿™å…¶ä¸­æœ‰å¾ˆå¤šåŸå› ï¼Œä½†æˆ‘ä»¬ä¼šæä¾›ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p><p>ä»¥ä¸‹æ˜¯ JDK ä¸­ <code>StringBuilder</code> ç±»å®ç°çš„ä¸€ä¸ªç¤ºä¾‹æ¥å£ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Appendable append(CharSequence csq) throws IOException;</div></pre></td></tr></table></figure><p>è¿™ä¸ªç­¾åæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ å®ƒæ˜¯è¯´ï¼Œæ¯æ¬¡æˆ‘è¿½åŠ ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°ä¸€äº›ä¸œè¥¿ï¼ˆä¸€ä¸ª <code>StringBuilder</code>ã€æŸç§æ—¥å¿—ã€ä¸€ä¸ªæ§åˆ¶å°ç­‰ï¼‰ä¸Šæ—¶æˆ‘å°±å¿…é¡»æ•è·é‚£äº› <code>IOException</code>ã€‚ ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå®ƒå¯èƒ½æ­£åœ¨æ‰§è¡Œ IO æ“ä½œï¼ˆ<code>Writer</code> ä¹Ÿå®ç°äº† <code>Appendable</code>ï¼‰â€¦â€¦ æ‰€ä»¥å®ƒå¯¼è‡´è¿™ç§ä»£ç éšå¤„å¯è§çš„å‡ºç°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    log.append(message)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    <span class="comment">// å¿…é¡»è¦å®‰å…¨</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™å¹¶ä¸å¥½ï¼Œå‚è§<a href="http://www.oracle.com/technetwork/java/effectivejava-136174.html" target="_blank" rel="external">ã€ŠEffective Javaã€‹</a> ç¬¬ 65 æ¡ï¼š<em>ä¸è¦å¿½ç•¥å¼‚å¸¸</em>ã€‚</p><p>Bruce Eckel åœ¨<a href="http://www.mindview.net/Etc/Discussions/CheckedExceptions" target="_blank" rel="external">ã€ŠJava æ˜¯å¦éœ€è¦å—æ£€çš„å¼‚å¸¸ï¼Ÿã€‹ï¼ˆDoes Java need Checked Exceptions?ï¼‰</a> ä¸­æŒ‡å‡ºï¼š</p><blockquote><p>é€šè¿‡ä¸€äº›å°ç¨‹åºæµ‹è¯•å¾—å‡ºçš„ç»“è®ºæ˜¯å¼‚å¸¸è§„èŒƒä¼šåŒæ—¶æé«˜å¼€å‘è€…çš„ç”Ÿäº§åŠ›å’Œä»£ç è´¨é‡ï¼Œä½†æ˜¯å¤§å‹è½¯ä»¶é¡¹ç›®çš„ç»éªŒè¡¨æ˜ä¸€ä¸ªä¸åŒçš„ç»“è®ºâ€”â€”ç”Ÿäº§åŠ›é™ä½ã€ä»£ç è´¨é‡å¾ˆå°‘æˆ–æ²¡æœ‰æé«˜ã€‚</p></blockquote><p>å…¶ä»–ç›¸å…³å¼•è¯ï¼š</p><ul><li><a href="http://radio-weblogs.com/0122027/stories/2003/04/01/JavasCheckedExceptionsWereAMistake.html" target="_blank" rel="external">ã€ŠJava çš„å—æ£€å¼‚å¸¸æ˜¯ä¸€ä¸ªé”™è¯¯ã€‹ï¼ˆJavaâ€™s checked exceptions were a mistakeï¼‰</a>ï¼ˆRod Waldhoffï¼‰</li><li><a href="http://www.artima.com/intv/handcuffs.html" target="_blank" rel="external">ã€Šå—æ£€å¼‚å¸¸çš„çƒ¦æ¼ã€‹ï¼ˆThe Trouble with Checked Exceptionsï¼‰</a>ï¼ˆAnders Hejlsbergï¼‰</li></ul><p> æ³¨æ„ï¼š<code>throw</code> è¡¨è¾¾å¼çš„ç±»å‹æ˜¯ç‰¹æ®Šç±»å‹ <code>Nothing</code>ã€‚å‚è§<a href="#Nothing-ç±»å‹">Nothingç±»å‹</a></p><h3 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h3><p>åå°„æ˜¯è¿™æ ·çš„ä¸€ç»„è¯­è¨€å’Œåº“åŠŸèƒ½ï¼Œå®ƒå…è®¸åœ¨è¿è¡Œæ—¶è‡ªçœä½ çš„ç¨‹åºçš„ç»“æ„ã€‚ Kotlin è®©è¯­è¨€ä¸­çš„å‡½æ•°å’Œå±æ€§åšä¸ºä¸€ç­‰å…¬æ°‘ã€å¹¶å¯¹å…¶è‡ªçœï¼ˆå³åœ¨è¿è¡Œæ—¶è·æ‚‰ä¸€ä¸ªåç§°æˆ–è€…ä¸€ä¸ªå±æ€§æˆ–å‡½æ•°çš„ç±»å‹ï¼‰ä¸ç®€å•åœ°ä½¿ç”¨å‡½æ•°å¼æˆ–å“åº”å¼é£æ ¼ç´§å¯†ç›¸å…³ã€‚</p><blockquote><p>åœ¨ Java å¹³å°ä¸Šï¼Œä½¿ç”¨åå°„åŠŸèƒ½æ‰€éœ€çš„è¿è¡Œæ—¶ç»„ä»¶ä½œä¸ºå•ç‹¬çš„ JAR æ–‡ä»¶ï¼ˆ<code>kotlin-reflect.jar</code>ï¼‰åˆ†å‘ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†å‡å°‘ä¸ä½¿ç”¨åå°„åŠŸèƒ½çš„åº”ç”¨ç¨‹åºæ‰€éœ€çš„è¿è¡Œæ—¶åº“çš„å¤§å°ã€‚å¦‚æœä½ éœ€è¦ä½¿ç”¨åå°„ï¼Œè¯·ç¡®ä¿è¯¥ .jaræ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®çš„ classpath ä¸­ã€‚</p></blockquote><h4 id="ç±»å¼•ç”¨"><a href="#ç±»å¼•ç”¨" class="headerlink" title="ç±»å¼•ç”¨"></a>ç±»å¼•ç”¨</h4><p>æœ€åŸºæœ¬çš„åå°„åŠŸèƒ½æ˜¯è·å– Kotlin ç±»çš„è¿è¡Œæ—¶å¼•ç”¨ã€‚è¦è·å–å¯¹é™æ€å·²çŸ¥çš„ Kotlin ç±»çš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ <em>ç±»å­—é¢å€¼</em> è¯­æ³•ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> c = MyClass::<span class="class"><span class="keyword">class</span></span></div></pre></td></tr></table></figure><p>è¯¥å¼•ç”¨æ˜¯ <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html" target="_blank" rel="external">KClass</a> ç±»å‹çš„å€¼ã€‚</p><p>è¯·æ³¨æ„ï¼ŒKotlin ç±»å¼•ç”¨ä¸ Java ç±»å¼•ç”¨ä¸åŒã€‚è¦è·å¾— Java ç±»å¼•ç”¨ï¼Œ è¯·åœ¨ <code>KClass</code> å®ä¾‹ä¸Šä½¿ç”¨ <code>.java</code> å±æ€§ã€‚</p><h4 id="ç»‘å®šçš„ç±»å¼•ç”¨ï¼ˆè‡ª-1-1-èµ·ï¼‰"><a href="#ç»‘å®šçš„ç±»å¼•ç”¨ï¼ˆè‡ª-1-1-èµ·ï¼‰" class="headerlink" title="ç»‘å®šçš„ç±»å¼•ç”¨ï¼ˆè‡ª 1.1 èµ·ï¼‰"></a>ç»‘å®šçš„ç±»å¼•ç”¨ï¼ˆè‡ª 1.1 èµ·ï¼‰</h4><p>é€šè¿‡ä½¿ç”¨å¯¹è±¡ä½œä¸ºæ¥æ”¶è€…ï¼Œå¯ä»¥ç”¨ç›¸åŒçš„ <code>::class</code> è¯­æ³•è·å–æŒ‡å®šå¯¹è±¡çš„ç±»çš„å¼•ç”¨ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> widget: Widget = â€¦â€¦</div><div class="line">assert(widget <span class="keyword">is</span> GoodWidget) &#123; <span class="string">"Bad widget: <span class="subst">$&#123;widget::class.qualifiedName&#125;</span>"</span> &#125;</div></pre></td></tr></table></figure><p>ä½ å¯ä»¥è·å–å¯¹è±¡çš„ç²¾ç¡®ç±»çš„å¼•ç”¨ï¼Œä¾‹å¦‚ <code>GoodWidget</code> æˆ– <code>BadWidget</code>ï¼Œå°½ç®¡æ¥æ”¶è€…è¡¨è¾¾å¼çš„ç±»å‹æ˜¯ <code>Widget</code>ã€‚</p><h4 id="å‡½æ•°å¼•ç”¨"><a href="#å‡½æ•°å¼•ç”¨" class="headerlink" title="å‡½æ•°å¼•ç”¨"></a>å‡½æ•°å¼•ç”¨</h4><p>å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå‘½åå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">isOdd</span><span class="params">(x: <span class="type">Int</span>)</span></span> = x % <span class="number">2</span> != <span class="number">0</span></div></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç›´æ¥è°ƒç”¨å®ƒï¼ˆ<code>isOdd(5)</code>ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒä½œä¸ºä¸€ä¸ªå€¼ä¼ é€’ã€‚ä¾‹å¦‚ä¼ ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>::</code> æ“ä½œç¬¦ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> numbers = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">println(numbers.filter(::isOdd)) <span class="comment">// è¾“å‡º [1, 3]</span></div></pre></td></tr></table></figure><p>è¿™é‡Œ <code>::isOdd</code> æ˜¯å‡½æ•°ç±»å‹ <code>(Int) -&gt; Boolean</code> çš„ä¸€ä¸ªå€¼ã€‚</p><p>å½“ä¸Šä¸‹æ–‡ä¸­å·²çŸ¥å‡½æ•°æœŸæœ›çš„ç±»å‹æ—¶ï¼Œ<code>::</code> å¯ä»¥ç”¨äºé‡è½½å‡½æ•°ã€‚ ä¾‹å¦‚ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">isOdd</span><span class="params">(x: <span class="type">Int</span>)</span></span> = x % <span class="number">2</span> != <span class="number">0</span></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">isOdd</span><span class="params">(s: <span class="type">String</span>)</span></span> = s == <span class="string">"brillig"</span> || s == <span class="string">"slithy"</span> || s == <span class="string">"tove"</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> numbers = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">println(numbers.filter(::isOdd)) <span class="comment">// å¼•ç”¨åˆ° isOdd(x: Int)</span></div></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œä½ å¯ä»¥é€šè¿‡å°†æ–¹æ³•å¼•ç”¨å­˜å‚¨åœ¨å…·æœ‰æ˜¾å¼æŒ‡å®šç±»å‹çš„å˜é‡ä¸­æ¥æä¾›å¿…è¦çš„ä¸Šä¸‹æ–‡ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> predicate: (String) -&gt; <span class="built_in">Boolean</span> = ::isOdd   <span class="comment">// å¼•ç”¨åˆ° isOdd(x: String)</span></div></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç±»çš„æˆå‘˜å‡½æ•°æˆ–æ‰©å±•å‡½æ•°ï¼Œå®ƒéœ€è¦æ˜¯é™å®šçš„ã€‚ ä¾‹å¦‚ <code>String::toCharArray</code> ä¸ºç±»å‹ <code>String</code>æä¾›äº†ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼š<code>String.() -&gt; CharArray</code>ã€‚</p><h4 id="ç¤ºä¾‹ï¼šå‡½æ•°ç»„åˆ"><a href="#ç¤ºä¾‹ï¼šå‡½æ•°ç»„åˆ" class="headerlink" title="ç¤ºä¾‹ï¼šå‡½æ•°ç»„åˆ"></a>ç¤ºä¾‹ï¼šå‡½æ•°ç»„åˆ</h4><p>è€ƒè™‘ä»¥ä¸‹å‡½æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;A, B, C&gt;</span> <span class="title">compose</span><span class="params">(f: (<span class="type">B</span>)</span></span> -&gt; C, g: (A) -&gt; B): (A) -&gt; C &#123;</div><div class="line">    <span class="keyword">return</span> &#123; x -&gt; f(g(x)) &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å®ƒè¿”å›ä¸€ä¸ªä¼ ç»™å®ƒçš„ä¸¤ä¸ªå‡½æ•°çš„ç»„åˆï¼š<code>compose(f, g) = f(g(*))</code>ã€‚ ç°åœ¨ï¼Œä½ å¯ä»¥å°†å…¶åº”ç”¨äºå¯è°ƒç”¨å¼•ç”¨ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">length</span><span class="params">(s: <span class="type">String</span>)</span></span> = s.length</div><div class="line"></div><div class="line"><span class="keyword">val</span> oddLength = compose(::isOdd, ::length)</div><div class="line"><span class="keyword">val</span> strings = listOf(<span class="string">"a"</span>, <span class="string">"ab"</span>, <span class="string">"abc"</span>)</div><div class="line"></div><div class="line">println(strings.filter(oddLength)) <span class="comment">// è¾“å‡º "[a, abc]"</span></div></pre></td></tr></table></figure><h4 id="å±æ€§å¼•ç”¨"><a href="#å±æ€§å¼•ç”¨" class="headerlink" title="å±æ€§å¼•ç”¨"></a>å±æ€§å¼•ç”¨</h4><p>è¦æŠŠå±æ€§ä½œä¸º Kotlinä¸­ çš„ä¸€ç­‰å¯¹è±¡æ¥è®¿é—®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>::</code> è¿ç®—ç¬¦ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    println(::x.<span class="keyword">get</span>()) <span class="comment">// è¾“å‡º "1"</span></div><div class="line">    ::x.<span class="keyword">set</span>(<span class="number">2</span>)</div><div class="line">    println(x)         <span class="comment">// è¾“å‡º "2"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¡¨è¾¾å¼ <code>::x</code> æ±‚å€¼ä¸º <code>KProperty&lt;Int&gt;</code> ç±»å‹çš„å±æ€§å¯¹è±¡ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ <code>get()</code> è¯»å–å®ƒçš„å€¼ï¼Œæˆ–è€…ä½¿ç”¨ <code>name</code> å±æ€§æ¥è·å–å±æ€§åã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-property/index.html" target="_blank" rel="external">å…³äº <code>KProperty</code> ç±»çš„æ–‡æ¡£</a>ã€‚</p><p>å¯¹äºå¯å˜å±æ€§ï¼Œä¾‹å¦‚ <code>var y = 1</code>ï¼Œ<code>::y</code> è¿”å› <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-mutable-property/index.html" target="_blank" rel="external"><code>KMutableProperty</code></a> ç±»å‹çš„ä¸€ä¸ªå€¼ï¼Œ è¯¥ç±»å‹æœ‰ä¸€ä¸ª <code>set()</code> æ–¹æ³•ã€‚</p><p>å±æ€§å¼•ç”¨å¯ä»¥ç”¨åœ¨ä¸éœ€è¦å‚æ•°çš„å‡½æ•°å¤„ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> strs = listOf(<span class="string">"a"</span>, <span class="string">"bc"</span>, <span class="string">"def"</span>)</div><div class="line">println(strs.map(String::length)) <span class="comment">// è¾“å‡º [1, 2, 3]</span></div></pre></td></tr></table></figure><p>è¦è®¿é—®å±äºç±»çš„æˆå‘˜çš„å±æ€§ï¼Œæˆ‘ä»¬è¿™æ ·é™å®šå®ƒï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>(<span class="keyword">val</span> p: <span class="built_in">Int</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> prop = A::p</div><div class="line">    println(prop.<span class="keyword">get</span>(A(<span class="number">1</span>))) <span class="comment">// è¾“å‡º "1"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯¹äºæ‰©å±•å±æ€§ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> String.lastChar: <span class="built_in">Char</span></div><div class="line">    <span class="keyword">get</span>() = <span class="keyword">this</span>[length - <span class="number">1</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    println(String::lastChar.<span class="keyword">get</span>(<span class="string">"abc"</span>)) <span class="comment">// è¾“å‡º "c"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="ä¸-Java-åå°„çš„äº’æ“ä½œæ€§"><a href="#ä¸-Java-åå°„çš„äº’æ“ä½œæ€§" class="headerlink" title="ä¸ Java åå°„çš„äº’æ“ä½œæ€§"></a>ä¸ Java åå°„çš„äº’æ“ä½œæ€§</h4><p>åœ¨Javaå¹³å°ä¸Šï¼Œæ ‡å‡†åº“åŒ…å«åå°„ç±»çš„æ‰©å±•ï¼Œå®ƒæä¾›äº†ä¸ Java åå°„å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼ˆå‚è§ <code>kotlin.reflect.jvm</code>åŒ…ï¼‰ã€‚ ä¾‹å¦‚ï¼Œè¦æŸ¥æ‰¾ä¸€ä¸ªç”¨ä½œ Kotlin å±æ€§ getter çš„ å¹•åå­—æ®µæˆ– Javaæ–¹æ³•ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> kotlin.reflect.jvm.*</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>(<span class="keyword">val</span> p: <span class="built_in">Int</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    println(A::p.javaGetter) <span class="comment">// è¾“å‡º "public final int A.getP()"</span></div><div class="line">    println(A::p.javaField)  <span class="comment">// è¾“å‡º "private final int A.p"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¦è·å¾—å¯¹åº”äº Java ç±»çš„ Kotlin ç±»ï¼Œè¯·ä½¿ç”¨ <code>.kotlin</code> æ‰©å±•å±æ€§ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getKClass</span><span class="params">(o: <span class="type">Any</span>)</span></span>: KClass&lt;Any&gt; = o.javaClass.kotlin</div></pre></td></tr></table></figure><h4 id="æ„é€ å‡½æ•°å¼•ç”¨"><a href="#æ„é€ å‡½æ•°å¼•ç”¨" class="headerlink" title="æ„é€ å‡½æ•°å¼•ç”¨"></a>æ„é€ å‡½æ•°å¼•ç”¨</h4><p>æ„é€ å‡½æ•°å¯ä»¥åƒæ–¹æ³•å’Œå±æ€§é‚£æ ·å¼•ç”¨ã€‚ä»–ä»¬å¯ä»¥ç”¨äºæœŸå¾…è¿™æ ·çš„å‡½æ•°ç±»å‹å¯¹è±¡çš„ä»»ä½•åœ°æ–¹ï¼šå®ƒä¸è¯¥æ„é€ å‡½æ•°æ¥å—ç›¸åŒå‚æ•°å¹¶ä¸”è¿”å›ç›¸åº”ç±»å‹çš„å¯¹è±¡ã€‚ é€šè¿‡ä½¿ç”¨ <code>::</code> æ“ä½œç¬¦å¹¶æ·»åŠ ç±»åæ¥å¼•ç”¨æ„é€ å‡½æ•°ã€‚è€ƒè™‘ä¸‹é¢çš„å‡½æ•°ï¼Œ å®ƒæœŸå¾…ä¸€ä¸ªæ— å‚å¹¶è¿”å› <code>Foo</code> ç±»å‹çš„å‡½æ•°å‚æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">function</span><span class="params">(factory: ()</span></span> -&gt; Foo) &#123;</div><div class="line">    <span class="keyword">val</span> x: Foo = factory()</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>::Foo</code>ï¼Œç±» Foo çš„é›¶å‚æ•°æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç®€å•åœ°è°ƒç”¨å®ƒï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">function(::Foo)</div></pre></td></tr></table></figure><h4 id="ç»‘å®šçš„å‡½æ•°ä¸å±æ€§å¼•ç”¨ï¼ˆè‡ª-1-1-èµ·ï¼‰"><a href="#ç»‘å®šçš„å‡½æ•°ä¸å±æ€§å¼•ç”¨ï¼ˆè‡ª-1-1-èµ·ï¼‰" class="headerlink" title="ç»‘å®šçš„å‡½æ•°ä¸å±æ€§å¼•ç”¨ï¼ˆè‡ª 1.1 èµ·ï¼‰"></a>ç»‘å®šçš„å‡½æ•°ä¸å±æ€§å¼•ç”¨ï¼ˆè‡ª 1.1 èµ·ï¼‰</h4><p>ä½ å¯ä»¥å¼•ç”¨ç‰¹å®šå¯¹è±¡çš„å®ä¾‹æ–¹æ³•ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> numberRegex = <span class="string">"\\d+"</span>.toRegex()</div><div class="line">println(numberRegex.matches(<span class="string">"29"</span>)) <span class="comment">// è¾“å‡ºâ€œtrueâ€</span></div><div class="line"> </div><div class="line"><span class="keyword">val</span> isNumber = numberRegex::matches</div><div class="line">println(isNumber(<span class="string">"29"</span>)) <span class="comment">// è¾“å‡ºâ€œtrueâ€</span></div></pre></td></tr></table></figure><p>å–ä»£ç›´æ¥è°ƒç”¨æ–¹æ³• <code>matches</code> çš„æ˜¯æˆ‘ä»¬å­˜å‚¨å…¶å¼•ç”¨ã€‚ è¿™æ ·çš„å¼•ç”¨ä¼šç»‘å®šåˆ°å…¶æ¥æ”¶è€…ä¸Šã€‚ å®ƒå¯ä»¥ç›´æ¥è°ƒç”¨ï¼ˆå¦‚ä¸Šä¾‹æ‰€ç¤ºï¼‰æˆ–è€…ç”¨äºä»»ä½•æœŸå¾…ä¸€ä¸ªå‡½æ•°ç±»å‹è¡¨è¾¾å¼çš„æ—¶å€™ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> strings = listOf(<span class="string">"abc"</span>, <span class="string">"124"</span>, <span class="string">"a70"</span>)</div><div class="line">println(strings.filter(numberRegex::matches)) <span class="comment">// è¾“å‡ºâ€œ[124]â€</span></div></pre></td></tr></table></figure><p>æ¯”è¾ƒç»‘å®šçš„ç±»å‹å’Œç›¸åº”çš„æœªç»‘å®šç±»å‹çš„å¼•ç”¨ã€‚ ç»‘å®šçš„å¯è°ƒç”¨å¼•ç”¨æœ‰å…¶æ¥æ”¶è€…â€œé™„åŠ â€åˆ°å…¶ä¸Šï¼Œå› æ­¤æ¥æ”¶è€…çš„ç±»å‹ä¸å†æ˜¯å‚æ•°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> isNumber: (CharSequence) -&gt; <span class="built_in">Boolean</span> = numberRegex::matches</div><div class="line"></div><div class="line"><span class="keyword">val</span> matches: (Regex, CharSequence) -&gt; <span class="built_in">Boolean</span> = Regex::matches</div></pre></td></tr></table></figure><p>å±æ€§å¼•ç”¨ä¹Ÿå¯ä»¥ç»‘å®šï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> prop = <span class="string">"abc"</span>::length</div><div class="line">println(prop.<span class="keyword">get</span>())   <span class="comment">// è¾“å‡ºâ€œ3â€</span></div></pre></td></tr></table></figure><h3 id="ç±»å‹åˆ«å"><a href="#ç±»å‹åˆ«å" class="headerlink" title="ç±»å‹åˆ«å"></a>ç±»å‹åˆ«å</h3><p>ç±»å‹åˆ«åä¸ºç°æœ‰ç±»å‹æä¾›æ›¿ä»£åç§°ã€‚ å¦‚æœç±»å‹åç§°å¤ªé•¿ï¼Œä½ å¯ä»¥å¦å¤–å¼•å…¥è¾ƒçŸ­çš„åç§°ï¼Œå¹¶ä½¿ç”¨æ–°çš„åç§°æ›¿ä»£åŸç±»å‹åã€‚å¯ä»¥ä¸ºå‡½æ•°ç±»å‹æä¾›å¦å¤–çš„åˆ«åï¼Œä¹Ÿå¯ä»¥ä¸ºå†…éƒ¨ç±»å’ŒåµŒå¥—ç±»åˆ›å»ºæ–°åç§°</p><p>ç±»å‹åˆ«åä¸ä¼šå¼•å…¥æ–°ç±»å‹ã€‚ å®ƒä»¬ç­‰æ•ˆäºç›¸åº”çš„åº•å±‚ç±»å‹ã€‚ å½“ä½ åœ¨ä»£ç ä¸­æ·»åŠ  <code>typealias Predicate&lt;T&gt;</code> å¹¶ä½¿ç”¨ <code>Predicate&lt;Int&gt;</code> æ—¶ï¼ŒKotlin ç¼–è¯‘å™¨æ€»æ˜¯æŠŠå®ƒæ‰©å±•ä¸º <code>(Int) -&gt; Boolean</code>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</div><div class="line">    <span class="keyword">val</span> net: Net = Network()</div><div class="line"></div><div class="line">    <span class="keyword">val</span> enable = enable(net) &#123;</div><div class="line">        netStatus() == <span class="number">0</span></div><div class="line">    &#125;</div><div class="line">    println(enable)</div><div class="line"></div><div class="line">    <span class="keyword">val</span> p: Predicate&lt;<span class="built_in">Int</span>&gt; = &#123; it &gt; <span class="number">0</span> &#125;</div><div class="line">    println(listOf(<span class="number">1</span>, <span class="number">-2</span>).filter(p)) <span class="comment">// è¾“å‡º "[1]"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">typealias Net = Network</div><div class="line">typealias Node = Network.Node</div><div class="line"></div><div class="line">typealias NodeSet = Set&lt;Network.Node&gt;</div><div class="line">typealias FileTable&lt;N&gt; = MutableMap&lt;N, MutableList&lt;File&gt;&gt;</div><div class="line"></div><div class="line">typealias MyHandler = (<span class="built_in">Int</span>, String, Any) -&gt; <span class="built_in">Unit</span></div><div class="line">typealias Predicate&lt;T&gt; = (T) -&gt; <span class="built_in">Boolean</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="title">netStatus</span><span class="params">()</span></span>: <span class="built_in">Int</span> = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Network</span> </span>&#123;</div><div class="line">    inner <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">enable</span><span class="params">(t: <span class="type">T</span>, p: <span class="type">Predicate</span>&lt;<span class="type">T</span>&gt;)</span></span>: <span class="built_in">Boolean</span> &#123;</div><div class="line">    <span class="keyword">return</span> p(t)</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;äººç”Ÿè‹¦å¤šï¼Œå¿«æ¥ Kotlin ï¼Œå¿«é€Ÿå­¦ä¹ Kotlinï¼&lt;/p&gt;
    
    </summary>
    
      <category term="Kotlin" scheme="http://lazy.github.io/categories/Kotlin/"/>
    
    
      <category term="kotlin" scheme="http://lazy.github.io/tags/kotlin/"/>
    
  </entry>
  
  <entry>
    <title>dev kvm is not found(Android studio)</title>
    <link href="http://lazy.github.io/2017/04/17/android/kvm-not-found/"/>
    <id>http://lazy.github.io/2017/04/17/android/kvm-not-found/</id>
    <published>2017-04-17T14:58:04.000Z</published>
    <updated>2017-05-30T15:26:12.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="AVD-çªç„¶å‡ºç°äº†dev-kvm-is-not-found-è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚-Hardware-Accelerated-Execution-Manager-ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM"><a href="#AVD-çªç„¶å‡ºç°äº†dev-kvm-is-not-found-è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚-Hardware-Accelerated-Execution-Manager-ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM" class="headerlink" title="AVD çªç„¶å‡ºç°äº†dev kvm is not found è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚ Hardware_Accelerated_Execution_Manager ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM"></a>AVD çªç„¶å‡ºç°äº†<font color="#ff0000">dev kvm is not found</font> è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚ Hardware_Accelerated_Execution_Manager ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM</h4><a id="more"></a><p><img src="http://img.blog.csdn.net/20160802190104824" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>1.ä»AndroidSDK æ ¹ç›®å½• è¿›å…¥ extras â€”&gt;intelâ€”&gt;Hardware_Accelerated_Execution_Managerâ€”&gt;åŒå‡»æ‰“å¼€ IntelHAXM_6.0.3.dmg æ–‡ä»¶,æœ€åå®‰è£…IntelHAXM_6.0.3.mpkgå³å¯</p><p><img src="http://img.blog.csdn.net/20160802190502594" alt="extras"></p><p><img src="http://img.blog.csdn.net/20160802190553372" alt="intel"></p><p><img src="http://img.blog.csdn.net/20160802190628029" alt="Hardware_Accelerated_Execution_Manager"></p><p><img src="http://img.blog.csdn.net/20160802190653346" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p><img src="http://img.blog.csdn.net/20160802190708628" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>Done!</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;AVD-çªç„¶å‡ºç°äº†dev-kvm-is-not-found-è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚-Hardware-Accelerated-Execution-Manager-ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM&quot;&gt;&lt;a href=&quot;#AVD-çªç„¶å‡ºç°äº†dev-kvm-is-not-found-è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚-Hardware-Accelerated-Execution-Manager-ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM&quot; class=&quot;headerlink&quot; title=&quot;AVD çªç„¶å‡ºç°äº†dev kvm is not found è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚ Hardware_Accelerated_Execution_Manager ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM&quot;&gt;&lt;/a&gt;AVD çªç„¶å‡ºç°äº†&lt;font color=#ff0000 &gt;dev kvm is not found&lt;/font&gt; è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘çŒœæµ‹å¤§æ¦‚ Hardware_Accelerated_Execution_Manager ä¸¢å¤±äº†æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æ²¡å®‰è£…å¥½HAXM&lt;/h4&gt;
    
    </summary>
    
      <category term="Androidé—®é¢˜é›†é”¦" scheme="http://lazy.github.io/categories/Android%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/"/>
    
    
      <category term="AndroidStudio" scheme="http://lazy.github.io/tags/AndroidStudio/"/>
    
  </entry>
  
  <entry>
    <title>ListView/RecyclerView ä¸­æ­£ç¡®ä½¿ç”¨ EditText CheckBox</title>
    <link href="http://lazy.github.io/2017/04/17/android/Edit-CheckBox/"/>
    <id>http://lazy.github.io/2017/04/17/android/Edit-CheckBox/</id>
    <published>2017-04-17T14:25:11.000Z</published>
    <updated>2017-12-26T14:39:41.609Z</updated>
    
    <content type="html"><![CDATA[<p> åœ¨ ListView/RecyclerView Item ä¸­ ä½¿ç”¨EditText CheckBox æ§ä»¶æ—¶ æ»šåŠ¨åˆ—è¡¨æ—¶ EditText å€¼é”™ä¹± CheckBox checked å€¼åŒæ ·é”™ä¹±ï¼ŒåŸå› åœ¨äºå¤ç”¨Itemæ—¶ è®¾ç½®æ§ä»¶valueæ—¶ è§¦å‘äº†old Item ç›‘å¬å™¨å›è°ƒï¼Œå›è°ƒä¸­æ”¹å˜äº†æ§ä»¶value<br><a id="more"></a> </p><h2 id="é”™è¯¯ç”¨æ³•"><a href="#é”™è¯¯ç”¨æ³•" class="headerlink" title="é”™è¯¯ç”¨æ³•"></a>é”™è¯¯ç”¨æ³•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">checkBox.setChecked(model.isChecked);</div><div class="line">checkBox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() &#123;</div><div class="line">@Override</div><div class="line">public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) &#123;</div><div class="line">model.setChecked(isChecked);///æ”¹å˜ DataPoJo</div><div class="line">&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><h2 id="æ­£ç¡®ç”¨æ³•"><a href="#æ­£ç¡®ç”¨æ³•" class="headerlink" title="æ­£ç¡®ç”¨æ³•"></a>æ­£ç¡®ç”¨æ³•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">checkBox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() &#123;</div><div class="line">@Override</div><div class="line">public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) &#123;</div><div class="line">model.setChecked(isChecked);//æ”¹å˜ DataPoJo</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line">checkBox.setChecked(model.isChecked);</div></pre></td></tr></table></figure><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p> å…ˆè®¾Item ç›‘å¬å™¨ï¼ŒItemå¤ç”¨æ—¶ï¼Œç›‘å¬å™¨æ˜¯new çš„</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt; åœ¨ ListView/RecyclerView Item ä¸­ ä½¿ç”¨EditText CheckBox æ§ä»¶æ—¶ æ»šåŠ¨åˆ—è¡¨æ—¶ EditText å€¼é”™ä¹± CheckBox checked å€¼åŒæ ·é”™ä¹±ï¼ŒåŸå› åœ¨äºå¤ç”¨Itemæ—¶ è®¾ç½®æ§ä»¶valueæ—¶ è§¦å‘äº†old Item ç›‘å¬å™¨å›è°ƒï¼Œå›è°ƒä¸­æ”¹å˜äº†æ§ä»¶value&lt;br&gt;
    
    </summary>
    
      <category term="Androidé—®é¢˜é›†é”¦" scheme="http://lazy.github.io/categories/Android%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6/"/>
    
    
      <category term="Android" scheme="http://lazy.github.io/tags/Android/"/>
    
  </entry>
  
</feed>
